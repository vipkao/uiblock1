/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/ 		var executeModules = data[2];
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 		// add entry modules from loaded chunk to deferred list
/******/ 		deferredModules.push.apply(deferredModules, executeModules || []);
/******/
/******/ 		// run deferred modules when all chunks ready
/******/ 		return checkDeferredModules();
/******/ 	};
/******/ 	function checkDeferredModules() {
/******/ 		var result;
/******/ 		for(var i = 0; i < deferredModules.length; i++) {
/******/ 			var deferredModule = deferredModules[i];
/******/ 			var fulfilled = true;
/******/ 			for(var j = 1; j < deferredModule.length; j++) {
/******/ 				var depId = deferredModule[j];
/******/ 				if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 			}
/******/ 			if(fulfilled) {
/******/ 				deferredModules.splice(i--, 1);
/******/ 				result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 			}
/******/ 		}
/******/ 		return result;
/******/ 	}
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	var installedChunks = {
/******/ 		"test001": 0
/******/ 	};
/******/
/******/ 	var deferredModules = [];
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	var jsonpArray = window["webpackJsonp"] = window["webpackJsonp"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// add entry module to deferred list
/******/ 	deferredModules.push(["./src/test001.js","vendor"]);
/******/ 	// run deferred modules when ready
/******/ 	return checkDeferredModules();
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/Concrete.js":
/*!*************************!*\
  !*** ./src/Concrete.js ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nvar _Interaction_GameEvent = __webpack_require__(/*! ./Interaction_GameEvent */ \"./src/Interaction_GameEvent.js\");\n\nvar _Interaction_GameEvent2 = _interopRequireDefault(_Interaction_GameEvent);\n\nvar _Interaction_GameEvent_Binder = __webpack_require__(/*! ./Interaction_GameEvent_Binder */ \"./src/Interaction_GameEvent_Binder.js\");\n\nvar _Interaction_GameEvent_Binder2 = _interopRequireDefault(_Interaction_GameEvent_Binder);\n\nvar _Interaction_GameCommand = __webpack_require__(/*! ./Interaction_GameCommand */ \"./src/Interaction_GameCommand.js\");\n\nvar _Interaction_GameCommand2 = _interopRequireDefault(_Interaction_GameCommand);\n\nvar _Interaction_GameBehavior = __webpack_require__(/*! ./Interaction_GameBehavior */ \"./src/Interaction_GameBehavior.js\");\n\nvar _Interaction_GameBehavior2 = _interopRequireDefault(_Interaction_GameBehavior);\n\nvar _Element = __webpack_require__(/*! ./Element */ \"./src/Element.js\");\n\nvar _Element2 = _interopRequireDefault(_Element);\n\nvar _Element_Store = __webpack_require__(/*! ./Element_Store */ \"./src/Element_Store.js\");\n\nvar _Element_Store2 = _interopRequireDefault(_Element_Store);\n\nvar _Element_Particle = __webpack_require__(/*! ./Element_Particle */ \"./src/Element_Particle.js\");\n\nvar _Element_Particle2 = _interopRequireDefault(_Element_Particle);\n\nvar _Element_Effect = __webpack_require__(/*! ./Element_Effect */ \"./src/Element_Effect.js\");\n\nvar _Element_Effect2 = _interopRequireDefault(_Element_Effect);\n\nvar _Element_Shape = __webpack_require__(/*! ./Element_Shape */ \"./src/Element_Shape.js\");\n\nvar _Element_Shape2 = _interopRequireDefault(_Element_Shape);\n\nvar _Element_Helper = __webpack_require__(/*! ./Element_Helper */ \"./src/Element_Helper.js\");\n\nvar _Element_Helper2 = _interopRequireDefault(_Element_Helper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Concrete = {};\n\n/**\r\n * @param {Concrete.IStageSet} concrete \r\n */\nConcrete.StageSet = function (player, stageClearEvent, stageFailEvent, backgroundColor, stageWidth, stageHeight, barAreaHeight, tapAllowance, ballInitPosX, ballInitPosY, barInitPosX, barInitPosY, ballReleaseVelocity, playerCountVSpan, playerCountHSpan, shapeRegisterFn, rendererFactory, stepCalculatorFactory, bodyPropertyFactory, viewPropertyFactory, layerFactory, concreteShapeStoreImplementFactory, factoryConcreteFactory, preBindBindersConcreteFactory, commandConcreteFactory, helperConcreteFactory) {\n\n    //const stage = new PIXI.Stage();\n    var stage = layerFactory.createLayer();\n\n    var renderer = rendererFactory.create(stage, stageWidth, stageHeight, backgroundColor);\n    var stepCalculator = stepCalculatorFactory.create();\n    var bodyProperty = bodyPropertyFactory.create();\n    var viewProperty = viewPropertyFactory.create();\n\n    //添え字が小さい方が下\n    //上から\n    //・フェード、loading系\n    //・UI系\n    //・残機数\n    //・tap/drag系\n    //・block preview\n    //・ball等\n    //...\n    //・背景画像\n    //・背景画像\n    var layers = Array(8).fill(0).map(function (n) {\n        var layer = layerFactory.createLayer();\n        layer.setSize(stageWidth, stageHeight);\n        stage.addChild(layer);\n        return layer;\n    });\n    var layerWrap = layers[layers.length - 1];\n    var layerUi = layers[layers.length - 2];\n    var layerPlayerCount = layers[layers.length - 3];\n    var layerInteraction = layers[layers.length - 4];\n    var layerPlayAreaPreview = layers[layers.length - 5];\n    var layerPlayArea = layers[layers.length - 6];\n    ///TODO 今は背景画像の位置を最下位に固定しているが、ある程度自由にしたい。\n    var layersBackground = [layers[layers.length - 8], layers[layers.length - 7]];\n\n    var layerInteractionImageArea = layerFactory.createLayer();\n    layerInteractionImageArea.setHitArea(0, 0, stageWidth, stageHeight - barAreaHeight);\n    var layerInteractionBarArea = layerFactory.createLayer();\n    layerInteractionBarArea.setHitArea(0, stageHeight - barAreaHeight, stageWidth, barAreaHeight);\n    layerInteraction.addChild(layerInteractionImageArea);\n    layerInteraction.addChild(layerInteractionBarArea);\n\n    layerPlayAreaPreview.setVisible(false); //previewはデフォルト非表示\n\n\n    var shapeConcrete = new Concrete.ConcreteShapeStore(concreteShapeStoreImplementFactory.create(renderer, layerPlayArea, layerPlayAreaPreview, layerPlayerCount, layerUi));\n    shapeRegisterFn(shapeConcrete);\n\n    var factoryConcrete = factoryConcreteFactory.create(layerUi);\n\n    var updater = new _Interaction2.default.Updater(renderer, stepCalculator, bodyProperty, viewProperty);\n    var store = new Concrete.Store(updater);\n    var event = new Concrete.Event();\n    var eventBinder = new _Interaction2.default.GameEventBinder([new _Interaction_GameEvent_Binder2.default.HitEventBinder(event.Hit, event.HitBall, store.Ball, store.Block, preBindBindersConcreteFactory.createHitEventBinderConcrete()), new _Interaction_GameEvent_Binder2.default.HitBallBarEventBinder(event.HitBallBar, store.Ball, store.Bar, preBindBindersConcreteFactory.createHitBallBarEventBinderConcrete()), new _Interaction_GameEvent_Binder2.default.HitBulletEventBinder(event.HitBullet, store.Bullet, store.Block, preBindBindersConcreteFactory.createHitBulletEventBinderConcrete()), new _Interaction_GameEvent_Binder2.default.LostBallEventBinder(event.LostBall, store.Ball, store.LostArea, preBindBindersConcreteFactory.createLostBallEventBinderConcrete()), new _Interaction_GameEvent_Binder2.default.LostBulletEventBinder(event.LostBullet, store.Bullet, store.PlayArea, preBindBindersConcreteFactory.createLostBulletEventBinderConcrete()), new _Interaction_GameEvent_Binder2.default.GetItemEventBinder(event.GetItem, store.Bar, store.Item, preBindBindersConcreteFactory.createGetItemEventBinderConcrete()), new _Interaction_GameEvent_Binder2.default.LostItemEventBinder(event.LostItem, store.Item, store.LostArea, preBindBindersConcreteFactory.createLostItemEventBinderConcrete()), new _Interaction_GameEvent_Binder2.default.TapEventBinder(tapAllowance, event.Tap, preBindBindersConcreteFactory.createTapEventConcrete(layerInteractionBarArea)), new _Interaction_GameEvent_Binder2.default.DragEventBinder(event.BarDrag, preBindBindersConcreteFactory.createBarAreaLocalDragEventConcrete(layerInteractionBarArea)), new _Interaction_GameEvent_Binder2.default.DragEventBinder(event.ImageDrag, preBindBindersConcreteFactory.createImageAreaLocalDragEventConcrete(layerInteractionImageArea))]);\n\n    var commandConcrete = commandConcreteFactory.create();\n\n    var helperConcrete = helperConcreteFactory.create(renderer);\n\n    var particlePoolConcreteFn = function particlePoolConcreteFn(params, variables) {\n        var sprite = params['sprite'];\n        sprite.x = variables['x'];\n        sprite.y = variables['y'];\n        sprite.alpha = variables['alpha'];\n        sprite.rotation = variables['rotation'];\n    };\n\n    var shape = new Concrete.ShapeFactory(shapeConcrete);\n    var factory = new Concrete.Factory(factoryConcrete, store, updater);\n    var particlePool = new _Element_Particle2.default.Pool(1000, 100, particlePoolConcreteFn);\n    var command = new Concrete.Command(commandConcrete, layerWrap, layerPlayAreaPreview, layersBackground, eventBinder, event.Start, event.Clear, event.Fail, event.Break, event.MoveBar, event.LabelTap, event.BreakPlayer, event.LostBall, event.LostBullet, event.GameSuspend, event.GameResume, store.Ball, store.Block, store.Item, store.Bar, store.Bullet, store.Label, particlePool, factory.Ball, factory.Bullet, factory.Item, updater, player, tapAllowance, stageWidth, stageHeight, ballInitPosX, ballInitPosY, barInitPosX, barInitPosY, playerCountVSpan, playerCountHSpan, ballReleaseVelocity);\n    var behavior = new Concrete.Behavior(event, command, store.Ball, store.Bar, store.Block, factory.Ball, factory.Bar, factory.Item, shape.Ball(), shape.Bar(), player, shape.PlayerCount(), updater, stageClearEvent, stageFailEvent);\n    var helper = new Concrete.Helper(helperConcrete);\n\n    this.getUpdater = function () {\n        return updater;\n    };\n    this.getShape = function () {\n        return shape;\n    };\n    this.getStore = function () {\n        return store;\n    };\n    this.getFactory = function () {\n        return factory;\n    };\n    this.getEvent = function () {\n        return event;\n    };\n    this.getEventBinder = function () {\n        return eventBinder;\n    };\n    this.getCommand = function () {\n        return command;\n    };\n    this.getBehavior = function () {\n        return behavior;\n    };\n    this.getHelper = function () {\n        return helper;\n    };\n};\n\n//shape\n//#region\n/**\r\n * 各createのnameを省略すると'default'が指定された事と同義となる。\r\n * @param {Concrete.IConcreteShapeFactory} concrete \r\n */\nConcrete.ShapeFactory = function (concrete) {\n    function cache(arr, name, createFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        if (arr[name] == null) arr[name] = createFn();\n        return arr[name];\n    };\n\n    var balls = {};\n    this.Ball = function (name) {\n        return cache(balls, name, function () {\n            return new _Element_Shape2.default.ShapeApplier(concrete.createBall(name));\n        });\n    };\n    var blocks = {};\n    this.Block = function (name) {\n        return cache(blocks, name, function () {\n            return new _Element_Shape2.default.SizedShapeApplier(concrete.createBlock(name));\n        });\n    };\n    var items = {};\n    this.Item = function (name) {\n        return cache(items, name, function () {\n            return new _Element_Shape2.default.ShapeApplier(concrete.createItem(name));\n        });\n    };\n    var bullets = {};\n    this.Bullet = function (name) {\n        return cache(bullets, name, function () {\n            return new _Element_Shape2.default.ShapeApplier(concrete.createBullet(name));\n        });\n    };\n    var bars = {};\n    this.Bar = function (name) {\n        return cache(bars, name, function () {\n            return new _Element_Shape2.default.ShapeApplier(concrete.createBar(name));\n        });\n    };\n    var lostAreas = {};\n    this.LostArea = function (name) {\n        return cache(lostAreas, name, function () {\n            return new _Element_Shape2.default.ShapeApplier(concrete.createLostArea(name));\n        });\n    };\n    var playAreas = {};\n    this.PlayArea = function (name) {\n        return cache(playAreas, name, function () {\n            return new _Element_Shape2.default.ShapeApplier(concrete.createPlayArea(name));\n        });\n    };\n\n    var labels = {};\n    this.Label = function (name) {\n        return cache(labels, name, function () {\n            return new _Element_Shape2.default.SizedShapeApplier(concrete.createLabel(name));\n        });\n    };\n\n    var styles = {};\n    this.Style = function (name) {\n        return cache(styles, name, function () {\n            return new _Element_Shape2.default.TextShapeApplier(concrete.createStyle(name));\n        });\n    };\n\n    var playerCounts = {};\n    this.PlayerCount = function (name) {\n        return cache(playerCounts, name, function () {\n            return concrete.createPlayerCount(name);\n        });\n    };\n\n    var particles = {};\n    this.Particle = function (name) {\n        return cache(particles, name, function () {\n            return concrete.createParticle(name);\n        });\n    };\n\n    var tweens = {};\n    this.Tween = function (name) {\n        var p = concrete.createTween(name);\n        return cache(tweens, name, function () {\n            return new _Element_Effect2.default.TweenFactory(p['duration'], p['xTween'], p['xEnd'], p['yTween'], p['yEnd'], p['ampTween'], p['ampStart'], p['ampEnd'], p['alphaTween'], p['alphaStart'], p['alphaEnd']);\n        });\n    };\n};\n\nConcrete.IConcreteShapeFactory = function (concrete) {\n    this.createBall = function (name) {\n        throw new Error('未実装');\n    };\n    this.createBlock = function (name) {\n        throw new Error('未実装');\n    };\n    this.createItem = function (name) {\n        throw new Error('未実装');\n    };\n    this.createBullet = function (name) {\n        throw new Error('未実装');\n    };\n    this.createBar = function (name) {\n        throw new Error('未実装');\n    };\n    this.createLostArea = function (name) {\n        throw new Error('未実装');\n    };\n    this.createPlayArea = function (name) {\n        throw new Error('未実装');\n    };\n    this.createLabel = function (name) {\n        throw new Error('未実装');\n    };\n    this.createPlayerCount = function (name) {\n        throw new Error('未実装');\n    };\n    this.createParticle = function (name) {\n        throw new Error('未実装');\n    };\n    this.createTween = function (name) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * 各registのnameを省略(もしくは空文字)すると'default'が指定された事と同義となる。\r\n */\nConcrete.IConcreteShapeRegisterer = function () {\n    ///TODO 後でregistをregisterにする\n    this.registBall = function (name, viewShapeFn, bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.registBlock = function (name, viewShapeSizedFn, bodyShapeSizedPreviewFn, bodyShapeSizedFn) {\n        throw new Error('未実装');\n    };\n    this.registItem = function (name, viewShapeFn, bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.registBullet = function (name, viewShapeFn, bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.registBar = function (name, viewShapeFn, bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.registLostArea = function (name, viewShapeFn, bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.registPlayArea = function (name, viewShapeFn, bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.registPlayerCount = function (name, viewShapeFn) {\n        throw new Error('未実装');\n    };\n    this.registLabel = function (name, viewShapeSizedFn) {\n        throw new Error('未実装');\n    };\n    this.registStyle = function (name, styleParams) {\n        throw new Error('未実装');\n    };\n    this.registParticle = function (name, lifeTime, particleCount, viewShapeArrayFn, variablesFn) {\n        throw new Error('未実装');\n    };\n    this.registTween = function (name, duration, xTween, xEnd, yTween, yEnd, ampTween, ampStart, ampEnd, alphaTween, alphaStart, alphaEnd) {\n        throw new Error('未実装');\n    };\n};\n\nConcrete.IConcreteShapeStoreImplement = function () {\n    this.constract = function () {\n        throw new Error('未実装');\n    };\n    this.createViewShape = function (viewShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createViewSizedShape = function (viewSizedShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createViewSizedPreviewShape = function (viewSizedPreviewShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createTextShape = function (styleParams) {\n        throw new Error('未実装');\n    };\n    this.createPlayerCountShape = function (viewShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createLabelShape = function (viewSizedShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createParticle = function (lifeTime, particleCount, viewShapeArrayFn, variablesFn) {\n        throw new Error('未実装');\n    };\n\n    this.createBodyBallShape = function (bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createBodyBlockShape = function (bodySizedShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createBodyItemShape = function (bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createBodyBulletShape = function (bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createBodyBarShape = function (bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createBodyLostAreaShape = function (bodyShapeFn) {\n        throw new Error('未実装');\n    };\n    this.createBodyPlayAreaShape = function (bodyShapeFn) {\n        throw new Error('未実装');\n    };\n};\nConcrete.IConcreteShapeStoreImplementFactory = function () {\n    this.create = function (renderer, playAreaLayer, playAreaPreviewLayer, playerCountLayer, labelLayer) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * @param {Concrete.IConcreteShapeStoreImplement} implement\r\n */\nConcrete.ConcreteShapeStore = function (implement) {\n    Concrete.IConcreteShapeFactory.call(this);\n    Concrete.IConcreteShapeRegisterer.call(this);\n\n    implement.constract();\n\n    function get(array, name) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        var ret = array[name];\n        if (ret == null) throw new Error('Concrete.ConcreteShapeStore:not found:' + name);\n        return ret;\n    }\n\n    var balls = {};\n    this.createBall = function (name) {\n        return get(balls, name);\n    };\n    this.registBall = function (name, viewShapeFn, bodyShapeFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        var ret = [];\n        if (viewShapeFn != null) ret.push(implement.createViewShape(viewShapeFn));\n        if (bodyShapeFn != null) ret.push(implement.createBodyBallShape(bodyShapeFn));\n        balls[name] = ret;\n    };\n\n    var blocks = {};\n    this.createBlock = function (name) {\n        return get(blocks, name);\n    };\n    this.registBlock = function (name, viewSizedShapeFn, viewSizedPreviewShapeFn, bodySizedShapeFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        var ret = [];\n        if (viewSizedShapeFn != null) ret.push(implement.createViewSizedShape(viewSizedShapeFn));\n        if (viewSizedPreviewShapeFn != null) ret.push(implement.createViewSizedPreviewShape(viewSizedPreviewShapeFn));\n        if (bodySizedShapeFn != null) ret.push(implement.createBodyBlockShape(bodySizedShapeFn));\n        blocks[name] = ret;\n    };\n\n    var items = {};\n    this.createItem = function (name) {\n        return get(items, name);\n    };\n    this.registItem = function (name, viewShapeFn, bodyShapeFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        items[name] = [implement.createViewShape(viewShapeFn), implement.createBodyItemShape(bodyShapeFn)];\n    };\n\n    var bullets = {};\n    this.createBullet = function (name) {\n        return get(bullets, name);\n    };\n    this.registBullet = function (name, viewShapeFn, bodyShapeFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        bullets[name] = [implement.createViewShape(viewShapeFn), implement.createBodyBulletShape(bodyShapeFn)];\n    };\n\n    var bars = {};\n    this.createBar = function (name) {\n        return get(bars, name);\n    };\n    this.registBar = function (name, viewShapeFn, bodyShapeFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        var ret = [];\n        if (viewShapeFn != null) ret.push(implement.createViewShape(viewShapeFn));\n        if (bodyShapeFn != null) ret.push(implement.createBodyBarShape(bodyShapeFn));\n        bars[name] = ret;\n    };\n\n    var lostAreas = {};\n    this.createLostArea = function (name) {\n        return get(lostAreas, name);\n    };\n    this.registLostArea = function (name, viewShapeFn, bodyShapeFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        lostAreas[name] = [implement.createViewShape(viewShapeFn), implement.createBodyLostAreaShape(bodyShapeFn)];\n    };\n\n    var playAreas = {};\n    this.createPlayArea = function (name) {\n        return get(playAreas, name);\n    };\n    this.registPlayArea = function (name, viewShapeFn, bodyShapeFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        var ret = [];\n        if (viewShapeFn != null) ret.push(implement.createViewShape(viewShapeFn));\n        if (bodyShapeFn != null) ret.push(implement.createBodyPlayAreaShape(bodyShapeFn));\n        playAreas[name] = ret;\n    };\n\n    var playerCounts = {};\n    this.createPlayerCount = function (name) {\n        return get(playerCounts, name);\n    };\n    this.registPlayerCount = function (name, viewShapeFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        playerCounts[name] = implement.createPlayerCountShape(viewShapeFn);\n    };\n\n    var labels = {};\n    this.createLabel = function (name) {\n        return get(labels, name);\n    };\n    this.registLabel = function (name, viewSizedShapeFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        labels[name] = [implement.createLabelShape(viewSizedShapeFn)];\n    };\n\n    var styles = {};\n    this.createStyle = function (name) {\n        return get(styles, name);\n    };\n    this.registStyle = function (name, styleParams) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        styles[name] = [implement.createTextShape(styleParams)];\n    };\n\n    var particles = {};\n    this.createParticle = function (name) {\n        return get(particles, name);\n    };\n    this.registParticle = function (name, lifeTime, particleCount, viewShapeArrayFn, variablesFn) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        particles[name] = implement.createParticle(lifeTime, particleCount, viewShapeArrayFn, variablesFn);\n    };\n\n    var tweens = {};\n    this.createTween = function (name) {\n        return get(tweens, name);\n    };\n    this.registTween = function (name, duration, xTween, xEnd, yTween, yEnd, ampTween, ampStart, ampEnd, alphaTween, alphaStart, alphaEnd) {\n        if (name == null) name = 'default';\n        if (name === '') name = 'default';\n        tweens[name] = {\n            duration: duration,\n            xTween: xTween, xEnd: xEnd,\n            yTween: yTween, yEnd: yEnd,\n            ampTween: ampTween, ampStart: ampStart, ampEnd: ampEnd,\n            alphaTween: alphaTween, alphaStart: alphaStart, alphaEnd: alphaEnd\n        };\n    };\n};\n\n//#endregion\n\n//store\n//#region\nConcrete.Store = function (updater) {\n    this.Ball = new _Element_Store2.default.BallStore(updater);\n    this.Block = new _Element_Store2.default.BlockStore();\n    this.Item = new _Element_Store2.default.ItemStore(updater);\n    this.Bullet = new _Element_Store2.default.BulletStore(updater);\n    this.Bar = new _Element_Store2.default.BarStore(updater);\n    this.LostArea = new _Element_Store2.default.LostAreaStore();\n    this.PlayArea = new _Element_Store2.default.PlayAreaStore();\n    this.Label = new _Element_Store2.default.LabelStore();\n    this.Image = new _Element_Store2.default.ImageStore();\n};\n//#endregion\n\n//factory\n//#region\nConcrete.IFactoryConcrete = function () {\n    this.getBalls = function () {\n        throw new Error('未実装');\n    };\n    this.getBlocks = function () {\n        throw new Error('未実装');\n    };\n    this.getItems = function () {\n        throw new Error('未実装');\n    };\n    this.getBullets = function () {\n        throw new Error('未実装');\n    };\n    this.getBars = function () {\n        throw new Error('未実装');\n    };\n    this.getLostAreas = function () {\n        throw new Error('未実装');\n    };\n    this.getPlayAreas = function () {\n        throw new Error('未実装');\n    };\n    this.getLabels = function () {\n        throw new Error('未実装');\n    };\n    this.getImages = function () {\n        throw new Error('未実装');\n    };\n};\nConcrete.IFactoryConcreteFactory = function () {\n    this.create = function (layer) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * @param {Concrete.IFactoryConcrete} concrete \r\n * @param {Concrete.Store} store \r\n * @param {Interaction.Updater} updater \r\n */\nConcrete.Factory = function (concrete, store, updater) {\n    var serial = new _Element_Store2.default.SerialNumber();\n\n    this.Ball = new _Element2.default.BallFactory(serial, store.Ball, updater, concrete.getBalls());\n\n    this.Block = new _Element2.default.BlockFactory(serial, store.Block, concrete.getBlocks());\n\n    this.Item = new _Element2.default.ItemFactory(serial, store.Item, updater, concrete.getItems());\n\n    this.Bullet = new _Element2.default.BulletFactory(serial, store.Bullet, updater, concrete.getBullets());\n\n    this.Bar = new _Element2.default.BarFactory(serial, store.Bar, updater, concrete.getBars());\n\n    this.LostArea = new _Element2.default.LostAreaFactory(serial, store.LostArea, concrete.getLostAreas());\n\n    this.PlayArea = new _Element2.default.PlayAreaFactory(serial, store.PlayArea, concrete.getPlayAreas());\n\n    this.Label = new _Element2.default.LabelFactory(serial, store.Label, concrete.getLabels());\n\n    this.Image = new _Element2.default.ImageFactory(serial, store.Image, concrete.getImages());\n};\n//#endregion\n\n//event\n//#region\nConcrete.Event = function () {\n    this.Start = new _Interaction_GameEvent2.default.StartEvent();\n    this.Clear = new _Interaction_GameEvent2.default.ClearEvent();\n    this.Fail = new _Interaction_GameEvent2.default.FailEvent();\n    this.Hit = new _Interaction_GameEvent2.default.HitEvent();\n    this.HitBall = new _Interaction_GameEvent2.default.HitBallEvent();\n    this.HitBullet = new _Interaction_GameEvent2.default.HitBulletEvent();\n    this.HitBallBar = new _Interaction_GameEvent2.default.HitBallBarEvent();\n    this.Break = new _Interaction_GameEvent2.default.BreakEvent();\n    this.LostBall = new _Interaction_GameEvent2.default.LostBallEvent();\n    this.LostBullet = new _Interaction_GameEvent2.default.LostBulletEvent();\n    this.GetItem = new _Interaction_GameEvent2.default.GetItemEvent();\n    this.LostItem = new _Interaction_GameEvent2.default.LostItemEvent();\n    this.MoveBar = new _Interaction_GameEvent2.default.MoveBarEvent();\n    this.Tap = new _Interaction_GameEvent2.default.TapEvent();\n    this.LabelTap = new _Interaction_GameEvent2.default.LabelTapEvent();\n    this.BarDrag = new _Interaction_GameEvent2.default.BarDragEvent();\n    this.ImageDrag = new _Interaction_GameEvent2.default.ImageDragEvent();\n    this.BreakPlayer = new _Interaction_GameEvent2.default.BreakPlayerEvent();\n    this.GameSuspend = new _Interaction_GameEvent2.default.GameSuspendEvent();\n    this.GameResume = new _Interaction_GameEvent2.default.GameResumeEvent();\n};\n\nConcrete.IPreBindBindersConcreteFactory = function () {\n    this.createHitEventBinderConcrete = function () {\n        throw new Error('未実装');\n    };\n    this.createHitBallBarEventBinderConcrete = function () {\n        throw new Error('未実装');\n    };\n    this.createHitBulletEventBinderConcrete = function () {\n        throw new Error('未実装');\n    };\n    this.createLostBallEventBinderConcrete = function () {\n        throw new Error('未実装');\n    };\n    this.createLostBulletEventBinderConcrete = function () {\n        throw new Error('未実装');\n    };\n    this.createGetItemEventBinderConcrete = function () {\n        throw new Error('未実装');\n    };\n    this.createLostItemEventBinderConcrete = function () {\n        throw new Error('未実装');\n    };\n    this.createTapEventConcrete = function (layer) {\n        throw new Error('未実装');\n    };\n    this.createBarAreaLocalDragEventConcrete = function (layer) {\n        throw new Error('未実装');\n    };\n    this.createImageAreaLocalDragEventConcrete = function (layer) {\n        throw new Error('未実装');\n    };\n};\n//#endregion\n\n//helper\n//#region\nConcrete.AbstractHelperConcrete = function () {\n    this.ImageDiffDetector = new _Element_Helper2.default.AlwaysTrueImageDiffDetector();\n};\nConcrete.IHelperConcreteFactory = function () {\n    this.create = function (renderer) {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Concrete.AbstractHelperConcrete} concrete \r\n */\nConcrete.Helper = function (concrete) {\n    this.ImageDiffDetector = new _Element_Helper2.default.NinePointImageDiffDetector(concrete.ImageDiffDetector);\n};\n//#endregion\n\n//command\n//#region\nConcrete.AbstractCommandConcrete = function () {\n    this.GameFail = [];\n    this.GameStart = [];\n    this.PutBlock = [];\n    this.PutLabel = [];\n    this.ChangeBlockMaskImage = [];\n    this.BallBindReleaseBridge = [];\n    this.BallBindToBar = [];\n    this.ReleaseBall = [];\n    this.BallBarPosition = [];\n    this.BallBarPositionBallOnBar = [];\n    this.ChangeBallAngle = [];\n    this.SyncBall = [];\n    this.MoveBar = [];\n    this.BallSpeedUpAndLimit = [];\n    this.BreakItem = [];\n    this.BreakBall = [];\n    this.BreakBlock = [];\n    this.TweenElement = [];\n    this.FlashLabel = [];\n    this.MoveItemToBlock = [];\n    this.DropItem = [];\n    this.MoveBulletToBar = [];\n    this.ShootBullet = [];\n    this.MoveBulletToBallRandomRaround = [];\n    this.DrawText = [];\n    this.DrawTextFramed = [];\n    this.ReelBall = [];\n    this.Tappable = [];\n    this.BreakBullet = [];\n    this.BreakPlayer = [];\n    this.BreakPlayerBarStoreProcess = [];\n    this.ParticleBlock = null;\n    this.ParticleBall = null;\n    this.ParticleBar = null;\n    this.GameClear = [];\n    this.GameClearStoreProcess = [];\n    this.ChangeImage = [];\n};\nConcrete.ICommandConcreteFactory = function () {\n    this.create = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * @param {Concrete.AbstractCommandConcrete} concrete \r\n */\nConcrete.Command = function (concrete, layerWrap, layerPlayAreaPreview, layersBackground, eventBinder, startEvent, clearEvent, failEvent, breakEvent, moveBarEvent, labelTapEvent, breakPlayerEvent, lostBallEvent, lostBulletEvent, gameSuspendEvent, gameResumeEvent, ballStore, blockStore, itemStore, barStore, bulletStore, labelStore, particlePool, ballFactory, bulletFactory, itemFactory, updater, player, tapAllowance, stageWidth, stageHeight, ballInitPosX, ballInitPosY, barInitPosX, barInitPosY, playerCountVSpan, playerCountHSpan, ballReleaseVelocity) {\n    this.GameFail = new _Interaction_GameCommand2.default.GameFail(concrete.GameFail, failEvent);\n    this.GameStart = new _Interaction_GameCommand2.default.GameStart(concrete.GameStart, startEvent);\n    this.ImageLoad = new _Interaction_GameCommand2.default.ImageLoad(concrete.ImageLoad);\n    this.PutBlock = new _Interaction_GameCommand2.default.PutBlock(concrete.PutBlock);\n    this.PutLabel = new _Interaction_GameCommand2.default.PutLabel(concrete.PutLabel, new _Interaction_GameCommand2.default.ChangeSizedShape());\n    var ballBindReleaseBridge = new _Interaction_GameCommand2.default.BallBindReleaseBridge(concrete.BallBindReleaseBridge, moveBarEvent);\n    this.BallBindToBar = new _Interaction_GameCommand2.default.BallBindToBar([new _Interaction_GameCommand2.default.BallBindToBarVelocityStore(ballBindReleaseBridge, concrete.BallBindToBar)]);\n    this.ReleaseBall = new _Interaction_GameCommand2.default.ReleaseBall([new _Interaction_GameCommand2.default.ReleaseBallVelocityOverwrite(ballBindReleaseBridge, concrete.ReleaseBall)], ballReleaseVelocity);\n    this.BallBarPosition = new _Interaction_GameCommand2.default.BallBarPosition(concrete.BallBarPosition, [ballInitPosX, ballInitPosY], [barInitPosX, barInitPosY]);\n    this.BallBarPositionBallOnBar = new _Interaction_GameCommand2.default.BallBarPosition(concrete.BallBarPositionBallOnBar, [0, ballInitPosY], []);\n    this.ChangeBallAngle = new _Interaction_GameCommand2.default.ChangeBallAngle(concrete.ChangeBallAngle);\n    this.SyncBall = new _Interaction_GameCommand2.default.SyncBall(concrete.SyncBall, this.BallBindToBar);\n    this.SplitBall = new _Interaction_GameCommand2.default.SplitBall(ballStore, ballFactory, this.SyncBall, this.ChangeBallAngle);\n    this.ChangeBarTemporary = new _Interaction_GameCommand2.default.ChangeBarTemporary(updater);\n    this.Timeout = new _Interaction_GameCommand2.default.Timeout(updater);\n    this.NextUpdate = new _Interaction_GameCommand2.default.NextUpdate(updater);\n    this.CountDown = new _Interaction_GameCommand2.default.CountDown(updater);\n    this.ChangeBlock = new _Interaction_GameCommand2.default.ChangeSizedShape();\n    this.ChangeBlockMaskImage = new _Interaction_GameCommand2.default.ChangeBlockMaskImage(concrete.ChangeBlockMaskImage);\n    this.ChangeLabel = new _Interaction_GameCommand2.default.ChangeSizedShape();\n    var moveBarLimitter = new _Interaction_GameCommand2.default.MoveLimitterXMaxLimitYFix(stageWidth, barInitPosY);\n    this.MoveBar = new _Interaction_GameCommand2.default.MoveBar(concrete.MoveBar, moveBarLimitter, moveBarEvent);\n    this.BallSpeedUpAndLimit = new _Interaction_GameCommand2.default.BallSpeedUpAndLimit(concrete.BallSpeedUpAndLimit);\n    this.BallSpeedSet = new _Interaction_GameCommand2.default.BallSpeedSet(concrete.BallSpeedSet);\n    this.ExertItem = new _Interaction_GameCommand2.default.ExertItem();\n    this.BreakItem = new _Interaction_GameCommand2.default.BreakItem(concrete.BreakItem, itemStore);\n    this.BreakBall = new _Interaction_GameCommand2.default.BreakBall(concrete.BreakBall, ballStore);\n    this.OutAreaBreakBall = new _Interaction_GameCommand2.default.OutAreaBreakBall(new _Interaction_GameCommand2.default.OutAreaBreakBallRectangleArea(concrete.OutAreaBreakBall, stageWidth, stageHeight), ballStore, lostBallEvent);\n    this.ReflectPlayerCount = new _Interaction_GameCommand2.default.ReflectPlayerCount(new _Interaction_GameCommand2.default.PlayerCountLayoutTopRight(stageWidth, playerCountVSpan, playerCountHSpan));\n    this.BreakBlock = new _Interaction_GameCommand2.default.BreakBlock(concrete.BreakBlock, blockStore, breakEvent);\n    this.TweenElement = new _Interaction_GameCommand2.default.TweenElement(concrete.TweenElement, updater);\n    var fadeScreenConcreteFactory = new _Interaction_GameCommand2.default.FadeScreenAlphaTween(concrete.FadeScreen, layerWrap, stageWidth, stageHeight);\n    this.FadeScreen = new _Interaction_GameCommand2.default.FadeScreen([fadeScreenConcreteFactory], updater);\n    this.FlashLabel = new _Interaction_GameCommand2.default.TweenElement(concrete.FlashLabel, updater);\n    this.MoveItemToBlock = new _Interaction_GameCommand2.default.MoveItemToBlock(concrete.MoveItemToBlock);\n    this.DropItem = new _Interaction_GameCommand2.default.DropItem(concrete.DropItem);\n    this.DropItemFromBlock = new _Interaction_GameCommand2.default.DropItemFromBlock(itemFactory, this.MoveItemToBlock, this.DropItem);\n    this.MoveBulletToBar = new _Interaction_GameCommand2.default.MoveBulletToBar(concrete.MoveBulletToBar);\n    this.ShootBullet = new _Interaction_GameCommand2.default.ShootBullet(concrete.ShootBullet);\n    this.ShootBulletFromBar = new _Interaction_GameCommand2.default.ShootBulletFromBar(this.MoveBulletToBar, this.ShootBullet);\n    this.ShootBulletInterval = new _Interaction_GameCommand2.default.ShootBulletInterval(this.ShootBulletFromBar, bulletFactory, updater);\n    this.MoveBulletToBallRandomRaround = new _Interaction_GameCommand2.default.MoveBulletToBallRandomRaround(concrete.MoveBulletToBallRandomRaround);\n    this.BallExplosion = new _Interaction_GameCommand2.default.BallExplosion(bulletFactory, lostBulletEvent, this.MoveBulletToBallRandomRaround, this.TweenElement, this.Timeout);\n    this.DrawText = new _Interaction_GameCommand2.default.DrawText(concrete.DrawText);\n    this.DrawTextFramed = new _Interaction_GameCommand2.default.DrawTextFramed(concrete.DrawTextFramed);\n    this.ReelBall = new _Interaction_GameCommand2.default.ReelBall(concrete.ReelBall);\n    this.BlockPreview = new _Interaction_GameCommand2.default.BlockPreview(new _Interaction_GameCommand2.default.BlockPreviewLayerVisible(layerPlayAreaPreview));\n    this.Tappable = new _Interaction_GameCommand2.default.Tappable(concrete.Tappable, eventBinder, tapAllowance, labelTapEvent, labelStore);\n    this.BreakBullet = new _Interaction_GameCommand2.default.BreakBullet(concrete.BreakBullet, bulletStore);\n    var breakPlayerConcrete = concrete.BreakPlayer.concat(concrete.BreakPlayerBarStoreProcess.map(function (c) {\n        return new _Interaction_GameCommand2.default.BreakPlayerBarStoreProcess(c, barStore);\n    }));\n    this.BreakPlayer = new _Interaction_GameCommand2.default.BreakPlayer(breakPlayerConcrete, barStore, player, breakPlayerEvent);\n    this.ParticlePoint = new _Interaction_GameCommand2.default.ParticlePoint(updater, particlePool);\n    this.ParticleBlock = new _Interaction_GameCommand2.default.ParticleBlock(concrete.ParticleBlock, this.ParticlePoint);\n    this.ParticleBall = new _Interaction_GameCommand2.default.ParticleBall(concrete.ParticleBall, this.ParticlePoint);\n    this.ParticleBar = new _Interaction_GameCommand2.default.ParticleBar(concrete.ParticleBar, this.ParticlePoint);\n    var gameClearConcrete = concrete.GameClear.concat(concrete.GameClearStoreProcess.map(function (c) {\n        return new _Interaction_GameCommand2.default.GameClearStoreProcess(c, ballStore, itemStore, barStore, bulletStore);\n    }));\n    this.GameClear = new _Interaction_GameCommand2.default.GameClear(gameClearConcrete, this.particleBall, ballStore, itemStore, barStore, bulletStore, clearEvent);\n    this.GameSuspend = new _Interaction_GameCommand2.default.GameSuspend(updater, gameSuspendEvent);\n    this.GameResume = new _Interaction_GameCommand2.default.GameResume(updater, gameResumeEvent);\n    this.ChangeImage = new _Interaction_GameCommand2.default.ChangeImage(concrete.ChangeImage, layersBackground);\n    this.RemoveImage = new _Interaction_GameCommand2.default.RemoveImage(concrete.RemoveImage, layersBackground);\n};\n//#endregion\n\n//behavior\n//#region\n/**\r\n * @param {Concrete.Event} event \r\n * @param {Concrete.Command} command \r\n */\nConcrete.Behavior = function (event, command, ballStore, barStore, blockStore, ballFactory, barFactory, itemFactory, ballShape, barShape, player, playerCountShape, updater, stageClearEvent, stageFailEvent) {\n    this.LostItemBreak = new _Interaction_GameBehavior2.default.LostItemBreakBinder(event.LostItem, command.BreakItem);\n    this.LostBulletBreak = new _Interaction_GameBehavior2.default.LostBulletBreakBinder(event.LostBullet, command.BreakBullet);\n    this.ExertItem = new _Interaction_GameBehavior2.default.ExertItemBinder(event.GetItem, command.ExertItem, command.BreakItem);\n    this.DragReelBall = new _Interaction_GameBehavior2.default.DragReelBallBinder(event.ImageDrag, command.ReelBall, updater);\n    this.ReleaseBall = new _Interaction_GameBehavior2.default.ReleaseBallBinder(event.Tap, command.ReleaseBall, ballStore);\n    this.BindedBarBallStart = new _Interaction_GameBehavior2.default.BindedBarBallStartBinder(event.Start, event.BarDrag, event.GameSuspend, event.GameResume, ballFactory, ballShape, barFactory, barShape, command.BallBarPosition, command.BallBindToBar, command.ReflectPlayerCount, command.MoveBar, player, playerCountShape);\n    this.HitCountBreak = new _Interaction_GameBehavior2.default.HitCountBreakBinder(event.Hit, command.BreakBlock);\n    this.HitCountCallback = new _Interaction_GameBehavior2.default.HitCountCallbackBinder(event.Hit);\n    this.HitBulletToHitBlock = new _Interaction_GameBehavior2.default.HitBulletToHitBlockBinder(event.HitBullet, event.Hit, command.BreakBullet);\n    this.BindedBarBallHit = new _Interaction_GameBehavior2.default.BindedBarBallHitBinder(event.HitBallBar, event.BarDrag, command.BallBarPositionBallOnBar, command.BallBindToBar, command.MoveBar, updater);\n    this.ChainBreak = new _Interaction_GameBehavior2.default.ChainBreakBinder(event.Break, command.BreakBlock);\n    this.HitEventCallback = new _Interaction_GameBehavior2.default.HitEventCallbackBinder(event.Hit);\n    this.HitBallEventCallback = new _Interaction_GameBehavior2.default.HitBallEventCallbackBinder(event.HitBall);\n    this.BreakEventCallback = new _Interaction_GameBehavior2.default.BreakEventCallbackBinder(event.Break);\n    this.HitBarBallSpeedUpAndLimit = new _Interaction_GameBehavior2.default.HitBarBallSpeedUpAndLimitBinder(event.HitBallBar, command.BallSpeedUpAndLimit);\n    this.StartEventCallback = new _Interaction_GameBehavior2.default.StartEventCallbackBinder(event.Start);\n    this.ClearEventCallback = new _Interaction_GameBehavior2.default.ClearEventCallbackBinder(event.Clear);\n    this.ClearTapStageClear = new _Interaction_GameBehavior2.default.ClearTapStageClearBinder(event.Clear, event.Tap, stageClearEvent);\n    this.ImmediateStageClear = new _Interaction_GameBehavior2.default.ImmediateStageClearBinder(event.Clear, stageClearEvent);\n    this.LabelTapEventCallback = new _Interaction_GameBehavior2.default.LabelTapEventCallbackBinder(event.LabelTap);\n    this.FailEventCallback = new _Interaction_GameBehavior2.default.FailEventCallbackBinder(event.Fail);\n    this.LostBallBreakPlayer = new _Interaction_GameBehavior2.default.LostBallBreakPlayerBinder(event.LostBall, command.BreakBall, command.ParticleBall, command.ParticleBar, command.BreakPlayer, ballStore, barStore);\n    this.AllBreakClear = new _Interaction_GameBehavior2.default.AllBreakClearBinder(event.Break, command.GameClear, blockStore);\n    this.PlayerLeftFailRestart = new _Interaction_GameBehavior2.default.PlayerLeftFailRestartBinder(event.BreakPlayer, player, updater, command.GameFail, command.GameStart);\n    this.OutAreaBreakBall = new _Interaction_GameBehavior2.default.OutAreaBreakBallBinder(event.Clear, event.Fail, command.OutAreaBreakBall, updater);\n};\n//#endregion\n\nexports.default = Concrete;\n\n//# sourceURL=webpack:///./src/Concrete.js?");

/***/ }),

/***/ "./src/Concrete_PixiP2.js":
/*!********************************!*\
  !*** ./src/Concrete_PixiP2.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Concrete = __webpack_require__(/*! ./Concrete */ \"./src/Concrete.js\");\n\nvar _Concrete2 = _interopRequireDefault(_Concrete);\n\nvar _Stage = __webpack_require__(/*! ./Stage */ \"./src/Stage.js\");\n\nvar _Stage2 = _interopRequireDefault(_Stage);\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nvar _Interaction_GameCommand = __webpack_require__(/*! ./Interaction_GameCommand */ \"./src/Interaction_GameCommand.js\");\n\nvar _Interaction_GameCommand2 = _interopRequireDefault(_Interaction_GameCommand);\n\nvar _Interaction_GameCommand_P = __webpack_require__(/*! ./Interaction_GameCommand_P2 */ \"./src/Interaction_GameCommand_P2.js\");\n\nvar _Interaction_GameCommand_P2 = _interopRequireDefault(_Interaction_GameCommand_P);\n\nvar _Interaction_GameCommand_Pixi = __webpack_require__(/*! ./Interaction_GameCommand_Pixi */ \"./src/Interaction_GameCommand_Pixi.js\");\n\nvar _Interaction_GameCommand_Pixi2 = _interopRequireDefault(_Interaction_GameCommand_Pixi);\n\nvar _Interaction_GameEvent = __webpack_require__(/*! ./Interaction_GameEvent */ \"./src/Interaction_GameEvent.js\");\n\nvar _Interaction_GameEvent2 = _interopRequireDefault(_Interaction_GameEvent);\n\nvar _Interaction_GameEvent_P = __webpack_require__(/*! ./Interaction_GameEvent_P2 */ \"./src/Interaction_GameEvent_P2.js\");\n\nvar _Interaction_GameEvent_P2 = _interopRequireDefault(_Interaction_GameEvent_P);\n\nvar _Interaction_GameEvent_Pixi = __webpack_require__(/*! ./Interaction_GameEvent_Pixi */ \"./src/Interaction_GameEvent_Pixi.js\");\n\nvar _Interaction_GameEvent_Pixi2 = _interopRequireDefault(_Interaction_GameEvent_Pixi);\n\nvar _Interaction_GameEvent_Binder = __webpack_require__(/*! ./Interaction_GameEvent_Binder */ \"./src/Interaction_GameEvent_Binder.js\");\n\nvar _Interaction_GameEvent_Binder2 = _interopRequireDefault(_Interaction_GameEvent_Binder);\n\nvar _Element_P = __webpack_require__(/*! ./Element_P2 */ \"./src/Element_P2.js\");\n\nvar _Element_P2 = _interopRequireDefault(_Element_P);\n\nvar _Element_Pixi = __webpack_require__(/*! ./Element_Pixi */ \"./src/Element_Pixi.js\");\n\nvar _Element_Pixi2 = _interopRequireDefault(_Element_Pixi);\n\nvar _Element_Helper_Pixi = __webpack_require__(/*! ./Element_Helper_Pixi */ \"./src/Element_Helper_Pixi.js\");\n\nvar _Element_Helper_Pixi2 = _interopRequireDefault(_Element_Helper_Pixi);\n\nvar _Element_Layer_Pixi = __webpack_require__(/*! ./Element_Layer_Pixi */ \"./src/Element_Layer_Pixi.js\");\n\nvar _Element_Layer_Pixi2 = _interopRequireDefault(_Element_Layer_Pixi);\n\nvar _Interaction_Pixi = __webpack_require__(/*! ./Interaction_Pixi */ \"./src/Interaction_Pixi.js\");\n\nvar _Interaction_Pixi2 = _interopRequireDefault(_Interaction_Pixi);\n\nvar _Interaction_P = __webpack_require__(/*! ./Interaction_P2 */ \"./src/Interaction_P2.js\");\n\nvar _Interaction_P2 = _interopRequireDefault(_Interaction_P);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Concrete_PixiP2 = {};\n\nConcrete_PixiP2.StageConcrete = function () {\n    _Stage2.default.IStageConcrete.call(this);\n\n    var world = new p2.World({ gravity: [0, 0] });\n    var textures = {};\n\n    var ballMaterial = new p2.Material();\n    var blockMaterial = new p2.Material();\n    var ballBlockContact = new p2.ContactMaterial(ballMaterial, blockMaterial, {\n        friction: 0,\n        restitution: 1\n    });\n    world.addContactMaterial(ballBlockContact);\n    world.applyDamping = false;\n\n    var domElement = document.getElementById(\"world\");\n\n    var rendererFactory = new _Element_Pixi2.default.RendererFactory(domElement);\n    this.getRendererFactory = function () {\n        return rendererFactory;\n    };\n\n    var stepCalculatorFactory = new _Interaction_P2.default.StepCalculatorFactory(world);\n    this.getStepCalculatorFactory = function () {\n        return stepCalculatorFactory;\n    };\n\n    var bodyPropertyFactory = new _Interaction_P2.default.BodyPropertyFactory();\n    this.getBodyPropertyFactory = function () {\n        return bodyPropertyFactory;\n    };\n\n    var viewPropertyFactory = new _Interaction_Pixi2.default.ViewPropertyFactory();\n    this.getViewPropertyFactory = function () {\n        return viewPropertyFactory;\n    };\n\n    var layerFactory = new _Element_Layer_Pixi2.default.LayerFactory();\n    this.getLayerFactory = function () {\n        return layerFactory;\n    };\n\n    var concreteShapeStoreImplementFactory = new Concrete_PixiP2.ConcreteShapeStoreImplementFactory(ballMaterial, blockMaterial);\n    this.getConcreteShapeStoreImplementFactory = function () {\n        return concreteShapeStoreImplementFactory;\n    };\n\n    var factoryConcreteFactory = new Concrete_PixiP2.FactoryFactory(world, textures);\n    this.getFactoryConcreteFactory = function () {\n        return factoryConcreteFactory;\n    };\n\n    var preBindBindersConcreteFactory = new Concrete_PixiP2.PreBindBindersConcreteFactory(world);\n    this.getPreBindBindersConcreteFactory = function () {\n        return preBindBindersConcreteFactory;\n    };\n\n    var commandConcreteFactory = new Concrete_PixiP2.CommandFactory(world, textures);\n    this.getCommandConcreteFactory = function () {\n        return commandConcreteFactory;\n    };\n\n    var helperConcreteFactory = new Concrete_PixiP2.HelperFactory(textures);\n    this.getHelperConcreteFactory = function () {\n        return helperConcreteFactory;\n    };\n};\nConcrete_PixiP2.StageConcreteFactory = function () {\n    _Stage2.default.IStageConcreteFactory.call(this);\n    this.create = function () {\n        var ret = new Concrete_PixiP2.StageConcrete();\n        return ret;\n    };\n};\n\n//event\n//#region\nConcrete_PixiP2.PreBindBindersConcreteFactory = function (world) {\n    _Concrete2.default.IPreBindBindersConcreteFactory.call(this);\n\n    this.createHitEventBinderConcrete = function () {\n        var ret = new _Interaction_GameEvent_P2.default.HitEventBinderConcrete(world);\n        return ret;\n    };\n    this.createHitBallBarEventBinderConcrete = function () {\n        var ret = new _Interaction_GameEvent_P2.default.HitBallBarEventBinderConcrete(world);\n        return ret;\n    };\n    this.createHitBulletEventBinderConcrete = function () {\n        var ret = new _Interaction_GameEvent_P2.default.HitBulletEventBinderConcrete(world);\n        return ret;\n    };\n    this.createLostBallEventBinderConcrete = function () {\n        var ret = new _Interaction_GameEvent_P2.default.LostBallEventBinderConcrete(world);\n        return ret;\n    };\n    this.createLostBulletEventBinderConcrete = function () {\n        var ret = new _Interaction_GameEvent_P2.default.LostBulletEventBinderConcrete(world);\n        return ret;\n    };\n    this.createGetItemEventBinderConcrete = function () {\n        var ret = new _Interaction_GameEvent_P2.default.GetItemEventBinderConcrete(world);\n        return ret;\n    };\n    this.createLostItemEventBinderConcrete = function () {\n        var ret = new _Interaction_GameEvent_P2.default.LostItemEventBinderConcrete(world);\n        return ret;\n    };\n    this.createTapEventConcrete = function (layer) {\n        var ret = new _Interaction_GameEvent_Pixi2.default.TapEventConcrete(layer.getConcrete());\n        return ret;\n    };\n    this.createBarAreaLocalDragEventConcrete = function (layer) {\n        var ret = new _Interaction_GameEvent_Pixi2.default.LocalDragEventConcrete(layer.getConcrete());\n        return ret;\n    };\n    this.createImageAreaLocalDragEventConcrete = function (layer) {\n        var ret = new _Interaction_GameEvent_Pixi2.default.LocalDragEventConcrete(layer.getConcrete());\n        return ret;\n    };\n};\n//#endregion\n\n//shape\n//#region\n/**\r\n * 各registのnameを省略(もしくは空文字)すると'default'が指定された事と同義となる。\r\n * @param {PIXI.Container} playAreaContainer \r\n * @param {PIXI.Container} playAreaPreviewContainer \r\n * @param {PIXI.Container} playerCountContainer \r\n * @param {PIXI.Container} labelContainer \r\n * @param {p2.Material} ballMaterial\r\n * @param {p2.Material} blockMaterial\r\n * @param {Element_Pixi.Renderer} renderer \r\n */\nConcrete_PixiP2.ConcreteShapeStoreImplement = function (playAreaContainer, playAreaPreviewContainer, playerCountContainer, labelContainer, ballMaterial, blockMaterial, renderer) {\n    _Concrete2.default.IConcreteShapeStoreImplement.call(this);\n\n    this.constract = function () {};\n\n    this.createViewShape = function (viewShapeFn) {\n        var ret = new _Element_Pixi2.default.GraphicsShape(playAreaContainer, viewShapeFn, _Element_Pixi2.default.KEY);\n        return ret;\n    };\n    this.createViewSizedShape = function (viewSizedShapeFn) {\n        var ret = new _Element_Pixi2.default.GraphicsSizedShape(playAreaContainer, viewSizedShapeFn, _Element_Pixi2.default.KEY);\n        return ret;\n    };\n    this.createViewSizedPreviewShape = function (viewSizedPreviewShapeFn) {\n        var ret = new _Element_Pixi2.default.GraphicsSizedShape(playAreaPreviewContainer, viewSizedPreviewShapeFn, _Element_Pixi2.default.KEY_PREVIEW);\n        return ret;\n    };\n    this.createTextShape = function (styleParams) {\n        var ret = new _Element_Pixi2.default.TextShape(styleParams);\n        return ret;\n    };\n    this.createPlayerCountShape = function (viewShapeFn) {\n        var ret = new _Element_Pixi2.default.PlayerCountShape(playerCountContainer, viewShapeFn);\n        return ret;\n    };\n    this.createLabelShape = function (viewSizedShapeFn) {\n        var ret = new _Element_Pixi2.default.GraphicsSizedShape(labelContainer, viewSizedShapeFn, _Element_Pixi2.default.KEY);\n        return ret;\n    };\n    this.createParticle = function (lifeTime, particleCount, viewShapeArrayFn, variablesFn) {\n        var ret = new _Element_Pixi2.default.ParticleBase(playAreaContainer, renderer, lifeTime, particleCount, viewShapeArrayFn, variablesFn);\n        return ret;\n    };\n\n    this.createBodyBallShape = function (bodyShapeFn) {\n        var ret = new _Element_P2.default.ShapeShape(bodyShapeFn, new _Element_P2.default.BallShapeAttribute(ballMaterial));\n        return ret;\n    };\n    this.createBodyBlockShape = function (bodySizedShapeFn) {\n        var ret = new _Element_P2.default.ShapeSizedShape(bodySizedShapeFn, new _Element_P2.default.BlockShapeAttribute(blockMaterial));\n        return ret;\n    };\n    this.createBodyItemShape = function (bodyShapeFn) {\n        var ret = new _Element_P2.default.ShapeShape(bodyShapeFn, new _Element_P2.default.ItemShapeAttribute());\n        return ret;\n    };\n    this.createBodyBulletShape = function (bodyShapeFn) {\n        var ret = new _Element_P2.default.ShapeShape(bodyShapeFn, new _Element_P2.default.BulletShapeAttribute());\n        return ret;\n    };\n    this.createBodyBarShape = function (bodyShapeFn) {\n        var ret = new _Element_P2.default.ShapeShape(bodyShapeFn, new _Element_P2.default.BarShapeAttribute(blockMaterial));\n        return ret;\n    };\n    this.createBodyLostAreaShape = function (bodyShapeFn) {\n        var ret = new _Element_P2.default.ShapeShape(bodyShapeFn, new _Element_P2.default.LostAreaShapeAttribute());\n        return ret;\n    };\n    this.createBodyPlayAreaShape = function (bodyShapeFn) {\n        var ret = new _Element_P2.default.ShapeShape(bodyShapeFn, new _Element_P2.default.PlayAreaShapeAttribute(blockMaterial));\n        return ret;\n    };\n};\nConcrete_PixiP2.ConcreteShapeStoreImplementFactory = function (ballMaterial, blockMaterial) {\n    _Concrete2.default.IConcreteShapeStoreImplementFactory.call(this);\n    this.create = function (renderer, playAreaLayer, playAreaPreviewLayer, playerCountLayer, labelLayer) {\n        var ret = new Concrete_PixiP2.ConcreteShapeStoreImplement(playAreaLayer.getConcrete(), playAreaPreviewLayer.getConcrete(), playerCountLayer.getConcrete(), labelLayer.getConcrete(), ballMaterial, blockMaterial, renderer);\n        return ret;\n    };\n};\n//#endregion\n\n//factory\n//#region\nConcrete_PixiP2.Factory = function (world, labelContainer, textures) {\n    _Concrete2.default.IFactoryConcrete.call(this);\n\n    var Balls = [new _Element_P2.default.BallPreShape(world)];\n    this.getBalls = function () {\n        return Balls;\n    };\n\n    var Blocks = [new _Element_P2.default.BlockPreShape(world)];\n    this.getBlocks = function () {\n        return Blocks;\n    };\n\n    var Items = [new _Element_P2.default.ItemPreShape(world)];\n    this.getItems = function () {\n        return Items;\n    };\n\n    var Bullets = [new _Element_P2.default.BulletPreShape(world)];\n    this.getBullets = function () {\n        return Bullets;\n    };\n\n    var Bars = [new _Element_P2.default.BarPreShape(world)];\n    this.getBars = function () {\n        return Bars;\n    };\n\n    var LostAreas = [new _Element_P2.default.LostAreaPreShape(world)];\n    this.getLostAreas = function () {\n        return LostAreas;\n    };\n\n    var PlayAreas = [new _Element_P2.default.PlayAreaPreShape(world)];\n    this.getPlayAreas = function () {\n        return PlayAreas;\n    };\n\n    var Labels = [new _Element_Pixi2.default.GraphicsShape(labelContainer, function (g) {\n        return g;\n    }, _Element_Pixi2.default.KEY)];\n    this.getLabels = function () {\n        return Labels;\n    };\n\n    var Images = [new _Element_Pixi2.default.ImagePreShape(textures)];\n    this.getImages = function () {\n        return Images;\n    };\n};\nConcrete_PixiP2.FactoryFactory = function (world, textures) {\n    _Concrete2.default.IFactoryConcreteFactory.call(this);\n\n    this.create = function (layer) {\n        var ret = new Concrete_PixiP2.Factory(world, layer.getConcrete(), textures);\n        return ret;\n    };\n};\n//#endregion\n\n//command\n//#region\n/**\r\n * @param {p2.World} world\r\n * @param {PIXI.Texture[]} textures 連想配列\r\n */\nConcrete_PixiP2.Command = function (world, textures) {\n    _Concrete2.default.AbstractCommandConcrete.call(this);\n\n    this.GameFail = []; //★未実装\n    this.GameStart = []; //★未実装\n    this.ImageLoad = {\n        jsonp: new _Interaction_GameCommand_Pixi2.default.ImageLoadGameStartJsonpImage(textures),\n        direct: new _Interaction_GameCommand_Pixi2.default.ImageLoadGameStartImgTag(textures)\n    };\n    this.PutBlock = [new _Interaction_GameCommand_P2.default.PutBlock(), new _Interaction_GameCommand_Pixi2.default.PutBlock()];\n    this.PutLabel = [new _Interaction_GameCommand_Pixi2.default.PutLabel()];\n    this.ChangeBlockMaskImage = [new _Interaction_GameCommand_Pixi2.default.ChangeBlockMaskImage(textures)];\n    this.BallBindReleaseBridge = [new _Interaction_GameCommand_P2.default.BallBindReleaseBridge()];\n    this.BallBindToBar = [new _Interaction_GameCommand_P2.default.BallBindToBarVelocityStore()];\n    this.ReleaseBall = [new _Interaction_GameCommand_P2.default.ReleaseBall()];\n    this.BallBarPosition = [new _Interaction_GameCommand_P2.default.BallBarPosition()];\n    this.BallBarPositionBallOnBar = [new _Interaction_GameCommand_P2.default.BallBarPositionBallY()];\n    this.ChangeBallAngle = [new _Interaction_GameCommand_P2.default.ChangeBallAngle()];\n    this.SyncBall = [new _Interaction_GameCommand_P2.default.SyncBall()];\n    this.MoveBar = [new _Interaction_GameCommand_P2.default.XLimitedByAabbMoveBar()];\n    this.BallSpeedUpAndLimit = [new _Interaction_GameCommand_P2.default.BallSpeedUpAndLimit()];\n    this.BallSpeedSet = [new _Interaction_GameCommand_P2.default.BallSpeedSet()];\n    this.BreakItem = [new _Interaction_GameCommand_Pixi2.default.BreakItem(), new _Interaction_GameCommand_P2.default.BreakItem()];\n    this.BreakBall = [new _Interaction_GameCommand_Pixi2.default.BreakBall(), new _Interaction_GameCommand_P2.default.BreakBall()];\n    this.OutAreaBreakBall = [new _Interaction_GameCommand_P2.default.OutAreaBreakBallRectangleArea()];\n    this.BreakBlock = [new _Interaction_GameCommand_Pixi2.default.BreakBlock(), new _Interaction_GameCommand_P2.default.BreakBlock()];\n    this.TweenElement = [new _Interaction_GameCommand_Pixi2.default.TweenElement()];\n    this.FadeScreen = new _Interaction_GameCommand_Pixi2.default.FadeScreenAlphaTweenFactory();\n    this.FlashLabel = [new _Interaction_GameCommand_Pixi2.default.FlashLabel()];\n    this.MoveItemToBlock = [new _Interaction_GameCommand_P2.default.MoveItemToBlock()];\n    this.DropItem = [new _Interaction_GameCommand_P2.default.DropItem()];\n    this.MoveBulletToBar = [new _Interaction_GameCommand_P2.default.MoveBulletToBar()];\n    this.ShootBullet = [new _Interaction_GameCommand_P2.default.ShootBullet()];\n    this.MoveBulletToBallRandomRaround = [new _Interaction_GameCommand_P2.default.MoveBulletToBallRandomRaround()];\n    this.BreakBullet = [new _Interaction_GameCommand_Pixi2.default.BreakBullet(), new _Interaction_GameCommand_P2.default.BreakBullet()];\n    this.DrawText = [new _Interaction_GameCommand_Pixi2.default.DrawText()];\n    this.DrawTextFramed = [new _Interaction_GameCommand_Pixi2.default.DrawTextFramed()];\n    this.ReelBall = [new _Interaction_GameCommand_P2.default.ReelBall()];\n    this.Tappable = [new _Interaction_GameCommand_Pixi2.default.Tappable()];\n    this.BreakPlayer = [];\n    this.BreakPlayerBarStoreProcess = [new _Interaction_GameCommand_Pixi2.default.BreakPlayer(), new _Interaction_GameCommand_P2.default.BreakPlayer()];\n    this.ParticleBlock = new _Interaction_GameCommand_Pixi2.default.ParticleBlock();\n    this.ParticleBall = new _Interaction_GameCommand_Pixi2.default.ParticleBall();\n    this.ParticleBar = new _Interaction_GameCommand_Pixi2.default.ParticleBar();\n    this.GameClear = [new _Interaction_GameCommand_P2.default.GameClear(world)];\n    this.GameClearStoreProcess = [new _Interaction_GameCommand_Pixi2.default.GameClearStoreProcess()];\n    this.ChangeImage = [new _Interaction_GameCommand_Pixi2.default.ChangeImageArraySourceFactory()];\n    this.RemoveImage = [new _Interaction_GameCommand_Pixi2.default.RemoveContainerImageFactory()];\n};\nConcrete_PixiP2.CommandFactory = function (world, textures) {\n    _Concrete2.default.ICommandConcreteFactory.call(this);\n\n    this.create = function () {\n        var ret = new Concrete_PixiP2.Command(world, textures);\n        return ret;\n    };\n};\n//#endregion\n\n//helper\n//#region\n/**\r\n * @param {PIXI.Texture[]} images 連想配列\r\n */\nConcrete_PixiP2.Helper = function (textures, renderer) {\n    _Concrete2.default.AbstractHelperConcrete.call(this);\n    this.ImageDiffDetector = new _Element_Helper_Pixi2.default.ImageDiffDetectorTextureArray(textures, renderer);\n};\nConcrete_PixiP2.HelperFactory = function (textures) {\n    _Concrete2.default.IHelperConcreteFactory.call(this);\n    this.create = function (renderer) {\n        var ret = new Concrete_PixiP2.Helper(textures, renderer);\n        return ret;\n    };\n};\n//#endregion\n\n\nexports.default = Concrete_PixiP2;\n\n//# sourceURL=webpack:///./src/Concrete_PixiP2.js?");

/***/ }),

/***/ "./src/Element.js":
/*!************************!*\
  !*** ./src/Element.js ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Element_Type = __webpack_require__(/*! ./Element_Type */ \"./src/Element_Type.js\");\n\nvar _Element_Type2 = _interopRequireDefault(_Element_Type);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//移行完了\n\nvar Element = {};\n\nElement.IRenderer = function () {\n    ///TODO このdo(fn)のfnは引数が生rendererになるので、typescript化の時にはジェネリックで実装する。\n    this.do = function (fn) {\n        throw new Error('未実装');\n    };\n    this.render = function () {\n        throw new Error('未実装');\n    };\n    this.destroy = function () {\n        throw new Error('未実装');\n    };\n};\nElement.IRendererFactory = function () {\n    this.create = function (stage, stageWidth, stageHeight, backgroundColor) {\n        throw new Error('未実装');\n    };\n};\n\nElement.AbstractElement = function (id, type) {\n    this.id = function () {\n        return id;\n    };\n    this.type = function () {\n        return type;\n    };\n    var alive = true;\n    this.isAlive = function () {\n        return alive;\n    };\n    this.break = function () {\n        alive = false;\n    };\n};\n\nElement.ElementHolder = function () {\n    var elements = {};\n    this.setElement = function (key, element) {\n        elements[key] = element;\n    };\n    this.getElement = function (key) {\n        return elements[key];\n    };\n};\n\nElement.Ball = function (id) {\n    Element.AbstractElement.call(this, id, _Element_Type2.default.Ball);\n    this.bindTo = null; //bind先のbar\n    Element.ElementHolder.call(this);\n};\n/**\r\n * @param {Element_Store.SerialNumber} serialNumber \r\n * @param {Element_Store.BallStore} store \r\n * @param {Interaction.Updater} updater \r\n * @param {Element_Shape.IShape[]} shapes\r\n */\nElement.BallFactory = function (serialNumber, store, updater, shapes) {\n    /**\r\n     * @param {Element_Shape.ShapeApplier} shape \r\n     */\n    this.createBall = function (shape) {\n        var ret = new Element.Ball(serialNumber.getNumber());\n        store.add(ret);\n        //updater.addBall(ret);\n        shapes.forEach(function (s) {\n            return s.applyShape(ret);\n        });\n        shape.applyShape(ret);\n        return ret;\n    };\n};\n\nElement.Bar = function (id) {\n    Element.AbstractElement.call(this, id, _Element_Type2.default.Bar);\n    Element.ElementHolder.call(this);\n};\n/**\r\n * @param {Element_Store.SerialNumber} serialNumber \r\n * @param {Element_Store.BarStore} store \r\n * @param {Interaction.Updater} updater \r\n * @param {Element_Shape.IShape[]} shapes\r\n */\nElement.BarFactory = function (serialNumber, store, updater, shapes) {\n    /**\r\n     * @param {Element_Shape.ShapeApplier} shape \r\n     */\n    this.createBar = function (shape) {\n        var ret = new Element.Bar(serialNumber.getNumber());\n        store.add(ret);\n        updater.addBar(ret);\n        shapes.forEach(function (s) {\n            return s.applyShape(ret);\n        });\n        shape.applyShape(ret);\n        return ret;\n    };\n};\n\n/**\r\n * 矩形とは限らない。\r\n */\nElement.Block = function (id) {\n    Element.AbstractElement.call(this, id, _Element_Type2.default.Block);\n    Element.ElementHolder.call(this);\n};\n/**\r\n * @param {Element_Store.SerialNumber} serialNumber \r\n * @param {Element_Store.BlockStore} store \r\n * @param {Element_Shape.ISizedShape[]} shapes\r\n */\nElement.BlockFactory = function (serialNumber, store, shapes) {\n    /**\r\n     * @param {Element_Shape.SizedShapeApplier} shape \r\n     * @param {Number} width\r\n     * @param {Number} height\r\n     */\n    this.createBlock = function (shape, width, height) {\n        var ret = new Element.Block(serialNumber.getNumber());\n        store.add(ret);\n        shapes.forEach(function (s) {\n            return s.applyShape(ret, width, height);\n        });\n        shape.applyShape(ret, width, height);\n        return ret;\n    };\n};\n\n/**\r\n * exert時にパラメータが必要な場合は、何とかして外部から手に入れる。\r\n * ballだったら、storeからランダムで1個とか。\r\n */\nElement.Item = function (id) {\n    Element.AbstractElement.call(this, id, _Element_Type2.default.Item);\n    var exertFn = null;\n    this.setExert = function (fn) {\n        exertFn = fn;\n    };\n    this.exert = function () {\n        if (exertFn != null) exertFn();\n    };\n    Element.ElementHolder.call(this);\n};\n/**\r\n * ここではitemの効果は設定しない。\r\n * @param {Element_Store.SerialNumber} serialNumber \r\n * @param {Element_Store.ItemStore} store \r\n * @param {Interaction.Updater} updater \r\n * @param {Element_Shape.IShape[]} shapes\r\n */\nElement.ItemFactory = function (serialNumber, store, updater, shapes) {\n    /**\r\n     * @param {Element_Shape.ShapeApplier} shape \r\n     */\n    this.createItem = function (shape) {\n        var ret = new Element.Item(serialNumber.getNumber());\n        store.add(ret);\n        updater.addItem(ret);\n        shapes.forEach(function (s) {\n            return s.applyShape(ret);\n        });\n        shape.applyShape(ret);\n        return ret;\n    };\n};\n\nElement.LostArea = function (id) {\n    Element.AbstractElement.call(this, id, _Element_Type2.default.LostArea);\n    Element.ElementHolder.call(this);\n};\n/**\r\n * @param {Element_Store.SerialNumber} serialNumber \r\n * @param {Element_Store.LostAreaStore} store \r\n * @param {Element_Shape.IShape[]} shapes\r\n */\nElement.LostAreaFactory = function (serialNumber, store, shapes) {\n    /**\r\n     * @param {Element_Shape.ShapeApplier} shape \r\n     */\n    this.createLostArea = function (shape) {\n        var ret = new Element.LostArea(serialNumber.getNumber());\n        store.add(ret);\n        shapes.forEach(function (s) {\n            return s.applyShape(ret);\n        });\n        shape.applyShape(ret);\n        return ret;\n    };\n};\n\nElement.PlayArea = function (id) {\n    Element.AbstractElement.call(this, id, _Element_Type2.default.PlayArea);\n    Element.ElementHolder.call(this);\n};\n/**\r\n * @param {Element_Store.SerialNumber} serialNumber \r\n * @param {Element_Store.PlayAreaStore} store \r\n * @param {Element_Shape.IShape[]} shapes\r\n */\nElement.PlayAreaFactory = function (serialNumber, store, shapes) {\n    /**\r\n     * @param {Element_Shape.ShapeApplier} shape \r\n     */\n    this.createPlayArea = function (shape) {\n        var ret = new Element.PlayArea(serialNumber.getNumber());\n        store.add(ret);\n        shapes.forEach(function (s) {\n            return s.applyShape(ret);\n        });\n        shape.applyShape(ret);\n        return ret;\n    };\n};\n\nElement.Bullet = function (id) {\n    Element.AbstractElement.call(this, id, _Element_Type2.default.Bullet);\n    Element.ElementHolder.call(this);\n};\n/**\r\n * @param {Element_Store.SerialNumber} serialNumber \r\n * @param {Element_Store.BulletStore} store \r\n * @param {Interaction.Updater} updater \r\n * @param {Element_Shape.IShape[]} shapes\r\n */\nElement.BulletFactory = function (serialNumber, store, updater, shapes) {\n    /**\r\n     * @param {Element_Shape.ShapeApplier} shape \r\n     */\n    this.createBullet = function (shape) {\n        var ret = new Element.Bullet(serialNumber.getNumber());\n        store.add(ret);\n        updater.addItem(ret);\n        shapes.forEach(function (s) {\n            return s.applyShape(ret);\n        });\n        shape.applyShape(ret);\n        return ret;\n    };\n};\n\nElement.Label = function (id) {\n    Element.AbstractElement.call(this, id, _Element_Type2.default.Label);\n    Element.ElementHolder.call(this);\n};\n/**\r\n * @param {Element_Store.SerialNumber} serialNumber \r\n * @param {Element_Store.LabelStore} store \r\n * @param {Element_Shape.IShape[]} shapes\r\n */\nElement.LabelFactory = function (serialNumber, store, shapes) {\n    this.createLabel = function () {\n        var ret = new Element.Label(serialNumber.getNumber());\n        store.add(ret);\n        shapes.forEach(function (s) {\n            return s.applyShape(ret);\n        });\n        return ret;\n    };\n};\n\nElement.Image = function (id, path) {\n    Element.AbstractElement.call(this, id, _Element_Type2.default.Label);\n    Element.ElementHolder.call(this);\n    this.path = path;\n};\n/**\r\n * @param {Element_Store.SerialNumber} serialNumber \r\n * @param {Element_Store.ImageStore} store \r\n * @param {Element_Shape.IShape[]} shapes\r\n */\nElement.ImageFactory = function (serialNumber, store, shapes) {\n    this.createImage = function (path) {\n        var ret = new Element.Image(serialNumber.getNumber(), path);\n        store.add(ret);\n        shapes.forEach(function (s) {\n            return s.applyShape(ret);\n        });\n        return ret;\n    };\n};\n\n/**\r\n * @param {Number} x \r\n * @param {Number} y \r\n * @param {Number} w \r\n * @param {Number} h \r\n */\nElement.Rect = function (x, y, w, h) {\n    /** @returns {Number} */\n    this.x = function () {\n        return x;\n    };\n    this.y = function () {\n        return y;\n    };\n    this.width = function () {\n        return w;\n    };\n    this.height = function () {\n        return h;\n    };\n    this.x2 = function () {\n        return x + w;\n    };\n    this.y2 = function () {\n        return y + h;\n    };\n    this.cx = function () {\n        return x + w / 2;\n    };\n    this.yx = function () {\n        return y + h / 2;\n    };\n    this.toString = function () {\n        return \"[x:\" + x + \",y:\" + y + \",w:\" + w + \",h:\" + h + \"]\";\n    };\n};\n\nexports.default = Element;\n\n//# sourceURL=webpack:///./src/Element.js?");

/***/ }),

/***/ "./src/Element_Effect.js":
/*!*******************************!*\
  !*** ./src/Element_Effect.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//移行完了\n\nvar Element_Effect = {};\n\n/**\r\n * promiseはtweenが終了したらresolveする。\r\n * cancelされるとreject。\r\n * @param {Number} id \r\n * @param {Number} duration 秒\r\n * @param {Element_Effect_Tween.ITween} xTween \r\n * @param {Number} xEnd\r\n * @param {Element_Effect_Tween.ITween} yTween \r\n * @param {Number} yEnd\r\n * @param {Element_Effect_Tween.ITween} ampTween 振幅\r\n * @param {Number} ampStart\r\n * @param {Number} ampEnd\r\n * @param {Element_Effect_Tween.ITween} alphaTween alpha startは1.0から\r\n * @param {Number} alphaStart\r\n * @param {Number} alphaEnd\r\n */\nElement_Effect.TweenFactory = function (duration, xTween, xEnd, yTween, yEnd, ampTween, ampStart, ampEnd, alphaTween, alphaStart, alphaEnd) {\n\n    var Tween = function Tween(duration, xTween, xEnd, yTween, yEnd, ampTween, ampStart, ampEnd) {\n        _Interaction2.default.IUpdaterListener.call(this);\n\n        var resolve = null;\n        var reject = null;\n        var promise = new Promise(function (_resolve, _reject) {\n            resolve = _resolve;reject = _reject;\n        });\n        var now = 0;\n        var callback = function callback() {};\n        /**\r\n         * リセットされる。\r\n         * @param {Function} callback(x, y, a)\r\n         */\n        this.setCallback = function (c) {\n            callback = c;now = 0;\n        };\n\n        this.exec = function (ticks) {\n            if (this.isEnd()) return;\n            now += ticks;\n            var pos = Math.min(1.0, Math.max(0.0, now / duration));\n            var x = xTween.calc(0.0, xEnd, pos) * ampTween.calc(ampStart, ampEnd, pos);\n            var y = yTween.calc(0.0, yEnd, pos) * ampTween.calc(ampStart, ampEnd, pos);\n            var a = alphaTween.calc(alphaStart, alphaEnd, pos);\n            callback(x, y, a);\n            if (this.isEnd()) resolve();\n        };\n        this.isEnd = function () {\n            return now > duration;\n        };\n        this.suspend = function () {};\n        this.resume = function () {};\n        this.isSuspend = function () {\n            return false;\n        };\n        this.cancel = function () {\n            now = duration + 1;\n            reject();\n        };\n        this.promise = function () {\n            return promise;\n        };\n    };\n\n    this.createTween = function (fn) {\n        var ret = new Tween(duration, xTween, xEnd, yTween, yEnd, ampTween, ampStart, ampEnd);\n        ret.setCallback(fn);\n        return ret;\n    };\n};\n\nexports.default = Element_Effect;\n\n//# sourceURL=webpack:///./src/Element_Effect.js?");

/***/ }),

/***/ "./src/Element_Effect_Tween.js":
/*!*************************************!*\
  !*** ./src/Element_Effect_Tween.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar Element_Effect_Tween = {};\n//移行完了\n\nElement_Effect_Tween.ITween = function () {\n    /**\r\n     * @param {Number} start \r\n     * @param {Number} end \r\n     * @param {Number} pos 0.0-1.0\r\n     */\n    this.calc = function (start, end, pos) {\n        throw new Error('未実装');\n    };\n};\n\nElement_Effect_Tween.Nop = new function () {\n    Element_Effect_Tween.ITween.call(this);\n    this.calc = function (start, end, pos) {\n        return start;\n    };\n}();\n\nElement_Effect_Tween.Linear = new function () {\n    Element_Effect_Tween.ITween.call(this);\n    this.calc = function (start, end, pos) {\n        var ret = start + (end - start) * pos;\n        return ret;\n    };\n}();\n\nElement_Effect_Tween.CubicIn = new function () {\n    Element_Effect_Tween.ITween.call(this);\n    this.calc = function (start, end, pos) {\n        var ret = start + (end - start) * pos * pos * pos;\n        return ret;\n    };\n}();\n\nElement_Effect_Tween.CubicOut = new function () {\n    Element_Effect_Tween.ITween.call(this);\n    this.calc = function (start, end, pos) {\n        var p = pos - 1;\n        var ret = start + (end - start) * (p * p * p + 1);\n        return ret;\n    };\n}();\n\n/**\r\n * startとendは0が0rad。1が2PIradとなる。\r\n */\nElement_Effect_Tween.Sin = new function () {\n    Element_Effect_Tween.ITween.call(this);\n    this.calc = function (start, end, pos) {\n        var rad = (start + (end - start) * pos) * Math.PI * 2;\n        var ret = Math.sin(rad);\n        return ret;\n    };\n}();\n\n/**\r\n * startとendは0が0rad。1が2PIradとなる。\r\n * 0-1の振幅。\r\n */\nElement_Effect_Tween.CosPositive = new function () {\n    Element_Effect_Tween.ITween.call(this);\n    this.calc = function (start, end, pos) {\n        var rad = (start + (end - start) * pos) * Math.PI * 2;\n        var ret = Math.cos(rad) * 0.5 + 0.5;\n        return ret;\n    };\n}();\n\nexports.default = Element_Effect_Tween;\n\n//# sourceURL=webpack:///./src/Element_Effect_Tween.js?");

/***/ }),

/***/ "./src/Element_Helper.js":
/*!*******************************!*\
  !*** ./src/Element_Helper.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar Element_Helper = {};\n//移行完了\n\nElement_Helper.ImageDiffDetector = function (concrete, detectFn) {\n    this.setImages = function (image1, image2) {\n        concrete.setImages(image1, image2);\n    };\n    this.isDifferent = function (x, y, w, h) {\n        var ret = detectFn(x, y, w, h, function (x, y) {\n            return concrete.isDifferent(x, y);\n        });\n        return ret;\n    };\n};\nElement_Helper.NinePointImageDiffDetector = function (concrete) {\n    Element_Helper.ImageDiffDetector.call(this, concrete, function (x, y, w, h, isDiff) {\n        var xp = [x, Math.floor(x + w / 2), x + w - 1];\n        var yp = [y, Math.floor(y + h / 2), y + h - 1];\n        var xy = [];\n        xp.forEach(function (xi) {\n            return yp.forEach(function (yi) {\n                return xy.push({ x: xi, y: yi });\n            });\n        });\n        var ret = xy.some(function (p) {\n            return isDiff(p.x, p.y);\n        });\n        return ret;\n    });\n};\nElement_Helper.IImageDiffDetector = function () {\n    this.setImages = function (image1, image2) {\n        throw new Error('未実装');\n    };\n    this.isDifferent = function (x, y) {\n        throw new Error('未実装');\n    };\n};\nElement_Helper.AlwaysTrueImageDiffDetector = function () {\n    Element_Helper.IImageDiffDetector.call(this);\n    this.setImages = function (image1, image2) {};\n    this.isDifferent = function (x, y) {\n        return true;\n    };\n};\n\nexports.default = Element_Helper;\n\n//# sourceURL=webpack:///./src/Element_Helper.js?");

/***/ }),

/***/ "./src/Element_Helper_Pixi.js":
/*!************************************!*\
  !*** ./src/Element_Helper_Pixi.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _pixi = __webpack_require__(/*! pixi.js */ \"./node_modules/pixi.js/lib/index.js\");\n\nvar PIXI = _interopRequireWildcard(_pixi);\n\nvar _Element_Helper = __webpack_require__(/*! ./Element_Helper */ \"./src/Element_Helper.js\");\n\nvar _Element_Helper2 = _interopRequireDefault(_Element_Helper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar Element_Helper_Pixi = {};\n\n/**\r\n * @param {Object} textureArray { ファイルパス: Texture }\r\n */\nElement_Helper_Pixi.ImageDiffDetectorTextureArray = function (textureArray, renderer) {\n    _Element_Helper2.default.IImageDiffDetector.call(this);\n\n    var Pixels = function Pixels(extract, sprite) {\n        //おそらくwebpack時のevalあたりの影響で、thisとかプロトタイプチェーンが辿れなくなる。\n        //その影響で、プラグイン系はnpmでinstallしておかないと動かない模様。\n        //以下のextractでその問題が発生したため、PIXIをnpm installしてimportさせている。\n        var pixels = extract.pixels(sprite);\n        var len = pixels.length;\n        var w = sprite.width;\n        var h = sprite.height;\n        function pos(x, y) {\n            //pixelの順番は以下の通り\n            //12\n            //34\n            //(w*y+x)*4\n            var ret = (w * y + x) * 4;\n            return ret;\n        }\n        function getPixel(x, y, offset) {\n            var p = pos(x, y) + offset;\n            var ret = pixels[p];\n            return ret;\n        }\n        this.getRGBA = function (x, y) {\n            if (x > w || y > h) {\n                //範囲外\n                return { r: 0, g: 0, b: 0, a: 0 };\n            };\n            return {\n                r: getPixel(x, y, 0),\n                g: getPixel(x, y, 1),\n                b: getPixel(x, y, 2),\n                a: getPixel(x, y, 3)\n            };\n        };\n    };\n\n    var pixels1 = null;\n    var pixels2 = null;\n\n    this.setImages = function (image1, image2) {\n        renderer.do(function (r) {\n            var extract = r.extract;\n            var s1 = new PIXI.Sprite(textureArray[image1]);\n            var s2 = new PIXI.Sprite(textureArray[image2]);\n            pixels1 = new Pixels(extract, s1);\n            pixels2 = new Pixels(extract, s2);\n        });\n    };\n    this.isDifferent = function (x, y) {\n        var p1 = pixels1.getRGBA(x, y);\n        var p2 = pixels2.getRGBA(x, y);\n\n        if (p1.a === 0 && p2.a === 0) return false;\n        //jpegは差が出ることがあるかもしれないから、何れかが差が5以上で異なるとみなす\n        var ret = [[p1.r, p2.r], [p1.g, p2.g], [p1.b, p2.b]].some(function (p) {\n            return Math.abs(p[0] - p[1]) > 5;\n        });\n        return ret;\n    };\n};\n\nexports.default = Element_Helper_Pixi;\n\n//# sourceURL=webpack:///./src/Element_Helper_Pixi.js?");

/***/ }),

/***/ "./src/Element_Layer.js":
/*!******************************!*\
  !*** ./src/Element_Layer.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n//import Element_Type from './Element_Type';\n//移行完了\n\nvar Element_Layer = {};\n\nElement_Layer.ILayer = function () {\n    ///TODO このgetConcreteはジェネリック対応となる。\n    this.getConcrete = function () {\n        throw new Error('未実装');\n    };\n    this.addChild = function (layer) {\n        throw new Error('未実装');\n    };\n    this.removeChild = function (layer) {\n        throw new Error('未実装');\n    };\n    this.setVisible = function (visible) {\n        throw new Error('未実装');\n    };\n    this.setSize = function (width, height) {\n        throw new Error('未実装');\n    };\n    this.setHitArea = function (x, y, width, height) {\n        throw new Error('未実装');\n    };\n};\nElement_Layer.ILayerFactory = function () {\n    this.createLayer = function () {\n        throw new Error('未実装');\n    };\n};\n\nexports.default = Element_Layer;\n\n//# sourceURL=webpack:///./src/Element_Layer.js?");

/***/ }),

/***/ "./src/Element_Layer_Pixi.js":
/*!***********************************!*\
  !*** ./src/Element_Layer_Pixi.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Element_Layer = __webpack_require__(/*! ./Element_Layer */ \"./src/Element_Layer.js\");\n\nvar _Element_Layer2 = _interopRequireDefault(_Element_Layer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Element_Layer_Pixi = {};\n\n/**\r\n * @param {PIXI.Container} container \r\n */\nElement_Layer_Pixi.Layer = function (container) {\n    _Element_Layer2.default.ILayer.call(this);\n\n    this.getConcrete = function () {\n        return container;\n    };\n    this.addChild = function (layer) {\n        var child = layer.getConcrete();\n        container.addChild(child);\n    };\n    this.removeChild = function (layer) {\n        var child = layer.getConcrete();\n        container.removeChild(child);\n    };\n    this.setVisible = function (visible) {\n        container.visible = visible;\n    };\n    this.setSize = function (width, height) {\n        container.width = width;\n        container.height = height;\n    };\n    this.setHitArea = function (x, y, width, height) {\n        container.hitArea = new PIXI.Rectangle(x, y, width, height);\n    };\n};\nElement_Layer_Pixi.LayerFactory = function () {\n    _Element_Layer2.default.ILayerFactory.call(this);\n\n    this.createLayer = function () {\n        var ret = new Element_Layer_Pixi.Layer(new PIXI.Container());\n        return ret;\n    };\n};\n\nexports.default = Element_Layer_Pixi;\n\n//# sourceURL=webpack:///./src/Element_Layer_Pixi.js?");

/***/ }),

/***/ "./src/Element_P2.js":
/*!***************************!*\
  !*** ./src/Element_P2.js ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Element = __webpack_require__(/*! ./Element */ \"./src/Element.js\");\n\nvar _Element2 = _interopRequireDefault(_Element);\n\nvar _Element_Shape = __webpack_require__(/*! ./Element_Shape */ \"./src/Element_Shape.js\");\n\nvar _Element_Shape2 = _interopRequireDefault(_Element_Shape);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Element_P2 = {};\n\nElement_P2.KEY = 'p2';\n\nElement_P2.COLLISION_BALL = Math.pow(2, 0);\nElement_P2.COLLISION_BLOCK = Math.pow(2, 1);\nElement_P2.COLLISION_BAR = Math.pow(2, 2);\nElement_P2.COLLISION_ITEM = Math.pow(2, 3);\nElement_P2.COLLISION_LOST = Math.pow(2, 4);\nElement_P2.COLLISION_BULLET = Math.pow(2, 5);\n\n//PreShape\n//#regist\n/**\r\n * @param {p2.World} world \r\n * @param {fn} bodyFn(id)\r\n */\nElement_P2.PreShape = function (world, bodyFn) {\n    _Element_Shape2.default.IShape.call(this);\n    this.applyShape = function (element) {\n        var body = bodyFn(element.id());\n        element.setElement(Element_P2.KEY, body);\n        world.addBody(body);\n    };\n};\n\n/**\r\n * @param {p2.World} world \r\n * @param {fn} bodyFn(id)\r\n */\nElement_P2.SizedPreShape = function (world, bodyFn) {\n    _Element_Shape2.default.ISizedShape.call(this);\n    this.applyShape = function (element, width, height) {\n        var body = bodyFn(element.id());\n        element.setElement(Element_P2.KEY, body);\n        world.addBody(body);\n    };\n};\n\nElement_P2.BallPreShape = function (world) {\n    Element_P2.PreShape.call(this, world, function (id) {\n        return new p2.Body({\n            mass: 1, //dynamic body\n            position: [0, 0],\n            id: id\n        });\n    });\n};\nElement_P2.BlockPreShape = function (world) {\n    Element_P2.SizedPreShape.call(this, world, function (id) {\n        return new p2.Body({\n            mass: 0, //static body\n            position: [0, 0],\n            id: id\n        });\n    });\n};\nElement_P2.ItemPreShape = function (world) {\n    Element_P2.PreShape.call(this, world, function (id) {\n        return new p2.Body({\n            mass: 1, //dynamic barやlostにヒットさせるため\n            position: [0, 0],\n            id: id\n        });\n    });\n};\nElement_P2.BulletPreShape = function (world) {\n    Element_P2.PreShape.call(this, world, function (id) {\n        return new p2.Body({\n            mass: 1, //dynamic barやlostにヒットさせるため\n            position: [0, 0],\n            id: id\n        });\n    });\n};\nElement_P2.BarPreShape = function (world) {\n    Element_P2.PreShape.call(this, world, function (id) {\n        return new p2.Body({\n            position: [0, 0],\n            id: id,\n            type: p2.Body.KINEMATIC,\n            allowSleep: false\n        });\n    });\n};\nElement_P2.LostAreaPreShape = function (world) {\n    Element_P2.PreShape.call(this, world, function (id) {\n        return new p2.Body({\n            mass: 0,\n            position: [0, 0],\n            id: id\n        });\n    });\n};\nElement_P2.PlayAreaPreShape = function (world) {\n    Element_P2.PreShape.call(this, world, function (id) {\n        return new p2.Body({\n            mass: 0,\n            position: [0, 0],\n            id: id\n        });\n    });\n};\n//#endregist\n\n\n//Shape\n//#region\nElement_P2.ShapeBase = function () {\n    this.removeOld = function (body) {\n        body.shapes.slice().forEach(function (s) {\n            return body.removeShape(s);\n        });\n        return body;\n    };\n    this.registNew = function (body, shapes) {\n        shapes.forEach(function (shape) {\n            var shapePosition = shape.position.slice();\n            body.addShape(shape);\n            //addShape時にshapeのpositionがリセット(上書き？)される\n            shape.position = shapePosition;\n        });\n        body.updateAABB();\n    };\n};\n/**\r\n * @param {Function} shapesCallback() return p2.Shape[]\r\n * @param {Element_P2.ShapeAttribute} attr\r\n */\nElement_P2.ShapeShape = function (shapesCallback, attr) {\n    _Element_Shape2.default.IShape.call(this);\n    Element_P2.ShapeBase.call(this);\n    this.applyShape = function (element) {\n        var body = element.getElement(Element_P2.KEY);\n        if (body == null) throw new Error('p2 body need setElement().');\n        var shapes = shapesCallback(body);\n        if (shapes == null || shapes.length === 0) return;\n        this.removeOld(body);\n        this.registNew(body, shapes);\n        body.shapes.forEach(function (s) {\n            return attr.applyAttribute(s);\n        });\n    };\n};\n/**\r\n * @param {Function} shapesCallback(width, height) return p2.Shape[]\r\n * @param {Element_P2.ShapeAttribute} attr\r\n */\nElement_P2.ShapeSizedShape = function (shapesCallback, attr) {\n    _Element_Shape2.default.ISizedShape.call(this);\n    Element_P2.ShapeBase.call(this);\n    this.applyShape = function (element, width, height) {\n        var body = element.getElement(Element_P2.KEY);\n        if (body == null) throw new Error('p2 body need setElement().');\n        var shapes = shapesCallback(width, height, body);\n        if (shapes == null || shapes.length === 0) return;\n        this.removeOld(body);\n        this.registNew(body, shapes);\n        body.shapes.forEach(function (s) {\n            return attr.applyAttribute(s);\n        });\n    };\n};\n//#endregion\n\n//ShapeAttribute\n//#region\nElement_P2.ShapeAttribute = function (fn) {\n    this.applyAttribute = function (shape) {\n        return fn(shape);\n    };\n};\nElement_P2.BallShapeAttribute = function (material) {\n    Element_P2.ShapeAttribute.call(this, function (shape) {\n        shape.material = material;\n        shape.collisionGroup = Element_P2.COLLISION_BALL;\n        shape.collisionMask = Element_P2.COLLISION_BLOCK | Element_P2.COLLISION_BAR | Element_P2.COLLISION_LOST;\n        return shape;\n    });\n};\nElement_P2.BarShapeAttribute = function (material) {\n    Element_P2.ShapeAttribute.call(this, function (shape) {\n        shape.material = material;\n        shape.collisionGroup = Element_P2.COLLISION_BAR;\n        shape.collisionMask = Element_P2.COLLISION_BALL | Element_P2.COLLISION_ITEM;\n        return shape;\n    });\n};\nElement_P2.BlockShapeAttribute = function (material) {\n    Element_P2.ShapeAttribute.call(this, function (shape) {\n        shape.material = material;\n        shape.collisionGroup = Element_P2.COLLISION_BLOCK;\n        shape.collisionMask = Element_P2.COLLISION_BALL | Element_P2.COLLISION_BULLET;\n        return shape;\n    });\n};\nElement_P2.BulletShapeAttribute = function () {\n    Element_P2.ShapeAttribute.call(this, function (shape) {\n        shape.material = null;\n        shape.sensor = true;\n        shape.collisionGroup = Element_P2.COLLISION_BULLET;\n        shape.collisionMask = Element_P2.COLLISION_BLOCK; //playareaもblock\n        return shape;\n    });\n};\nElement_P2.ItemShapeAttribute = function () {\n    Element_P2.ShapeAttribute.call(this, function (shape) {\n        shape.material = null;\n        shape.sensor = true;\n        shape.collisionGroup = Element_P2.COLLISION_ITEM;\n        shape.collisionMask = Element_P2.COLLISION_BAR | Element_P2.COLLISION_LOST;\n        return shape;\n    });\n};\nElement_P2.LostAreaShapeAttribute = function () {\n    Element_P2.ShapeAttribute.call(this, function (shape) {\n        shape.material = null;\n        shape.sensor = true;\n        shape.collisionGroup = Element_P2.COLLISION_LOST;\n        shape.collisionMask = Element_P2.COLLISION_BALL | Element_P2.COLLISION_ITEM;\n        return shape;\n    });\n};\nElement_P2.PlayAreaShapeAttribute = function (material) {\n    Element_P2.ShapeAttribute.call(this, function (shape) {\n        shape.material = material;\n        shape.collisionGroup = Element_P2.COLLISION_BLOCK;\n        shape.collisionMask = Element_P2.COLLISION_BALL;\n        return shape;\n    });\n};\n//#endregion\n\n\nexports.default = Element_P2;\n\n//# sourceURL=webpack:///./src/Element_P2.js?");

/***/ }),

/***/ "./src/Element_Particle.js":
/*!*********************************!*\
  !*** ./src/Element_Particle.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//移行完了\n\nvar Element_Particle = {};\n\n/**\r\n * promiseは全てのparticleがendしたらresolveする。\r\n */\nElement_Particle.ParticleSet = function (particles) {\n    _Interaction2.default.IUpdaterListener.call(this);\n\n    var resolve = null;\n    var reject = null;\n    var promise = new Promise(function (_resolve, _reject) {\n        resolve = _resolve;reject = _reject;\n    });\n    var length = particles.length;\n    var rest = particles.length;\n\n    this.exec = function (ticks) {\n        if (this.isEnd()) return;\n        for (var i = 0; i < length; i++) {\n            var p = particles[i];\n            if (p === null) continue;\n            if (p.isEnd()) {\n                particles[i] = null;\n                p.end();\n                rest--;\n                continue;\n            }\n            p.update(ticks);\n        }\n        if (this.isEnd()) resolve();\n    };\n    this.isEnd = function () {\n        return rest === 0;\n    };\n    this.suspend = function () {};\n    this.resume = function () {};\n    this.isSuspend = function () {\n        return false;\n    };\n    this.cancel = function () {\n        for (var i = 0; i < length; i++) {\n            var p = particles[i];\n            if (p === null) continue;\n            particles[i] = null;\n            p.end();\n            rest--;\n        }\n        reject();\n    };\n    this.promise = function () {\n        return promise;\n    };\n};\n\n/**\r\n * @param {Number} max プール数の最大。\r\n * @param {Number} step プールの追加単位。\r\n * @param {Function}  particleFn(params, variables) params={key1:val1, key2:val2} variables={key1:num1, key2:num2} \r\n */\nElement_Particle.Pool = function (max, step, particleFn) {\n    var self = this;\n    var pool = [];\n\n    function add() {\n        var add = Array(step).fill(0).map(function (a) {\n            return new Element_Particle.Particle(self, particleFn, endPush);\n        });\n        Array.prototype.push.apply(pool, add);\n    }\n\n    function autoAdd() {\n        if (pool.length >= max) return;\n        add();\n        setTimeout(autoAdd, 0);\n    }\n\n    this.pulls = function (number) {\n        while (pool.length < number) {\n            add();\n        }\n        var ret = pool.splice(0, number);\n        autoAdd();\n        return ret;\n    };\n\n    function endPush(particle) {\n        pool.push(particle);\n    }\n};\n\n/**\r\n * @param {Element_Particle.Pool} pool \r\n * @param {Function} particleFn(params, variables) params={key1:val1, key2:val2} variables={key1:num1, key2:num2}\r\n * @param {Function} endPush(particle)\r\n */\nElement_Particle.Particle = function (pool, particleFn, endPush) {\n    var self = this;\n\n    var lifeSec = 0;\n    var lifeSecStart = 0;\n    var params = null;\n    var variables = null;\n\n    /**\r\n     * @param {Number} sec lifeSec\r\n     * @param {Object} p {key1: val1, key2: val2, ...} staticな値に\r\n     * @param {Object} v {key: [start, end, Element_Particle.ITween], ...} 動的な値に\r\n     */\n    this.setParams = function (sec, p, v) {\n        lifeSec = sec;\n        lifeSecStart = sec;\n        params = p;\n        variables = v;\n    };\n    this.update = function (ticks) {\n        lifeSec -= ticks;\n        var v = {};\n        var pos = Math.min(1.0, Math.max(0.0, (lifeSecStart - lifeSec) / lifeSecStart));\n        Object.keys(variables).forEach(function (key) {\n            var variable = variables[key];\n            v[key] = variable[2].calc(variable[0], variable[1], pos);\n        });\n        particleFn(params, v);\n    };\n    this.isEnd = function () {\n        return lifeSec < 0;\n    };\n    this.end = function () {\n        endPush(self);\n    };\n};\n\nElement_Particle.IParticleConcrete = function () {\n    this.setup = function () {\n        throw new Error('未実装');\n    };\n    this.count = function () {\n        throw new Error('未実装');\n    };\n    this.life = function () {\n        throw new Error('未実装');\n    };\n    this.createParams = function () {\n        throw new Error('未実装');\n    };\n    this.createVariables = function () {\n        throw new Error('未実装');\n    };\n    this.move = function (x, y) {\n        throw new Error('未実装');\n    };\n};\n\nexports.default = Element_Particle;\n\n//# sourceURL=webpack:///./src/Element_Particle.js?");

/***/ }),

/***/ "./src/Element_Pixi.js":
/*!*****************************!*\
  !*** ./src/Element_Pixi.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Element = __webpack_require__(/*! ./Element */ \"./src/Element.js\");\n\nvar _Element2 = _interopRequireDefault(_Element);\n\nvar _Element_Shape = __webpack_require__(/*! ./Element_Shape */ \"./src/Element_Shape.js\");\n\nvar _Element_Shape2 = _interopRequireDefault(_Element_Shape);\n\nvar _Element_Particle = __webpack_require__(/*! ./Element_Particle */ \"./src/Element_Particle.js\");\n\nvar _Element_Particle2 = _interopRequireDefault(_Element_Particle);\n\nvar _Interaction_GameEvent_Binder = __webpack_require__(/*! ./Interaction_GameEvent_Binder */ \"./src/Interaction_GameEvent_Binder.js\");\n\nvar _Interaction_GameEvent_Binder2 = _interopRequireDefault(_Interaction_GameEvent_Binder);\n\nvar _Interaction_GameEvent_Pixi = __webpack_require__(/*! ./Interaction_GameEvent_Pixi */ \"./src/Interaction_GameEvent_Pixi.js\");\n\nvar _Interaction_GameEvent_Pixi2 = _interopRequireDefault(_Interaction_GameEvent_Pixi);\n\nvar _Interaction_GameCommand = __webpack_require__(/*! ./Interaction_GameCommand */ \"./src/Interaction_GameCommand.js\");\n\nvar _Interaction_GameCommand2 = _interopRequireDefault(_Interaction_GameCommand);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Element_Pixi = {};\n\nElement_Pixi.KEY = 'pixi';\nElement_Pixi.KEY_PREVIEW = 'pixi_preview';\n\nElement_Pixi.Renderer = function (width, height, backgroudColor, domElement, stage) {\n    _Element2.default.IRenderer.call(this);\n\n    var first = true;\n\n    var renderer = PIXI.autoDetectRenderer({\n        //width:width, height:height, backgroundColor:backgroudColor\n        width: 1, height: 1, backgroundColor: backgroudColor\n    });\n    //renderer.destroy(true)で消える\n    // while (domElement.firstChild) {\n    //     domElement.removeChild(domElement.firstChild);\n    // }\n    //domElement.appendChild(renderer.view);\n\n    //白に戻るのを防止\n    domElement.style.height = height + 'px';\n    domElement.style.backgroundColor = '#' + ('000000' + backgroudColor.toString(16)).slice(-6);\n\n    this.do = function (fn) {\n        return fn(renderer);\n    };\n    this.render = function () {\n        if (first) {\n            //autoDetectRendererの段階でサイズを指定すると、一瞬黒が写って具合が悪いので、ここでresize\n            renderer.resize(width, height);\n            domElement.appendChild(renderer.view);\n            first = false;\n        }\n        renderer.render(stage);\n    };\n    this.destroy = function () {\n        stage.destroy();\n        renderer.destroy(true);\n    };\n};\nElement_Pixi.RendererFactory = function (domElement) {\n    _Element2.default.IRendererFactory.call(this);\n\n    this.create = function (stage, stageWidth, stageHeight, backgroundColor) {\n        var ret = new Element_Pixi.Renderer(stageWidth, stageHeight, backgroundColor, domElement, stage.getConcrete());\n        return ret;\n    };\n};\n\n//Shape\n//#region\n/**\r\n * @param {PIXI.Container} container \r\n */\nElement_Pixi.GraphicsBase = function (container, key) {\n    if (container == null) throw new Error('container null');\n    this.check = function (element) {\n        var old = element.getElement(key);\n        if (old != null) return;\n        var parent = new PIXI.Container();\n        container.addChild(parent);\n        element.setElement(key, parent);\n    };\n    this.change = function (element, shape) {\n        var parent = element.getElement(key);\n        shape.name = element.id();\n        parent.name = element.id();\n        parent.removeChildren();\n        parent.addChild(shape);\n    };\n};\n\n/**\r\n * @param {PIXI.Container} container \r\n * @param {Function} graphicsCallback(graphics) return graphics\r\n */\nElement_Pixi.GraphicsShape = function (container, graphicsCallback, key) {\n    _Element_Shape2.default.IShape.call(this);\n    Element_Pixi.GraphicsBase.call(this, container, key);\n    this.applyShape = function (element) {\n        this.check(element);\n        var shape = graphicsCallback(new PIXI.Graphics());\n        this.change(element, shape);\n    };\n};\n/**\r\n * @param {PIXI.Container} container \r\n * @param {Function} graphicsCallback(graphics, width, height) return graphics\r\n */\nElement_Pixi.GraphicsSizedShape = function (container, graphicsCallback, key) {\n    _Element_Shape2.default.ISizedShape.call(this);\n    Element_Pixi.GraphicsBase.call(this, container, key);\n    this.applyShape = function (element, width, height) {\n        this.check(element);\n        var shape = graphicsCallback(new PIXI.Graphics(), width, height);\n        this.change(element, shape);\n    };\n};\nElement_Pixi.TextShape = function (styleParams) {\n    _Element_Shape2.default.ITextShape.call(this);\n    this.applyShape = function (text, sizedShapeFn) {\n        //left, center, right\n        //top, center, bottom\n        var style = new PIXI.TextStyle(styleParams);\n        var metrics = PIXI.TextMetrics.measureText(text, style);\n        var textSprite = new PIXI.Text(text, style);\n        sizedShapeFn(metrics.width, metrics.height, textSprite);\n    };\n};\n\nElement_Pixi.ImagePreShape = function (textureArray) {\n    _Element_Shape2.default.IShape.call(this);\n    this.applyShape = function (element) {\n        var sprite = new PIXI.Sprite(textureArray[element.path]);\n        var container = new PIXI.Container();\n        container.addChild(sprite);\n        element.setElement(Element_Pixi.KEY, container);\n    };\n};\n\nElement_Pixi.PlayerCountShape = function (container, playerGraphicsFn) {\n    _Interaction_GameCommand2.default.IPlayerCountShape.call(this);\n    this.clear = function () {\n        container.removeChildren();\n    };\n    this.draw = function (x, y) {\n        var g = playerGraphicsFn(new PIXI.Graphics());\n        container.addChild(g);\n        g.x = x;\n        g.y = y;\n    };\n};\n//#endregion\n\n/**\r\n * @param {PIXI.Container} container \r\n * @param {Element_Pixi.Renderer} renderer\r\n * @param {Number} lifeTime パーティクルの最大保持時間\r\n * @param {Number} particleCount パーティクルの数\r\n * @param {Function} graphicsFn() PIXI.Graphics[]\r\n * @param {Function} variablesFn() Element_Particle.Poolの仕様に合わせること\r\n */\nElement_Pixi.ParticleBase = function (container, renderer, lifeTime, particleCount, graphicsFn, variablesFn) {\n    _Element_Particle2.default.IParticleConcrete.call(this);\n\n    var particleContainer = null;\n    var textures = null;\n\n    this.setup = function () {\n        particleContainer = new PIXI.Container(); //new PIXI.ParticleContainer(particleCount, {tint:true});\n        textures = graphicsFn(function () {\n            return new PIXI.Graphics();\n        }).map(function (g) {\n            return renderer.do(function (r) {\n                return r.generateTexture(g);\n            });\n        });\n    };\n    this.count = function () {\n        return particleCount;\n    };\n    this.life = function () {\n        return lifeTime;\n    };\n    this.createParams = function () {\n        var sprite = new PIXI.Sprite(textures[Math.floor(Math.random() * textures.length)]);\n        particleContainer.addChild(sprite);\n        return { sprite: sprite };\n    };\n    this.createVariables = function () {\n        return variablesFn();\n    };\n    this.move = function (x, y) {\n        particleContainer.x = x;\n        particleContainer.y = y;\n        container.addChild(particleContainer);\n    };\n};\n\nexports.default = Element_Pixi;\n\n//# sourceURL=webpack:///./src/Element_Pixi.js?");

/***/ }),

/***/ "./src/Element_Shape.js":
/*!******************************!*\
  !*** ./src/Element_Shape.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Element_P = __webpack_require__(/*! ./Element_P2 */ \"./src/Element_P2.js\");\n\nvar _Element_P2 = _interopRequireDefault(_Element_P);\n\nvar _Element_Pixi = __webpack_require__(/*! ./Element_Pixi */ \"./src/Element_Pixi.js\");\n\nvar _Element_Pixi2 = _interopRequireDefault(_Element_Pixi);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//移行完了\n\nvar Element_Shape = {};\n\nElement_Shape.IShape = function () {\n    /**\r\n     * @param {Element.ElementHolder} element \r\n     */\n    this.applyShape = function (element) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * @param {Element_Shape.IShape[]} shapes \r\n */\nElement_Shape.ShapeApplier = function (shapes) {\n    Element_Shape.IShape.call(this);\n    this.applyShape = function (element) {\n        shapes.forEach(function (s) {\n            return s.applyShape(element);\n        });\n    };\n};\n\nElement_Shape.ISizedShape = function () {\n    /**\r\n     * @param {Element.ElementHolder} element \r\n     * @param {Number} width\r\n     * @param {Number} height\r\n     */\n    this.applyShape = function (element, width, height) {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Element_Shape.ISizedShape[]} shapes \r\n */\nElement_Shape.SizedShapeApplier = function (shapes) {\n    Element_Shape.ISizedShape.call(this);\n    this.applyShape = function (element, width, height) {\n        shapes.forEach(function (s) {\n            return s.applyShape(element, width, height);\n        });\n    };\n};\n\nElement_Shape.ITextShape = function () {\n    /**\r\n     * \r\n     * @param {Element.ElementHolder} element \r\n     * @param {string} text \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {string} hAlign \r\n     * @param {string} vAlign \r\n     * @param {Function} sizedShapeFn(element, width, height)\r\n     */\n    this.applyShape = function (element, text, x, y, hAlign, vAlign, sizedShapeFn) {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Element_Shape.ITextShape[]} shapes \r\n */\nElement_Shape.TextShapeApplier = function (shapes) {\n    Element_Shape.ITextShape.call(this);\n    this.applyShape = function (element, text, x, y, hAlign, vAlign, sizedShapeFn) {\n        shapes.forEach(function (s) {\n            return s.applyShape(element, text, x, y, hAlign, vAlign, sizedShapeFn);\n        });\n    };\n};\n\n/**\r\n * 物理演算上の形状\r\n */\nElement_Shape.IBodyShape = function () {\n    this.Box = function (x, y, w, h) {\n        throw new Error('未実装');\n    };\n    this.Circle = function (radius) {\n        throw new Error('未実装');\n    };\n    this.SizedBox = function () {\n        throw new Error('未実装');\n    };\n    /**\r\n     * yの正方向にpile倍厚くしたbox。中心はpile倍する前のboxの中心。\r\n     * 厚くすることで、貫通せずに当たるようにしている。\r\n     */\n    this.PiledCenterBox = function (w, h, pile) {\n        throw new Error('未実装');\n    };\n    this.RectPlayArea = function (w, h, thick) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * 外見上の形状\r\n */\nElement_Shape.IViewShape = function () {\n    this.Empty = function () {\n        throw new Error('未実装');\n    };\n    this.Rect = function (x, y, w, h, color, alpha) {\n        throw new Error('未実装');\n    };\n    this.Circle = function (radius, color, alpha) {\n        throw new Error('未実装');\n    };\n    this.CustomCircle = function (radiusFn, colorFn, alphaFn) {\n        throw new Error('未実装');\n    };\n    this.ExplosionBullet = function (minRadius, maxRadius, color) {\n        throw new Error('未実装');\n    };\n    /**\r\n     * 中心はrectの中心。\r\n     */\n    this.CenterRect = function (w, h, color, alpha) {\n        throw new Error('未実装');\n    };\n    this.SizedEmpty = function () {\n        throw new Error('未実装');\n    };\n    this.SizedRect = function (color, alpha) {\n        throw new Error('未実装');\n    };\n    this.SizedPreviewRect = function () {\n        throw new Error('未実装');\n    };\n    this.SizedHeart = function (color) {\n        throw new Error('未実装');\n    };\n    this.SizedTear = function (color) {\n        throw new Error('未実装');\n    };\n    this.LabelMenuOpen = function (color, alpha) {\n        throw new Error('未実装');\n    };\n    this.LabelMenuClose = function (color, alpha) {\n        throw new Error('未実装');\n    };\n    this.LabelBlockPreview = function (foreColor, backColor, alpha) {\n        throw new Error('未実装');\n    };\n    this.LabelSlowBall = function (foreColor, backColor, alpha) {\n        throw new Error('未実装');\n    };\n    this.LabelFastBall = function (foreColor, backColor, alpha) {\n        throw new Error('未実装');\n    };\n    this.LabelChangeDirection = function (foreColor, backColor, alpha) {\n        throw new Error('未実装');\n    };\n    this.TriangleParticle = function (max, min, colors) {\n        throw new Error('未実装');\n    };\n    this.CircleParticle = function (max, min, colors) {\n        throw new Error('未実装');\n    };\n};\n\nexports.default = Element_Shape;\n\n//# sourceURL=webpack:///./src/Element_Shape.js?");

/***/ }),

/***/ "./src/Element_Shape_P2.js":
/*!*********************************!*\
  !*** ./src/Element_Shape_P2.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Element_Shape = __webpack_require__(/*! ./Element_Shape */ \"./src/Element_Shape.js\");\n\nvar _Element_Shape2 = _interopRequireDefault(_Element_Shape);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Element_Shape_P2 = {};\n\nElement_Shape_P2.Shapes = function () {\n    _Element_Shape2.default.IBodyShape.call(this);\n    this.Box = function (x, y, w, h) {\n        return function (body) {\n            return [new p2.Box({\n                //P2のBoxは中心基準。左上基準に合わせる。\n                width: w, height: h, position: [x + w / 2, y + h / 2]\n            })];\n        };\n    };\n    this.Circle = function (radius) {\n        return function (body) {\n            return [new p2.Circle({\n                radius: radius\n            })];\n        };\n    };\n    this.SizedBox = function () {\n        return function (w, h, body) {\n            return [new p2.Box({\n                //P2のBoxは中心基準。左上基準に合わせる。\n                width: w, height: h, position: [w / 2, h / 2]\n            })];\n        };\n    };\n    this.PiledCenterBox = function (w, h, pile) {\n        return function (body) {\n            return [new p2.Box({\n                width: w, height: h * pile, position: [0, h * (pile - 1) / 2]\n            })];\n        };\n    };\n    this.RectPlayArea = function (w, h, thick) {\n        return function (body) {\n            return [new p2.Box({ //上\n                width: w, height: thick, position: [w / 2, -thick / 2]\n            }), new p2.Box({ //左\n                width: thick, height: h, position: [-thick / 2, h / 2]\n            }), new p2.Box({ //右\n                width: thick, height: h, position: [w + thick / 2, h / 2]\n            })];\n        };\n    };\n};\n\nexports.default = Element_Shape_P2;\n\n//# sourceURL=webpack:///./src/Element_Shape_P2.js?");

/***/ }),

/***/ "./src/Element_Shape_Pixi.js":
/*!***********************************!*\
  !*** ./src/Element_Shape_Pixi.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Element_Shape = __webpack_require__(/*! ./Element_Shape */ \"./src/Element_Shape.js\");\n\nvar _Element_Shape2 = _interopRequireDefault(_Element_Shape);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Element_Shape_Pixi = {};\n\nElement_Shape_Pixi.Shapes = function () {\n    _Element_Shape2.default.IViewShape.call(this);\n\n    this.Empty = function () {\n        return function (g) {\n            return g;\n        };\n    };\n    this.Rect = function (x, y, w, h, color, alpha) {\n        return function (g) {\n            return g.beginFill(color, alpha).drawRect(0, 0, w, h).endFill();\n        };\n    };\n    this.Circle = function (radius, color, alpha) {\n        return function (g) {\n            g.beginFill(color, alpha).drawCircle(0, 0, radius).endFill();\n            return g;\n        };\n    };\n    this.CustomCircle = function (radiusFn, colorFn, alphaFn) {\n        return function (g) {\n            g.beginFill(colorFn(), alphaFn()).drawCircle(0, 0, radiusFn()).endFill();\n            return g;\n        };\n    };\n    this.ExplosionBullet = function (minRadius, maxRadius, color) {\n        return this.CustomCircle(function () {\n            return minRadius + Math.floor((maxRadius - minRadius) * Math.random());\n        }, function () {\n            return color;\n        }, function () {\n            return 1.0;\n        });\n    };\n    this.CenterRect = function (w, h, color, alpha) {\n        return function (g) {\n            return g.beginFill(color, alpha).drawRect(-w / 2, -h / 2, w, h).endFill();\n        };\n    };\n    this.SizedEmpty = function () {\n        return function (g, w, h) {\n            return g;\n        };\n    };\n    this.SizedRect = function (color, alpha) {\n        return function (g, w, h) {\n            return g.beginFill(color, alpha).drawRect(0, 0, w, h).endFill();\n        };\n    };\n    this.SizedPreviewRect = function () {\n        return function (g, w, h) {\n            return g.beginFill(0xFF0000, 0.2).drawRect(0, 0, w, h).endFill();\n        };\n    };\n    this.SizedHeart = function (color) {\n        return function (g, w, h) {\n            var sw = w / 8;\n            var sh = h / 8;\n            return g.moveTo(0, sh * 3).beginFill(color, 1).bezierCurveTo(sw * 0, sh * 0, sw * 3, sh * 0, sw * 4, sh * 2).bezierCurveTo(sw * 5, sh * 0, sw * 8, sh * 0, sw * 8, sh * 3).bezierCurveTo(sw * 8, sh * 6, sw * 4, sh * 8, sw * 4, sh * 8).bezierCurveTo(sw * 4, sh * 8, sw * 0, sh * 6, sw * 0, sh * 3).endFill();\n        };\n    };\n    this.SizedTear = function (color) {\n        if (color == null) color = 0x000000;\n        return function (g, w, h) {\n            var margin = Math.max(20, w > h ? h / 4 : w / 4);\n            var sw = w > h ? 4 : 3; //長辺は4、短辺は3\n            var sh = h > w ? 4 : 3;\n            var aw = w + margin * 2; //全長\n            var ah = h + margin * 2;\n            var dw = aw / sw; //間隔\n            var dh = ah / sh;\n            var fw = dw / 3; //ゆらぎ\n            var fh = dh / 3;\n\n            //const mask = new PIXI.Graphics();\n            var mask = g;\n            mask.moveTo(0, -margin);\n            mask.beginFill(color, 1);\n            //上\n            for (var i = 0; i < sw - 1; i++) {\n                var d = (dw + (Math.random() - 0.5) * fw) / 3;\n                mask.bezierCurveTo(dw * i + d * 1, 0, dw * i + d * 2, 0, dw * i + d * 3, -margin - Math.random() * fh);\n            }\n            //上->右\n            mask.bezierCurveTo(w, 0, w, 0, w + margin, 0);\n            //右\n            for (var _i = 0; _i < sh - 1; _i++) {\n                var _d = (dh + (Math.random() - 0.5) * fh) / 3;\n                mask.bezierCurveTo(w, dh * _i + _d * 1, w, dh * _i + _d * 2, w + margin + Math.random() * fw, dh * _i + _d * 3);\n            }\n            //右->下\n            mask.bezierCurveTo(w, h, w, h, w, h + margin);\n            //下\n            for (var _i2 = 0; _i2 < sw - 1; _i2++) {\n                var _d2 = (dw + (Math.random() - 0.5) * fw) / 3;\n                mask.bezierCurveTo(w - dw * _i2 - _d2 * 1, h, w - dw * _i2 - _d2 * 2, h, w - dw * _i2 - _d2 * 3, h + margin + Math.random() * fh);\n            }\n            //下->左\n            mask.bezierCurveTo(0, h, 0, h, -margin, h);\n            //左\n            for (var _i3 = 0; _i3 < sh - 1; _i3++) {\n                var _d3 = (dh + (Math.random() - 0.5) * fh) / 3;\n                mask.bezierCurveTo(0, h - dh * _i3 - _d3 * 1, 0, h - dh * _i3 - _d3 * 2, -margin - Math.random() * fw, h - dh * _i3 - _d3 * 3);\n            }\n            //左->上\n            mask.bezierCurveTo(0, 0, 0, 0, 0, -margin);\n            mask.endFill();\n            return mask;\n        };\n    };\n    this.LabelMenuOpen = function (color, alpha) {\n        return function (g, w, h) {\n            var sw = Math.floor(w / 10);\n            var sh = Math.floor(h / 10);\n            g.beginFill(0x00000, 0).drawRect(0, 0, w, h).endFill(); //タッチ反応用\n            g.beginFill(color, alpha).moveTo(sw * 2, sh * 2).lineTo(sw * 8, sh * 5).lineTo(sw * 2, sh * 8).closePath().endFill();\n            return g;\n        };\n    };\n    this.LabelMenuClose = function (color, alpha) {\n        return function (g, w, h) {\n            var sw = Math.floor(w / 10);\n            var sh = Math.floor(h / 10);\n            g.beginFill(0x00000, 0).drawRect(0, 0, w, h).endFill(); //タッチ反応用\n            g.beginFill(color, alpha).moveTo(sw * 2, sh * 5).lineTo(sw * 8, sh * 2).lineTo(sw * 8, sh * 8).closePath().endFill();\n            return g;\n        };\n    };\n    this.LabelBlockPreview = function (foreColor, backColor, alpha) {\n        return function (g, w, h) {\n            var sw = Math.floor(w / 10);\n            var sh = Math.floor(h / 10);\n            var border = Math.min(sw, sh);\n            g.beginFill(backColor, alpha).drawRoundedRect(0, 0, w, h, sw * 2).endFill();\n            g.lineStyle(border, foreColor, alpha).moveTo(sw * 1, sh * 5).bezierCurveTo(sw * 3, sh * 2, sw * 7, sh * 2, sw * 9, sh * 5).bezierCurveTo(sw * 7, sh * 8, sw * 3, sh * 8, sw * 1, sh * 5).closePath();\n            g.beginFill(foreColor, alpha).lineStyle(0).drawEllipse(sw * 5, sh * 5, sw * 1, sh * 1).endFill();\n            return g;\n        };\n    };\n    this.LabelSlowBall = function (foreColor, backColor, alpha) {\n        return function (g, w, h) {\n            var sw = Math.floor(w / 10);\n            var sh = Math.floor(h / 10);\n            var r = Math.min(sw, sh);\n            g.beginFill(backColor, alpha).drawRoundedRect(0, 0, w, h, sw * 2).endFill();\n            g.beginFill(foreColor, alpha / 3).drawCircle(sw * 3, sh * 7, r * 2).endFill();\n            g.beginFill(foreColor, alpha / 3 * 2).drawCircle(sw * 5, sh * 5, r * 2).endFill();\n            g.beginFill(foreColor, alpha).drawCircle(sw * 6, sh * 4, r * 2).endFill();\n            return g;\n        };\n    };\n    this.LabelFastBall = function (foreColor, backColor, alpha) {\n        return function (g, w, h) {\n            var sw = Math.floor(w / 10);\n            var sh = Math.floor(h / 10);\n            var r = Math.min(sw, sh);\n            g.beginFill(backColor, alpha).drawRoundedRect(0, 0, w, h, sw * 2).endFill();\n            g.beginFill(foreColor, alpha / 3).drawCircle(sw * 3, sh * 7, r * 2).endFill();\n            g.beginFill(foreColor, alpha / 3 * 2).drawCircle(sw * 4, sh * 6, r * 2).endFill();\n            g.beginFill(foreColor, alpha).drawCircle(sw * 7, sh * 3, r * 2).endFill();\n            return g;\n        };\n    };\n    this.LabelChangeDirection = function (foreColor, backColor, alpha) {\n        return function (g, w, h) {\n            var sw = Math.floor(w / 10);\n            var sh = Math.floor(h / 10);\n            var border = Math.min(sw, sh);\n            var r = Math.min(sw, sh);\n            g.beginFill(backColor, alpha).drawRoundedRect(0, 0, w, h, sw * 2).endFill();\n            g.lineStyle(border, foreColor, alpha / 2).moveTo(sw * 2, sh * 8).lineTo(sw * 4, sh * 4).lineTo(sw * 7, sh * 3);\n            g.lineStyle(0);\n            g.beginFill(foreColor, alpha).drawCircle(sw * 7, sh * 3, r * 2).endFill();\n            return g;\n        };\n    };\n    this.TriangleParticle = function (max, min, colors) {\n        function maxToMax(max) {\n            return Math.floor(Math.random() * (max * 2 + 1) - max);\n        }\n        function maxToMin(max, min) {\n            return Math.floor(Math.random() * (max - min + 1) + min);\n        }\n        return function (create) {\n            var ret = colors.map(function (c) {\n                var x1 = maxToMax(max);\n                var y1 = maxToMin(max, min);\n                var x2 = maxToMin(max, min);\n                var y2 = -maxToMin(max, min);\n                var x3 = -maxToMin(max, min);\n                var y3 = -maxToMin(max, min);\n                return create().beginFill(c, 1).moveTo(x1, y1).lineTo(x2, y2).lineTo(x3, y3).closePath().endFill();\n            });\n            return ret;\n        };\n    };\n    this.CircleParticle = function (max, min, colors) {\n        function maxToMin(max, min) {\n            return Math.floor(Math.random() * (max - min + 1) + min);\n        }\n        return function (create) {\n            var ret = colors.map(function (c) {\n                var r = maxToMin(max, min);\n                return create().beginFill(c, 1).drawCircle(0, 0, r).endFill();\n            });\n            return ret;\n        };\n    };\n};\n\nexports.default = Element_Shape_Pixi;\n\n//# sourceURL=webpack:///./src/Element_Shape_Pixi.js?");

/***/ }),

/***/ "./src/Element_Store.js":
/*!******************************!*\
  !*** ./src/Element_Store.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar Element_Store = {};\n//移行完了\n\nElement_Store.SerialNumber = function () {\n    //    if(Element_Store.SerialNumber.instance != null) return Element_Store.SerialNumber.instance;\n\n    //0から始めると、プロパティにしたときどうやらバグる。null扱いになるのか？\n    var count = 1;\n    this.getNumber = function () {\n        return count++;\n    };\n\n    //    Element_Store.SerialNumber.instance = this;\n    //    return this;\n};\n\nElement_Store.Player = function () {\n    this.count = 0;\n};\n\n/**\r\n * obj.id()をキーにstoreする実装。\r\n */\nElement_Store.IdKeyStore = function (addActionFn, removeActionFn) {\n    var store = {};\n    var count = 0;\n    this.add = function (obj) {\n        store[obj.id()] = obj;count++;\n        addActionFn(obj);\n    };\n    this.remove = function (obj) {\n        this.removeById(obj.id());\n    };\n    this.removeById = function (id) {\n        store[id].break();\n        delete store[id];\n        removeActionFn(id);\n        count--;\n    };\n    this.removeAll = function () {\n        var _this = this;\n\n        Object.keys(store).forEach(function (id) {\n            _this.removeById(id);\n        });\n    };\n    this.get = function (id) {\n        return store[id];\n    };\n    this.count = function () {\n        return count;\n    };\n    this.getOne = function () {\n        return store[Object.keys(store)[0]];\n    };\n    this.getRandomOne = function () {\n        var keys = Object.keys(store);\n        var ret = store[keys[Math.floor(keys.length * Math.random())]];\n        return ret;\n    };\n    this.forEach = function (fn) {\n        var ret = [];\n        Object.keys(store).forEach(function (key) {\n            if (store[key] == null) return;\n            ret.push(fn(store[key]));\n        });\n        return ret;\n    };\n    this._all = function () {\n        return store;\n    };\n};\n\nElement_Store.BallStore = function (updater) {\n    Element_Store.IdKeyStore.call(this, function (obj) {\n        return updater.addBall(obj);\n    }, function (id) {\n        return updater.removeBallById(id);\n    });\n};\n\nElement_Store.BulletStore = function (updater) {\n    Element_Store.IdKeyStore.call(this, function (obj) {\n        return updater.addBullet(obj);\n    }, function (id) {\n        return updater.removeBulletById(id);\n    });\n};\n\nElement_Store.BlockStore = function () {\n    Element_Store.IdKeyStore.call(this, function () {}, function () {});\n};\n\nElement_Store.ItemStore = function (updater) {\n    Element_Store.IdKeyStore.call(this, function (obj) {\n        return updater.addItem(obj);\n    }, function (id) {\n        return updater.removeItemById(id);\n    });\n};\n\nElement_Store.LostAreaStore = function () {\n    Element_Store.IdKeyStore.call(this, function () {}, function () {});\n};\n\nElement_Store.PlayAreaStore = function () {\n    Element_Store.IdKeyStore.call(this, function () {}, function () {});\n};\n\nElement_Store.BarStore = function (updater) {\n    Element_Store.IdKeyStore.call(this, function (obj) {\n        return updater.addBar(obj);\n    }, function (id) {\n        return updater.removeBarById(id);\n    });\n};\n\nElement_Store.LabelStore = function () {\n    Element_Store.IdKeyStore.call(this, function () {}, function () {});\n};\n\nElement_Store.ImageStore = function () {\n    Element_Store.IdKeyStore.call(this, function () {}, function () {});\n};\n\nexports.default = Element_Store;\n\n//# sourceURL=webpack:///./src/Element_Store.js?");

/***/ }),

/***/ "./src/Element_Type.js":
/*!*****************************!*\
  !*** ./src/Element_Type.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n//移行完了\nvar Element_Type = {};\n\nElement_Type.Block = 1;\nElement_Type.Ball = 2;\nElement_Type.Bar = 3;\nElement_Type.Item = 4;\nElement_Type.LostArea = 5;\nElement_Type.PlayArea = 6;\nElement_Type.Bullet = 7;\nElement_Type.Label = 8;\n\nexports.default = Element_Type;\n\n//# sourceURL=webpack:///./src/Element_Type.js?");

/***/ }),

/***/ "./src/Interaction.js":
/*!****************************!*\
  !*** ./src/Interaction.js ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Element_P = __webpack_require__(/*! ./Element_P2 */ \"./src/Element_P2.js\");\n\nvar _Element_P2 = _interopRequireDefault(_Element_P);\n\nvar _Element_Pixi = __webpack_require__(/*! ./Element_Pixi */ \"./src/Element_Pixi.js\");\n\nvar _Element_Pixi2 = _interopRequireDefault(_Element_Pixi);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//移行完了\n\nvar Interaction = {};\n\nInteraction.IEventBinder = function () {\n    this.on = function () {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n\nInteraction.GameEventBinder = function (binders) {\n    Interaction.IEventBinder.call(this);\n    var isOn = null;\n    var addedBinders = [];\n    this.on = function () {\n        isOn = true;\n        binders.forEach(function (binder) {\n            return binder.on();\n        });\n        addedBinders.forEach(function (binder) {\n            return binder.on();\n        });\n    };\n    this.off = function () {\n        isOn = false;\n        binders.forEach(function (binder) {\n            return binder.off();\n        });\n        addedBinders.forEach(function (binder) {\n            return binder.off();\n        });\n    };\n    /**\r\n     * @param {Interaction.IEventBinder} binder \r\n     */\n    this.add = function (binder) {\n        addedBinders.push(binder);\n        if (isOn === null) return;\n        if (isOn) binder.on();else binder.off();\n    };\n};\n\nInteraction.IUpdaterListener = function () {\n    this.exec = function (ticks) {\n        throw new Error('未実装');\n    };\n    this.suspend = function () {\n        throw new Error('未実装');\n    };\n    this.resume = function () {\n        throw new Error('未実装');\n    };\n    this.isSuspend = function () {\n        throw new Error('未実装');\n    };\n    this.isEnd = function () {\n        throw new Error('未実装');\n    };\n    this.cancel = function () {\n        throw new Error('未実装');\n    };\n    this.promise = function () {\n        throw new Error('未実装');\n    };\n};\n\nInteraction.IStepCalculator = function () {\n    this.calc = function (stepSec) {\n        throw new Error('未実装');\n    };\n};\nInteraction.IStepCalculatorFactory = function () {\n    this.create = function () {\n        throw new Error('未実装');\n    };\n};\n\nInteraction.IBodyProperty = function () {\n    /**\r\n     * @param {Element.ElementHolder} element \r\n     */\n    this.setElement = function (element) {\n        throw new Error('未実装');\n    };\n    this.getX = function () {\n        throw new Error('未実装');\n    };\n    this.getY = function () {\n        throw new Error('未実装');\n    };\n};\nInteraction.IBodyPropertyFactory = function () {\n    this.create = function () {\n        throw new Error('未実装');\n    };\n};\n\nInteraction.IViewProperty = function () {\n    /**\r\n     * @param {Element.ElementHolder} element \r\n     */\n    this.setElement = function (element) {\n        throw new Error('未実装');\n    };\n    this.setX = function (x) {\n        throw new Error('未実装');\n    };\n    this.setY = function (y) {\n        throw new Error('未実装');\n    };\n};\nInteraction.IViewPropertyFactory = function () {\n    this.create = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * @param {Element.IRenderer} renderer \r\n * @param {Interaction.IStepCalculator} stepCalc \r\n * @param {Interaction.IBodyProperty} body\r\n * @param {Interaction.IViewProperty} view\r\n */\nInteraction.Updater = function (renderer, stepCalc, body, view) {\n    var UpdaterListenerContainer = function UpdaterListenerContainer(id, listener) {\n        this.id = function () {\n            return id;\n        };\n        this.exec = function (ticks) {\n            listener.exec(ticks);\n        };\n        this.suspend = function () {\n            return listener.suspend();\n        };\n        this.resume = function () {\n            return listener.resume();\n        };\n        this.isSuspend = function () {\n            return listener.isSuspend();\n        };\n        this.isEnd = function () {\n            return listener.isEnd();\n        };\n        this.cancel = function () {\n            return listener.cancel();\n        };\n    };\n\n    var listeners = {};\n    var listenerId = 1;\n    var balls = {};\n    var bullets = {};\n    var items = {};\n    var bars = {};\n\n    var lastTick = 0;\n    var isSuspend = false;\n\n    function forEach(arr) {\n        Object.keys(arr).forEach(function (key) {\n            var element = arr[key];\n            body.setElement(element);\n            view.setElement(element);\n            view.setX(body.getX());\n            view.setY(body.getY());\n        });\n    }\n\n    function procListener(dt) {\n        var endListenerIds = [];\n        Object.keys(listeners).forEach(function (key) {\n            var listener = listeners[key];\n            if (listener.isSuspend()) return;\n            listener.exec(dt);\n            if (listener.isEnd()) endListenerIds.push(listener.id());\n        });\n        endListenerIds.forEach(function (id) {\n            return delete listeners[id];\n        });\n    }\n\n    var ticksAverage = [];\n    this.update = function (ticks) {\n        var dt = (ticks - lastTick) / 1000;\n        lastTick = ticks;\n        if (dt === 0.0) return;\n        //非アクティブから戻ると、dtが極端に大きくなる。\n        //dtが大きいとボールなどが飛んで行ってしまうので、大きい場合は無視する。\n        //直近5フレーム分の遅さ以上はスキップ\n        if (ticksAverage.length < 5) {\n            ticksAverage.push(dt);\n            if (dt > 1.0) return;\n        } else {\n            var limit = ticksAverage.reduce(function (acc, cur) {\n                return acc + cur;\n            }, 0.0);\n            if (dt > limit) return;\n            ticksAverage.push(dt);\n            ticksAverage.shift();\n        }\n\n        if (!isSuspend) stepCalc.calc(dt);\n\n        procListener(dt);\n        forEach(balls);\n        forEach(items);\n        forEach(bars);\n        forEach(bullets);\n\n        renderer.render();\n    };\n    this.suspend = function () {\n        isSuspend = true;\n        Object.keys(listeners).forEach(function (key) {\n            var listener = listeners[key];\n            listener.suspend();\n        });\n    };\n    this.resume = function () {\n        isSuspend = false;\n        Object.keys(listeners).forEach(function (key) {\n            var listener = listeners[key];\n            listener.resume();\n        });\n    };\n\n    this.off = function () {\n        renderer.destroy();\n    };\n\n    /**\r\n     * @param {Interaction.IUpdaterListener} listener \r\n     * @return {Number} cancelId\r\n     */\n    this.addListener = function (listener) {\n        //簡易チェック\n        if (listener['exec'] == null) throw new Error('listener is not listener');\n\n        var c = new UpdaterListenerContainer(listenerId++, listener);\n        listeners[c.id()] = c;\n        return c.id();\n    };\n    this.cancelListener = function (cancelId) {\n        var listener = listeners[cancelId];\n        if (listener == null) return;\n        if (!listener.isEnd()) listener.cancel();\n        delete listeners[cancelId];\n    };\n\n    this.removeAllElements = function () {\n        Object.keys(balls).forEach(function (k) {\n            return delete balls[k];\n        });\n        Object.keys(bullets).forEach(function (k) {\n            return delete bullets[k];\n        });\n        Object.keys(bars).forEach(function (k) {\n            return delete bars[k];\n        });\n        Object.keys(items).forEach(function (k) {\n            return delete items[k];\n        });\n    };\n\n    this.addBall = function (ball) {\n        balls[ball.id()] = ball;\n    };\n    this.removeBallById = function (id) {\n        delete balls[id];\n    };\n\n    this.addBullet = function (bullet) {\n        bullets[bullet.id()] = bullet;\n    };\n    this.removeBulletById = function (id) {\n        delete bullets[id];\n    };\n\n    this.addBar = function (bar) {\n        bars[bar.id()] = bar;\n    };\n    this.removeBarById = function (id) {\n        delete bars[id];\n    };\n\n    this.addItem = function (item) {\n        items[item.id()] = item;\n    };\n    this.removeItemById = function (id) {\n        delete items[id];\n    };\n};\n\nexports.default = Interaction;\n\n//# sourceURL=webpack:///./src/Interaction.js?");

/***/ }),

/***/ "./src/Interaction_GameBehavior.js":
/*!*****************************************!*\
  !*** ./src/Interaction_GameBehavior.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nvar _Interaction_GameEvent = __webpack_require__(/*! ./Interaction_GameEvent */ \"./src/Interaction_GameEvent.js\");\n\nvar _Interaction_GameEvent2 = _interopRequireDefault(_Interaction_GameEvent);\n\nvar _Interaction_UpdaterListener = __webpack_require__(/*! ./Interaction_UpdaterListener */ \"./src/Interaction_UpdaterListener.js\");\n\nvar _Interaction_UpdaterListener2 = _interopRequireDefault(_Interaction_UpdaterListener);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n * １つのGameEventの入力に対し、GameCommandの出力を行う(場合によっては複数)。\r\n * つまりイベントに対する挙動。\r\n * 入力は一つなので、基本的にEventListenerの実装になる。\r\n * Factory系もロジック外への出力である。\r\n * \r\n * xxxBinderは、それら挙動を実際のEventにbindし、動くようにする。\r\n * \r\n * 基本的にxxxBinder系をnewしてコンストラクタに渡して使わせる。\r\n */\nvar Interaction_GameBehavior = {};\n\n/**\r\n * 指定回数で壊れるブロックの挙動。\r\n * @param {Interaction_GameCommand.BreakBlock} breakBlock \r\n */\nInteraction_GameBehavior.HitCountBreak = function (breakBlock) {\n    _Interaction_GameEvent2.default.IHitEventListener.call(this);\n\n    var block = null;\n    var count = null;\n    /**\r\n     * @param {Element.Block} _block \r\n     * @param {Number} _count \r\n     */\n    this.bindParams = function (_block, _count) {\n        block = _block;\n        count = _count;\n    };\n\n    this.fired = function (_block) {\n        if (block.id() !== _block.id()) return;\n        if (count === 0) return;\n\n        count--;\n        if (count !== 0) return;\n        breakBlock.exec(_block);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.HitEvent} hitEvent \r\n * @param {Interaction_GameCommand.BreakBlock} breakBlock \r\n */\nInteraction_GameBehavior.HitCountBreakBinder = function (hitEvent, breakBlock) {\n    /**\r\n     * @param {Element.Block} block \r\n     * @param {Number} count \r\n     */\n    this.exec = function (block, count) {\n        var listener = new Interaction_GameBehavior.HitCountBreak(breakBlock);\n        listener.bindParams(block, count);\n        hitEvent.addListener(listener);\n    };\n};\n\n/**\r\n * 指定回数でcallbackするブロックの挙動。\r\n */\nInteraction_GameBehavior.HitCountCallback = function () {\n    _Interaction_GameEvent2.default.IHitEventListener.call(this);\n\n    var block = null;\n    var count = null;\n    var callback = null;\n    /**\r\n     * @param {Element.Block} _block \r\n     * @param {Number} _count \r\n     */\n    this.bindParams = function (_block, _count, _callback) {\n        block = _block;\n        count = _count;\n        callback = _callback;\n    };\n\n    this.fired = function (_block) {\n        if (block.id() !== _block.id()) return;\n        if (count === 0) return;\n\n        count--;\n        if (count !== 0) return;\n        callback(_block);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.HitEvent} hitEvent \r\n */\nInteraction_GameBehavior.HitCountCallbackBinder = function (hitEvent) {\n    /**\r\n     * @param {Element.Block} block \r\n     * @param {Number} count \r\n     * @param {function} callback\r\n     */\n    this.exec = function (block, count, callback) {\n        var listener = new Interaction_GameBehavior.HitCountCallback();\n        listener.bindParams(block, count, callback);\n        hitEvent.addListener(listener);\n    };\n};\n\n/**\r\n * hit時にcallbackを呼ぶ挙動。\r\n */\nInteraction_GameBehavior.HitEventCallback = function () {\n    _Interaction_GameEvent2.default.IHitEventListener.call(this);\n\n    var block = null;\n    var callback = null;\n    this.bindParams = function (_block, _callback) {\n        block = _block;\n        callback = _callback;\n    };\n    this.fired = function (_block) {\n        if (block.id() !== _block.id()) return;\n        callback(_block);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.HitEvent} hitEvent \r\n */\nInteraction_GameBehavior.HitEventCallbackBinder = function (hitEvent) {\n    this.exec = function (block, callback) {\n        var listener = new Interaction_GameBehavior.HitEventCallback();\n        listener.bindParams(block, callback);\n        hitEvent.addListener(listener);\n    };\n};\n\n/**\r\n * hitBall時にcallbackを呼ぶ挙動。\r\n */\nInteraction_GameBehavior.HitBallEventCallback = function () {\n    _Interaction_GameEvent2.default.IHitBallEventListener.call(this);\n\n    var block = null;\n    var callback = null;\n    this.bindParams = function (_block, _callback) {\n        block = _block;\n        callback = _callback;\n    };\n    this.fired = function (_block, _ball) {\n        if (block.id() !== _block.id()) return;\n        callback(_block, _ball);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.HitBallEvent} hitBallEvent \r\n */\nInteraction_GameBehavior.HitBallEventCallbackBinder = function (hitBallEvent) {\n    this.exec = function (block, callback) {\n        var listener = new Interaction_GameBehavior.HitBallEventCallback();\n        listener.bindParams(block, callback);\n        hitBallEvent.addListener(listener);\n    };\n};\n\n/**\r\n * block break時にcallbackを呼ぶ挙動。\r\n */\nInteraction_GameBehavior.BreakEventCallback = function () {\n    _Interaction_GameEvent2.default.IBreakEventListener.call(this);\n\n    var block = null;\n    var callback = null;\n    this.bindParams = function (_block, _callback) {\n        block = _block;\n        callback = _callback;\n    };\n    this.fired = function (_block) {\n        if (block.id() !== _block.id()) return;\n        callback(_block);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.BreakEvent} breakEvent \r\n */\nInteraction_GameBehavior.BreakEventCallbackBinder = function (breakEvent) {\n    this.exec = function (block, callback) {\n        var listener = new Interaction_GameBehavior.BreakEventCallback();\n        listener.bindParams(block, callback);\n        breakEvent.addListener(listener);\n    };\n};\n\n/**\r\n * bar hit時にballの速度がアップする挙動。\r\n * @param {Interaction_GameCommand.BallSpeedUpAndLimit} ballSpeedUpAndLimit \r\n */\nInteraction_GameBehavior.HitBarBallSpeedUpAndLimit = function (ballSpeedUpAndLimit) {\n    _Interaction_GameEvent2.default.IHitBallBarEventListener.call(this);\n    var upRatio = null;\n    var limit = null;\n    this.bindParams = function (_upRatio, _limit) {\n        upRatio = _upRatio;\n        limit = _limit;\n    };\n    this.fired = function (ball, bar) {\n        ballSpeedUpAndLimit.exec(ball, upRatio, limit);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.HitBallBarEvent} hitBallBarEvent \r\n * @param {Interaction_GameCommand.BallSpeedUpAndLimit} ballSpeedUpAndLimit \r\n */\nInteraction_GameBehavior.HitBarBallSpeedUpAndLimitBinder = function (hitBallBarEvent, ballSpeedUpAndLimit) {\n    this.exec = function (upRatio, limit) {\n        var listener = new Interaction_GameBehavior.HitBarBallSpeedUpAndLimit(ballSpeedUpAndLimit);\n        listener.bindParams(upRatio, limit);\n        hitBallBarEvent.addListener(listener);\n    };\n};\n\n/**\r\n * game start時にcallbackを呼ぶ挙動。\r\n * break player後の復活もgame startなので注意。\r\n */\nInteraction_GameBehavior.StartEventCallback = function () {\n    _Interaction_GameEvent2.default.IStartEventListener.call(this);\n    var callback = null;\n    this.bindParams = function (_callback) {\n        callback = _callback;\n    };\n    this.fired = function () {\n        callback();\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.StartEvent} startEvent \r\n */\nInteraction_GameBehavior.StartEventCallbackBinder = function (startEvent) {\n    this.exec = function (callback) {\n        var listener = new Interaction_GameBehavior.StartEventCallback();\n        listener.bindParams(callback);\n        startEvent.addListener(listener);\n    };\n};\n\n/**\r\n * game clear時にcallbackを呼ぶ挙動。\r\n */\nInteraction_GameBehavior.ClearEventCallback = function () {\n    _Interaction_GameEvent2.default.IClearEventListener.call(this);\n    var callback = null;\n    this.bindParams = function (_callback) {\n        callback = _callback;\n    };\n    this.fired = function (message) {\n        callback(message);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.ClearEvent} clearEvent \r\n */\nInteraction_GameBehavior.ClearEventCallbackBinder = function (clearEvent) {\n    this.exec = function (callback) {\n        var listener = new Interaction_GameBehavior.ClearEventCallback();\n        listener.bindParams(callback);\n        clearEvent.addListener(listener);\n    };\n};\n\n/**\r\n * tapでstageClearにする挙動。\r\n * @param {Interaction_StageEvent.ClearEvent} stageClear \r\n */\nInteraction_GameBehavior.TapStageClear = function (stageClear) {\n    _Interaction_GameEvent2.default.ITapEventListener.call(this);\n    var message = '';\n    this.bindParams = function (_message) {\n        message = _message;\n    };\n    this.fired = function () {\n        stageClear.fire(message);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.ClearEvent} clearEvent \r\n * @param {Interaction_GameEvent.TapEvent} tapEvent \r\n * @param {Interaction_StageEvent.ClearEvent} stageClear \r\n */\nInteraction_GameBehavior.ClearTapStageClearBinder = function (clearEvent, tapEvent, stageClear) {\n    this.exec = function () {\n        var listenerClear = new Interaction_GameBehavior.ClearEventCallback();\n        listenerClear.bindParams(function (message) {\n            var listener = new Interaction_GameBehavior.TapStageClear(stageClear);\n            listener.bindParams(message);\n            tapEvent.addListener(listener);\n        });\n        clearEvent.addListener(listenerClear);\n    };\n};\n\n/**\r\n * gameclearで即時stageclear\r\n * @param {Interaction_GameEvent.ClearEvent} clearEvent \r\n * @param {Interaction_StageEvent.ClearEvent} stageClearEvent \r\n */\nInteraction_GameBehavior.ImmediateStageClearBinder = function (clearEvent, stageClearEvent) {\n    this.exec = function () {\n        var listenerClear = new Interaction_GameBehavior.ClearEventCallback();\n        listenerClear.bindParams(function (message) {\n            stageClearEvent.fire(message);\n        });\n        clearEvent.addListener(listenerClear);\n    };\n};\n\n/**\r\n * labelをtapされたときにcallbackを呼ぶ挙動。\r\n */\nInteraction_GameBehavior.LabelTapEventCallback = function () {\n    _Interaction_GameEvent2.default.ILabelTapEventListener.call(this);\n    var callback = null;\n    var label = null;\n    this.bindParams = function (_label, _callback) {\n        callback = _callback;\n        label = _label;\n    };\n    this.fired = function (_label) {\n        if (label.id() !== _label.id()) return;\n        callback(label);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.LabelTapEvent} labelTapEvent \r\n */\nInteraction_GameBehavior.LabelTapEventCallbackBinder = function (labelTapEvent) {\n    this.exec = function (label, callback) {\n        var listener = new Interaction_GameBehavior.LabelTapEventCallback();\n        listener.bindParams(label, callback);\n        labelTapEvent.addListener(listener);\n    };\n};\n\n/**\r\n * game fail時にcallbackを呼ぶ挙動。\r\n */\nInteraction_GameBehavior.FailEventCallback = function () {\n    _Interaction_GameEvent2.default.IFailEventListener.call(this);\n    var callback = null;\n    this.bindParams = function (_callback) {\n        callback = _callback;\n    };\n    this.fired = function () {\n        callback();\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.FailEvent} failEvent \r\n */\nInteraction_GameBehavior.FailEventCallbackBinder = function (failEvent) {\n    this.exec = function (callback) {\n        var listener = new Interaction_GameBehavior.FailEventCallback();\n        listener.bindParams(callback);\n        failEvent.addListener(listener);\n    };\n};\n\n/**\r\n * HitBulletEvent1回でHitEventを1回発生させる挙動。\r\n * @param {Interaction_GameEvent.HitEvent} hitEvent \r\n */\nInteraction_GameBehavior.HitBulletToHitBlock = function (hitEvent) {\n    _Interaction_GameEvent2.default.IHitBulletEventListener.call(this);\n    this.fired = function (block, bullet) {\n        hitEvent.fire(block);\n    };\n};\n/**\r\n * hitに使われたbulletを破壊にする挙動。\r\n * @param {Interaction_GameCommand.BreakBullet} breakBullet \r\n */\nInteraction_GameBehavior.HitBulletBreak = function (breakBullet) {\n    _Interaction_GameEvent2.default.IHitBulletEventListener.call(this);\n    this.fired = function (block, bullet) {\n        breakBullet.exec(bullet);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.HitBulletEvent} hitBulletEvent \r\n * @param {Interaction_GameEvent.HitEvent} hitEvent \r\n * @param {Interaction_GameCommand.BreakBullet} breakBullet \r\n */\nInteraction_GameBehavior.HitBulletToHitBlockBinder = function (hitBulletEvent, hitEvent, breakBullet) {\n    this.exec = function () {\n        var listener = new Interaction_GameBehavior.HitBulletToHitBlock(hitEvent);\n        hitBulletEvent.addListener(listener);\n        var listenerBreak = new Interaction_GameBehavior.HitBulletBreak(breakBullet);\n        hitBulletEvent.addListener(listenerBreak);\n    };\n};\n\n/**\r\n * 他のブロックと連鎖してbreakする挙動。\r\n * @param {Interaction_GameCommand.BreakBlock} breakBlock \r\n */\nInteraction_GameBehavior.ChainBreak = function (breakBlock) {\n    _Interaction_GameEvent2.default.IBreakEventListener.call(this);\n    var block = null;\n    var chains = null;\n    /**\r\n     * @param {Element.Block} _block \r\n     * @param {Element.Block[]} _chains \r\n     */\n    this.bindParams = function (_block, _chains) {\n        block = _block;\n        chains = _chains;\n    };\n    this.fired = function (_block) {\n        if (block.id() !== _block.id()) return;\n        chains.forEach(function (chain) {\n            return breakBlock.exec(chain);\n        });\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.BreakEvent} breakEvent \r\n * @param {Interaction_GameCommand.BreakBlock} breakBlock \r\n */\nInteraction_GameBehavior.ChainBreakBinder = function (breakEvent, breakBlock) {\n    /**\r\n     * @param {Element.Block} _block \r\n     * @param {Element.Block[]} _chains \r\n     */\n    this.exec = function (block, chains) {\n        var listener = new Interaction_GameBehavior.ChainBreak(breakBlock);\n        listener.bindParams(block, chains);\n        breakEvent.addListener(listener);\n    };\n};\n\n/**\r\n * アイテムを取得したら効果が発揮され、そのアイテムは消える挙動。\r\n * @param {Interaction_GameCommand.ExertItem} exertItem\r\n * @param {Interaction_GameCommand.BreakItem} breakItem \r\n */\nInteraction_GameBehavior.ExertItem = function (exertItem, breakItem) {\n    _Interaction_GameEvent2.default.IGetItemEventListener.call(this);\n    this.fired = function (item) {\n        exertItem.exec(item);\n        breakItem.exec(item);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.GetItemEvent} getItemEvent\r\n * @param {Interaction_GameCommand.ExertItem} exertItem\r\n * @param {Interaction_GameCommand.BreakItem} breakItem \r\n */\nInteraction_GameBehavior.ExertItemBinder = function (getItemEvent, exertItem, breakItem) {\n    this.exec = function () {\n        var listener = new Interaction_GameBehavior.ExertItem(exertItem, breakItem);\n        getItemEvent.addListener(listener);\n    };\n};\n\n/**\r\n * @param {Interaction_GameCommand.ReelBall} reelBall \r\n */\nInteraction_GameBehavior.DragReelBall = function (reelBall) {\n    _Interaction_GameEvent2.default.IDragEventListener.call(this);\n    var stoped = true;\n    var off = false;\n    var x = null;\n    var y = null;\n    this.fired = function (_x, _y) {\n        if (off) return;\n        stoped = false;\n        x = _x;\n        y = _y;\n    };\n    this.off = function () {\n        off = true;\n    };\n    this.stoped = function () {\n        stoped = true;\n    };\n    this.reel = function (ticks, ball, pow) {\n        if (off) return;\n        if (stoped) return;\n        reelBall.exec(x, y, ticks, ball, pow);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.ImageDragEvent} imageDragEvent\r\n * @param {Interaction_GameCommand.ReelBall} reelBall \r\n * @param {Interaction.Updater} updater\r\n */\nInteraction_GameBehavior.DragReelBallBinder = function (imageDragEvent, reelBall, updater) {\n    /**\r\n     * @param {Element_Store.Ball} ballStore\r\n     * @param {Number} limitSec\r\n     * @param {Number} pow 引力の倍率\r\n     */\n    this.exec = function (ballStore, limitSec, pow) {\n        var listener = new Interaction_GameBehavior.DragReelBall(reelBall);\n        imageDragEvent.addListener(listener);\n\n        var everyExec = new _Interaction_UpdaterListener2.default.EveryExecListener(function (ticks) {\n            ballStore.forEach(function (b) {\n                return listener.reel(ticks, b, pow);\n            });\n        }, true);\n        everyExec.promise().catch(function () {});\n        var everyExecCancelId = updater.addListener(everyExec);\n\n        var limiter = new _Interaction_UpdaterListener2.default.TimeoutListener(limitSec, true);\n        limiter.promise().then(function () {\n            listener.off();\n            updater.cancelListener(everyExecCancelId);\n        }).catch(function () {});\n        updater.addListener(limiter);\n    };\n};\n\n/**\r\n * lost判定になったitemを破棄する。\r\n * @param {Interaction_GameCommand.BreakItem} breakItem \r\n */\nInteraction_GameBehavior.LostItemBreak = function (breakItem) {\n    _Interaction_GameEvent2.default.ILostItemEventListener.call(this);\n    this.fired = function (item) {\n        breakItem.exec(item);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.LostItemEvent} lostItemEvent \r\n * @param {Interaction_GameCommand.BreakItem} breakItem \r\n */\nInteraction_GameBehavior.LostItemBreakBinder = function (lostItemEvent, breakItem) {\n    this.exec = function () {\n        var listener = new Interaction_GameBehavior.LostItemBreak(breakItem);\n        lostItemEvent.addListener(listener);\n    };\n};\n\n/**\r\n * lost判定になったbulletを破棄する。\r\n * @param {Interaction_GameCommand.BreakBullet} breakBullet \r\n */\nInteraction_GameBehavior.LostBulletBreak = function (breakBullet) {\n    _Interaction_GameEvent2.default.ILostBulletEventListener.call(this);\n    this.fired = function (bullet) {\n        breakBullet.exec(bullet);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.LostBulletEvent} lostBulletEvent \r\n * @param {Interaction_GameCommand.BreakBullet} breakBullet\r\n */\nInteraction_GameBehavior.LostBulletBreakBinder = function (lostBulletEvent, breakBullet) {\n    this.exec = function () {\n        var listener = new Interaction_GameBehavior.LostBulletBreak(breakBullet);\n        lostBulletEvent.addListener(listener);\n    };\n};\n\n/**\r\n * タップされたらballをリリースする挙動。\r\n * @param {Interaction_GameCommand.ReleaseBall} releaseBall\r\n * @param {Element_Store.BallStore}\r\n */\nInteraction_GameBehavior.ReleaseBall = function (releaseBall, ballStore) {\n    _Interaction_GameEvent2.default.ITapEventListener.call(this);\n    this.fired = function () {\n        ballStore.forEach(function (ball) {\n            if (ball.bindTo == null) return;\n            releaseBall.exec(ball);\n        });\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.TapEvent} tapEvent \r\n * @param {Interaction_GameCommand.ReleaseBall} releaseBall\r\n * @param {Element_Store.BallStore}\r\n */\nInteraction_GameBehavior.ReleaseBallBinder = function (tapEvent, releaseBall, ballStore) {\n    this.exec = function () {\n        var listener = new Interaction_GameBehavior.ReleaseBall(releaseBall, ballStore);\n        tapEvent.addListener(listener);\n    };\n};\n\n/**\r\n * gameが再開されたらfnが呼ばれる挙動。\r\n */\nInteraction_GameBehavior.GameResumeCallback = function () {\n    _Interaction_GameEvent2.default.IGameResumeEvent.call(this);\n    var fn = null;\n    this.bindParams = function (_fn) {\n        fn = _fn;\n    };\n    this.fired = function () {\n        fn();\n    };\n};\n/**\r\n * gameが中断されたらfnが呼ばれる挙動。\r\n */\nInteraction_GameBehavior.GameSuspendCallback = function () {\n    _Interaction_GameEvent2.default.IGameSuspendEvent.call(this);\n    var fn = null;\n    this.bindParams = function (_fn) {\n        fn = _fn;\n    };\n    this.fired = function () {\n        fn();\n    };\n};\n\n/**\r\n * dragされたら、それに合わせてbarが動く挙動。\r\n * @param {Interaction_GameCommand.MoveBar} moveBar \r\n */\nInteraction_GameBehavior.DragBar = function (moveBar) {\n    _Interaction_GameEvent2.default.IDragEventListener.call(this);\n    var bar = null;\n    var isSuspend = false;\n    this.bindParams = function (_bar) {\n        bar = _bar;\n    };\n    this.fired = function (x, y) {\n        if (isSuspend) return;\n        moveBar.exec(bar, x, y);\n    };\n    this.stoped = function () {};\n\n    this.suspend = function () {\n        isSuspend = true;\n    };\n    this.resume = function () {\n        isSuspend = false;\n    };\n};\n/**\r\n * playerの残機数を表示する挙動。\r\n * @param {Interaction_GameCommand.ReflectPlayerCount} reflect \r\n * @param {Element_Store.Player} player \r\n */\nInteraction_GameBehavior.PlayerCountReflect = function (reflect, player) {\n    _Interaction_GameEvent2.default.IStartEventListener.call(this);\n    var shape = null;\n    this.bindParams = function (_shape) {\n        shape = _shape;\n    };\n    this.fired = function () {\n        //player.countは現在動いている機も含めての数という認識なので、-1しておく。\n        var count = player.count - 1;\n        reflect.exec(count, shape);\n    };\n};\n/**\r\n * ゲーム開始時にバーとボールをくっつけて準備する挙動。\r\n * @param {Element_BallFactory.IBallFactory} ballFactory \r\n * @param {Element_Shape.ShapeApplier} ballShape\r\n * @param {Element_BarFactory.IBarFactory} barFactory \r\n * @param {Element_Shape.ShapeApplier} barShape\r\n * @param {Interaction_GameCommand.BallBarPosition} ballBarPosition\r\n * @param {Interaction_GameCommand.BallBindToBar} ballBindToBar \r\n * @param {Interaction_GameBehavior.DragBar} dragBar\r\n */\nInteraction_GameBehavior.BindedBarBallStart = function (ballFactory, ballShape, barFactory, barShape, ballBarPosition, ballBindToBar, dragBar) {\n    _Interaction_GameEvent2.default.IStartEventListener.call(this);\n    this.fired = function () {\n        var ball = ballFactory.createBall(ballShape);\n        ballShape.applyShape(ball);\n        var bar = barFactory.createBar(barShape);\n        barShape.applyShape(bar);\n        dragBar.bindParams(bar);\n        ballBarPosition.exec(bar, ball);\n        ballBindToBar.exec(bar, ball);\n    };\n};\n/**\r\n * startが発火したら、barとballを用意して待機する挙動へのbind。\r\n * @param {Interaction_GameEvent.StartEvent} startEvent\r\n * @param {Interaction_GameEvent.BarDragEvent} dragEvent\r\n * @param {Element_BallFactory.IBallFactory} ballFactory \r\n * @param {Element_Shape.ShapeApplier} ballShape\r\n * @param {Element_BarFactory.IBarFactory} barFactory \r\n * @param {Element_Shape.ShapeApplier} barShape\r\n * @param {Interaction_GameCommand.BallBarPosition} ballBarPosition\r\n * @param {Interaction_GameCommand.BallBindToBar} ballBindToBar \r\n * @param {Interaction_GameCommand.ReflectPlayerCount} reflectCount \r\n * @param {Interaction_GameCommand.MoveBar} moveBar \r\n * @param {Element_Store.Player} player\r\n * @param {Interaction_GameCommand.IPlayerCountShape} playerCountShape\r\n */\nInteraction_GameBehavior.BindedBarBallStartBinder = function (startEvent, dragEvent, suspendEvent, resumeEvent, ballFactory, ballShape, barFactory, barShape, ballBarPosition, ballBindToBar, reflectCount, moveBar, player, playerCountShape) {\n    this.exec = function () {\n        var listenerMoveBar = new Interaction_GameBehavior.DragBar(moveBar);\n        dragEvent.addListener(listenerMoveBar);\n\n        var listenerSuspend = new Interaction_GameBehavior.GameSuspendCallback();\n        listenerSuspend.bindParams(function () {\n            return listenerMoveBar.suspend();\n        });\n        suspendEvent.addListener(listenerSuspend);\n\n        var listenerResume = new Interaction_GameBehavior.GameResumeCallback();\n        listenerResume.bindParams(function () {\n            return listenerMoveBar.resume();\n        });\n        resumeEvent.addListener(listenerResume);\n\n        var listenerReflect = new Interaction_GameBehavior.PlayerCountReflect(reflectCount, player);\n        listenerReflect.bindParams(playerCountShape);\n        startEvent.addListener(listenerReflect);\n\n        var listenerBarBall = new Interaction_GameBehavior.BindedBarBallStart(ballFactory, ballShape, barFactory, barShape, ballBarPosition, ballBindToBar, listenerMoveBar);\n        startEvent.addListener(listenerBarBall);\n    };\n};\n\n/**\r\n * barとballの接触時にバーとボールをくっつけて待機する挙動。\r\n * @param {Interaction_GameCommand.BallBarPosition} ballBarPosition \r\n * @param {Interaction_GameCommand.BallBindToBar} ballBindToBar \r\n * @param {Interaction_GameBehavior.DragBar} dragBar\r\n */\nInteraction_GameBehavior.BindedBarBallHit = function (ballBarPosition, ballBindToBar, dragBar) {\n    _Interaction_GameEvent2.default.IHitBallBarEventListener.call(this);\n    var bindBar = null;\n    this.on = function (bar) {\n        bindBar = bar;\n    };\n    this.off = function () {\n        bindBar = null;\n    };\n    this.fired = function (ball, bar) {\n        if (bindBar === null) return;\n        if (bindBar.id() !== bar.id()) return;\n        dragBar.bindParams(bar);\n        ballBarPosition.exec(bar, ball);\n        ballBindToBar.exec(bar, ball);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.HitBallBarEvent} hitBallBarEvent \r\n * @param {Interaction_GameEvent.BarDragEvent} dragEvent\r\n * @param {Interaction_GameCommand.BallBarPosition} ballBarPosition \r\n * @param {Interaction_GameCommand.BallBindToBar} ballBindToBar \r\n * @param {Interaction_GameCommand.MoveBar} moveBar \r\n * @param {Interaction.Updater} updater\r\n * @param {Element_Store.BallStore} ballStore\r\n */\nInteraction_GameBehavior.BindedBarBallHitBinder = function (hitBallBarEvent, dragEvent, ballBarPosition, ballBindToBar, moveBar, updater) {\n    var cancelIds = {};\n    /**\r\n     * @param {Element.Bar} bar\r\n     * @param {Number} limit 吸着が有効になっている秒数。\r\n     */\n    this.exec = function (bar, limit) {\n        var listenerDragBar = new Interaction_GameBehavior.DragBar(moveBar);\n        listenerDragBar.bindParams(bar);\n        dragEvent.addListener(listenerDragBar);\n\n        var listener = new Interaction_GameBehavior.BindedBarBallHit(ballBarPosition, ballBindToBar, listenerDragBar);\n        hitBallBarEvent.addListener(listener);\n        listener.on(bar);\n        var limitter = new _Interaction_UpdaterListener2.default.TimeoutListener(limit, true);\n        limitter.promise().then(function () {\n            delete cancelIds[bar.id()];\n            listener.off();\n        }).catch(function () {});\n        if (cancelIds[bar.id()] != null) updater.cancelListener(cancelIds[bar.id()]);\n        cancelIds[bar.id()] = updater.addListener(limitter);\n    };\n};\n\n/**\r\n * 全blockがbreakされたらclearになる挙動。\r\n * @param {Element_Store.BlockStore} store \r\n * @param {Interaction_GameCommand.GameClear} gameClear \r\n * @param {String} message\r\n */\nInteraction_GameBehavior.AllBreakClear = function (store, gameClear, message) {\n    _Interaction_GameEvent2.default.IBreakEventListener.call(this);\n    this.fired = function (block) {\n        //remove前に発火されるので1\n        if (store.count() === 1) gameClear.exec(message);\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.BreakEvent} breakEvent \r\n * @param {Interaction_GameCommand.GameClear} gameClear \r\n * @param {Element_Store.BlockStore} store \r\n */\nInteraction_GameBehavior.AllBreakClearBinder = function (breakEvent, gameClear, store) {\n    this.exec = function (message) {\n        var listener = new Interaction_GameBehavior.AllBreakClear(store, gameClear, message);\n        breakEvent.addListener(listener);\n    };\n};\n\n/**\r\n * 以下の挙動。\r\n * ボールがlost判定になったら破棄する。\r\n * ボールが0になったらplayerが破壊される。\r\n * @param {Interaction_GameCommand.BreakBall} breakBall \r\n * @param {Interaction_GameCommand.ParticleBall} particleBall\r\n * @param {Interaction_GameCommand.ParticleBar} particleBar\r\n * @param {Interaction_GameCommand.BreakPlayer} breakPlayer \r\n * @param {Element_Store.BallStore} ballStore \r\n * @param {Element_Store.BarStore} barStore \r\n */\nInteraction_GameBehavior.BallLostBreakPlayer = function (breakBall, particleBall, particleBar, breakPlayer, ballStore, barStore) {\n    _Interaction_GameEvent2.default.ILostBallEventListener.call(this);\n    var ballParticle = null;\n    var barParticle = null;\n    /**\r\n     * @param {Element_Particle.IParticleConcrete} _ballParticle\r\n     * @param {Element_Particle.IParticleConcrete} _barParticle\r\n     */\n    this.bindParams = function (_ballParticle, _barParticle) {\n        ballParticle = _ballParticle;\n        barParticle = _barParticle;\n    };\n    this.fired = function (ball) {\n        particleBall.exec(ball, ballParticle);\n        breakBall.exec(ball);\n        if (ballStore.count() === 0) {\n            barStore.forEach(function (b) {\n                return particleBar.exec(b, barParticle);\n            });\n            breakPlayer.exec();\n        }\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.LostBallEvent} lostBallEvent \r\n * @param {Interaction_GameCommand.BreakBall} breakBall \r\n * @param {Interaction_GameCommand.ParticleBall} particleBall\r\n * @param {Interaction_GameCommand.ParticleBar} particleBar\r\n * @param {Interaction_GameCommand.BreakPlayer} breakPlayer \r\n * @param {Element_Store.BallStore} ballStore \r\n * @param {Element_Store.BarStore} barStore \r\n * @param {Element_Particle.IParticleConcrete} ballParticle\r\n * @param {Element_Particle.IParticleConcrete} barParticle\r\n */\nInteraction_GameBehavior.LostBallBreakPlayerBinder = function (lostBallEvent, breakBall, particleBall, particleBar, breakPlayer, ballStore, barStore) {\n    /**\r\n     * @param {Element_Particle.IParticleConcrete} ballParticle\r\n     * @param {Element_Particle.IParticleConcrete} barParticle\r\n     */\n    this.exec = function (ballParticle, barParticle) {\n        var listener = new Interaction_GameBehavior.BallLostBreakPlayer(breakBall, particleBall, particleBar, breakPlayer, ballStore, barStore);\n        listener.bindParams(ballParticle, barParticle);\n        lostBallEvent.addListener(listener);\n    };\n};\n\n/**\r\n * 以下の挙動。\r\n * playerの残機が0になったらfailする。\r\n * 0じゃなかったら復活する。\r\n * @param {Element_Store.Player} player \r\n * @param {Interaction.Updater} updater\r\n * @param {Interaction_GameCommand.GameFail} gameFail\r\n * @param {Number} gameFailTimeout\r\n * @param {Interaction_GameCommand.GameStart} gameStart \r\n * @param {Number} gameStartTimeout\r\n */\nInteraction_GameBehavior.PlayerLeftFailRestart = function (player, updater, gameFail, gameFailTimeout, gameStart, gameStartTimeout) {\n    _Interaction_GameEvent2.default.IBreakPlayerEventListener.call(this);\n    this.fired = function () {\n        if (player.count === 0) {\n            var listener = new _Interaction_UpdaterListener2.default.TimeoutListener(gameFailTimeout, true);\n            listener.promise().then(function () {\n                return gameFail.exec();\n            }).catch(function () {});\n            updater.addListener(listener);\n        } else {\n            var _listener2 = new _Interaction_UpdaterListener2.default.TimeoutListener(gameStartTimeout, true);\n            _listener2.promise().then(function () {\n                return gameStart.exec();\n            }).catch(function () {});\n            updater.addListener(_listener2);\n        }\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.IBreakPlayerEventListener} breakPlayerEvent \r\n * @param {Element.Player} player \r\n * @param {Interaction.Updater} updater\r\n * @param {Interaction_GameCommand.GameFail} gameFail\r\n * @param {Interaction_GameCommand.GameStart} gameStart \r\n */\nInteraction_GameBehavior.PlayerLeftFailRestartBinder = function (breakPlayerEvent, player, updater, gameFail, gameStart) {\n    /**\r\n     * @param {Number} gameFailTimeout \r\n     * @param {Number} gameStartTimeout \r\n     */\n    this.exec = function (gameFailTimeout, gameStartTimeout) {\n        var listener = new Interaction_GameBehavior.PlayerLeftFailRestart(player, updater, gameFail, gameFailTimeout, gameStart, gameStartTimeout);\n        breakPlayerEvent.addListener(listener);\n    };\n};\n\n/**\r\n * ゲームクリア時にリスナをキャンセルする挙動。\r\n */\nInteraction_GameBehavior.GameClearCancelListener = function () {\n    _Interaction_GameEvent2.default.IClearEventListener.call(this);\n    var listener = null;\n    this.bindParams = function (_listener) {\n        listener = _listener;\n    };\n    this.fired = function (message) {\n        listener.cancel();\n    };\n};\n/**\r\n * ゲーム失敗時にリスナをキャンセルする挙動。\r\n */\nInteraction_GameBehavior.GameFailCancelListener = function () {\n    _Interaction_GameEvent2.default.IFailEventListener.call(this);\n    var listener = null;\n    this.bindParams = function (_listener) {\n        listener = _listener;\n    };\n    this.fired = function () {\n        listener.cancel();\n    };\n};\n/**\r\n * OutAreaBreakBallをsec秒間隔で、ゲーム終了まで実行し続ける。\r\n * @param {Interaction_GameEvent.ClearEvent} clearEvent \r\n * @param {Interaction_GameEvent.FailEvent} failEvent \r\n * @param {Interaction_GameCommand.OutAreaBreakBall} outAreaBreakBall \r\n */\nInteraction_GameBehavior.OutAreaBreakBallBinder = function (clearEvent, failEvent, outAreaBreakBall, updater) {\n    this.exec = function (sec) {\n        var updaterListener = new _Interaction_UpdaterListener2.default.IntervalListener(function () {\n            outAreaBreakBall.exec();\n        }, sec, true);\n        updaterListener.promise().then(function () {}).catch(function () {});\n        updater.addListener(updaterListener);\n\n        var listenerClear = new Interaction_GameBehavior.GameClearCancelListener();\n        listenerClear.bindParams(updaterListener);\n        clearEvent.addListener(listenerClear);\n\n        var listenerFail = new Interaction_GameBehavior.GameClearCancelListener();\n        listenerFail.bindParams(updaterListener);\n        failEvent.addListener(listenerFail);\n    };\n};\n\nexports.default = Interaction_GameBehavior;\n\n//# sourceURL=webpack:///./src/Interaction_GameBehavior.js?");

/***/ }),

/***/ "./src/Interaction_GameCommand.js":
/*!****************************************!*\
  !*** ./src/Interaction_GameCommand.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nvar _Interaction_GameEvent = __webpack_require__(/*! ./Interaction_GameEvent */ \"./src/Interaction_GameEvent.js\");\n\nvar _Interaction_GameEvent2 = _interopRequireDefault(_Interaction_GameEvent);\n\nvar _Interaction_GameEvent_Binder = __webpack_require__(/*! ./Interaction_GameEvent_Binder */ \"./src/Interaction_GameEvent_Binder.js\");\n\nvar _Interaction_GameEvent_Binder2 = _interopRequireDefault(_Interaction_GameEvent_Binder);\n\nvar _Interaction_UpdaterListener = __webpack_require__(/*! ./Interaction_UpdaterListener */ \"./src/Interaction_UpdaterListener.js\");\n\nvar _Interaction_UpdaterListener2 = _interopRequireDefault(_Interaction_UpdaterListener);\n\nvar _Element_Particle = __webpack_require__(/*! ./Element_Particle */ \"./src/Element_Particle.js\");\n\nvar _Element_Particle2 = _interopRequireDefault(_Element_Particle);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Interaction_GameCommand = {};\n\n/**\r\n * 画像をロードする。\r\n */\nInteraction_GameCommand.ImageLoad = function (concretes) {\n    this.execAsync = function (type, pathSet, callback) {\n        var loader = concretes[type];\n        if (loader == null) throw new Error('no loader ' + type);\n\n        var promises = Object.keys(pathSet).map(function (key) {\n            return loader.execAsync(key, pathSet[key]);\n        });\n        return Promise.all(promises);\n    };\n};\nInteraction_GameCommand.IImageLoadGameStart = function () {\n    /**\r\n     * @param {String} key pathと指定されている所の文字列\r\n     * @param {String} url 実url\r\n     * @return {Promise} reject時はエラー内容を文字列で返すこと。\r\n     */\n    this.execAsync = function (key, url) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * 指定位置にblockを配置する。\r\n * @param {Interaction_GameCommand.IPutBlock[]} concretes \r\n */\nInteraction_GameCommand.PutBlock = function (concretes) {\n    this.exec = function (block, x, y) {\n        if (!block.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(block, x, y);\n        });\n    };\n};\nInteraction_GameCommand.IPutBlock = function () {\n    this.exec = function (block, x, y) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * 指定位置にlabelを配置する。\r\n * @param {Interaction_GameCommand.IPutLabel[]} concretes \r\n * @param {Interaction_GameCommand.ChangeSizedShape} changeSizedShape\r\n */\nInteraction_GameCommand.PutLabel = function (concretes, changeSizedShape) {\n    this.exec = function (label, shape, x, y, w, h) {\n        if (!label.isAlive()) return;\n        changeSizedShape.exec(label, shape, w, h);\n        concretes.forEach(function (c) {\n            return c.exec(label, x, y);\n        });\n    };\n};\nInteraction_GameCommand.IPutLabel = function () {\n    this.exec = function (label, x, y) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * blockの現在の形状をマスクにした画像のブロックに変更する。\r\n * @param {Interaction_GameCommand.IChangeBlockMaskImage[]} concretes \r\n */\nInteraction_GameCommand.ChangeBlockMaskImage = function (concretes) {\n    this.exec = function (block, path) {\n        if (!block.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(block, path);\n        });\n    };\n};\nInteraction_GameCommand.IChangeBlockMaskImage = function () {\n    this.exec = function (block, path) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * 一時的に指定の形状にbarを変更する。\r\n * @param {Interaction.Updater} updater\r\n */\nInteraction_GameCommand.ChangeBarTemporary = function (updater) {\n    var cancelIds = {};\n    /**\r\n     * @param {Element.Bar} bar \r\n     * @param {Number} sec \r\n     * @param {Element_Shape.ShapeApplier} tempShape \r\n     * @param {Element_Shape.ShapeApplier} baseShape \r\n     */\n    this.exec = function (bar, sec, tempShape, baseShape) {\n        if (!bar.isAlive()) return;\n        tempShape.applyShape(bar);\n        var listener = new _Interaction_UpdaterListener2.default.TimeoutListener(sec, true);\n        listener.promise().then(function () {\n            delete cancelIds[bar.id()];\n            if (!bar.isAlive()) return;\n            baseShape.applyShape(bar);\n        }).catch(function () {});\n        if (cancelIds[bar.id()] != null) updater.cancelListener(cancelIds[bar.id()]);\n        cancelIds[bar.id()] = updater.addListener(listener);\n    };\n};\n\n/**\r\n * 指定秒数後にpromiseがresolveする。\r\n * resolve(data)\r\n * reject(data)\r\n * @param {Interaction.Updater} updater\r\n */\nInteraction_GameCommand.Timeout = function (updater) {\n    var cancelIds = {};\n    /**\r\n     * @param {*} data\r\n     * @param {Number} sec \r\n     */\n    this.execAsync = function (data, sec, stoppable) {\n        var listener = new _Interaction_UpdaterListener2.default.TimeoutListener(sec, stoppable);\n        updater.addListener(listener);\n\n        var promise = new Promise(function (resolve, reject) {\n            listener.promise().then(function () {\n                return resolve(data);\n            }).catch(function () {\n                return reject(data);\n            });\n        });\n        return promise;\n    };\n};\n\n/**\r\n * 次回update時にpromiseがresolveする。\r\n * resolve({data, ticks})\r\n * reject(data)\r\n * @param {Interaction.Updater} updater\r\n */\nInteraction_GameCommand.NextUpdate = function (updater) {\n    /**\r\n     * @param {*} data\r\n     */\n    this.execAsync = function (data, stoppable) {\n        var listener = new _Interaction_UpdaterListener2.default.NextListener(data, stoppable);\n        updater.addListener(listener);\n\n        var promise = new Promise(function (resolve, reject) {\n            listener.promise().then(function (d) {\n                return resolve(d);\n            }).catch(function (d) {\n                return reject(d);\n            });\n        });\n        return promise;\n    };\n};\n\nInteraction_GameCommand.CountDown = function (updater) {\n    var cancelIds = [];\n    /**\r\n     * @param {Object[]} data この配列の数だけカウントダウンする。\r\n     * @param {Number} interval カウントダウンの間隔。\r\n     * @param {Function} countDownFn(data[n])\r\n     */\n    this.execAsync = function (data, interval, countDownFn, stoppable) {\n        cancelIds.forEach(function (id) {\n            return updater.cancelListener(id);\n        });\n        var listeners = data.map(function (d, i) {\n            var listener = new _Interaction_UpdaterListener2.default.TimeoutListener(interval * i, stoppable);\n            cancelIds.push(updater.addListener(listener));\n            listener.promise().then(function () {\n                return countDownFn(d);\n            }).catch(function (e) {\n                throw e;\n            });\n            return listener.promise();\n        });\n\n        var promise = Promise.all(listeners);\n        return promise;\n    };\n};\n\n/**\r\n * 指定の形状にelementを変更する。\r\n */\nInteraction_GameCommand.ChangeSizedShape = function () {\n    /**\r\n     * @param {Element.AbstractElement} element\r\n     * @param {Number} sec \r\n     * @param {Element_Shape.SizedShapeApplier} shape\r\n     * @param {Number} width\r\n     * @param {Number} height\r\n     */\n    this.exec = function (element, shape, width, height) {\n        if (!element.isAlive()) return;\n        shape.applyShape(element, width, height);\n    };\n};\n\n/**\r\n * ballを指定数に分割する。2だったら1増える。\r\n * @param {Element_Store.BallStore} store \r\n * @param {Element.BallFactory} factory\r\n * @param {Interaction_GameCommand.SyncBall} sync\r\n * @param {Interaction_GameCommand.ChangeBallAngle} changeAngle\r\n */\nInteraction_GameCommand.SplitBall = function (store, factory, sync, changeAngle) {\n    /**\r\n     * @param {Element.Ball} ball \r\n     * @param {Element_Shape.ShapeApplier} shape \r\n     * @param {Number} limit \r\n     * @param {Number} splits \r\n     */\n    this.exec = function (ball, shape, limit, splits) {\n        if (!ball.isAlive()) return;\n\n        var delta = Math.min(limit - store.count(), splits - 1);\n        if (delta <= 0) return;\n\n        var balls = Array(delta).fill(null).map(function (n) {\n            return factory.createBall(shape);\n        });\n        balls.forEach(function (b) {\n            return sync.exec(ball, b);\n        });\n        balls.push(ball);\n\n        //左右45度の範囲に等間隔で分散させる。\n        var range = 45.0;\n        var step = range * 2 / (delta + 2);\n        balls.forEach(function (b, i) {\n            var add = step * (i + 1) - range;\n            changeAngle.exec(b, add);\n        });\n    };\n};\n\n/**\r\n * ballの角度を変える。\r\n * 指定角度を追加する。0なら変化しない。\r\n * @param {Interaction_GameCommand.IChangeBallAngle[]} concretes \r\n */\nInteraction_GameCommand.ChangeBallAngle = function (concretes) {\n    this.exec = function (ball, degree) {\n        if (!ball.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(ball, degree);\n        });\n    };\n};\nInteraction_GameCommand.IChangeBallAngle = function () {\n    this.exec = function (ball, degree) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * 指定したballと同じ状態にする。位置とか向きとか速度とか。\r\n * @param {Interaction_GameCommand.ISyncBall[]} concretes\r\n * @param {Interaction_GameCommand.BallBindToBar} ballBindToBar\r\n */\nInteraction_GameCommand.SyncBall = function (concretes, ballBindToBar) {\n    this.exec = function (base, target) {\n        if (!base.isAlive()) return;\n        if (!target.isAlive()) return;\n        if (base.id() === target.id()) return;\n        concretes.forEach(function (c) {\n            return c.exec(base, target);\n        });\n        if (base.bindTo !== null) ballBindToBar.exec(base.bindTo, target);\n    };\n};\nInteraction_GameCommand.ISyncBall = function () {\n    this.exec = function (base, target) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ボールの速度をアップさせる。速度上限も設ける。\r\n * 速度の単位は物理演算系に依存する。\r\n * @param {Interaction_GameCommand.IBallSpeedUpAndLimit[]} concretes \r\n */\nInteraction_GameCommand.BallSpeedUpAndLimit = function (concretes) {\n    /**\r\n     * min((現行*upRatio), limit)\r\n     * @param {Element.Ball} ball \r\n     * @param {Number} upRatio \r\n     * @param {Number} limit \r\n     */\n    this.exec = function (ball, upRatio, limit) {\n        if (!ball.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(ball, upRatio, limit);\n        });\n    };\n};\nInteraction_GameCommand.IBallSpeedUpAndLimit = function (concretes) {\n    this.exec = function (ball, upRatio, limit) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ボールの速度を特定速度にする。\r\n * 速度の単位は物理演算系に依存する。\r\n * @param {Interaction_GameCommand.IBallSpeedSet[]} concretes \r\n */\nInteraction_GameCommand.BallSpeedSet = function (concretes) {\n    /**\r\n     * @param {Element.Ball} ball \r\n     * @param {Number} velocity\r\n     */\n    this.exec = function (ball, velocity) {\n        if (!ball.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(ball, velocity);\n        });\n    };\n};\nInteraction_GameCommand.IBallSpeedSet = function (concretes) {\n    this.exec = function (ball, velocity) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * blockを破壊にする。\r\n * storeからremoveする前にInteraction_GameEvent.BreakEventが発生する。\r\n * @param {Interaction_GameCommand.IBreakBlock[]} concretes\r\n * @param {Element_Store.BlockStore} store\r\n * @param {Interaction_GameEvent.BreakEvent} breakEvent\r\n */\nInteraction_GameCommand.BreakBlock = function (concretes, store, breakEvent) {\n    this.exec = function (block) {\n        if (!block.isAlive()) return;\n        //remove系の処理をしてしまうと、各種処理が行えない可能性があるので、先に発火\n        breakEvent.fire(block);\n        concretes.forEach(function (c) {\n            return c.exec(block);\n        });\n        store.remove(block);\n    };\n};\nInteraction_GameCommand.IBreakBlock = function () {\n    this.exec = function (block) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ballを破棄する。ボール残数が減る。\r\n * @param {Interaction_GameCommand.IBreakBall[]} concretes\r\n * @param {Element_Store.BallStore} store \r\n */\nInteraction_GameCommand.BreakBall = function (concretes, store) {\n    this.exec = function (ball) {\n        if (!ball.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(ball);\n        });\n        store.remove(ball);\n    };\n};\nInteraction_GameCommand.IBreakBall = function () {\n    this.exec = function (ball) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * bulletを破棄する。\r\n * @param {Interaction_GameCommand.IBreakBullet[]} concretes\r\n * @param {Element_Store.BulletStore} store \r\n * @param {Interaction.Updater} updater \r\n */\nInteraction_GameCommand.BreakBullet = function (concretes, store) {\n    this.exec = function (bullet) {\n        if (!bullet.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(bullet);\n        });\n        store.remove(bullet);\n    };\n};\nInteraction_GameCommand.IBreakBullet = function () {\n    this.exec = function (bullet) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * playerの残機数を表示する。\r\n * @param {Interaction_GameCommand.IPlayerCountLayout} layout\r\n */\nInteraction_GameCommand.ReflectPlayerCount = function (layout) {\n    /**\r\n     * @param {Number} count \r\n     * @param {Interaction_GameCommand.IPlayerCountShape} shape\r\n     */\n    this.exec = function (count, shape) {\n        shape.clear();\n        for (var i = 0; i < count; i++) {\n            var x = layout.x(i);\n            var y = layout.y(i);\n            shape.draw(x, y);\n        }\n    };\n};\nInteraction_GameCommand.IPlayerCountLayout = function () {\n    this.x = function (n) {\n        throw new Error('未実装');\n    };\n    this.y = function (n) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameCommand.PlayerCountLayoutTopRight = function (width, vertical, horizontal) {\n    Interaction_GameCommand.IPlayerCountLayout.call(this);\n    this.x = function (n) {\n        return width - horizontal - n * horizontal * 2;\n    };\n    this.y = function (n) {\n        return vertical;\n    };\n};\nInteraction_GameCommand.IPlayerCountShape = function () {\n    this.clear = function () {\n        throw new Error('未実装');\n    };\n    this.draw = function (x, y) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * itemの効果を発揮させる。\r\n */\nInteraction_GameCommand.ExertItem = function () {\n    this.exec = function (item) {\n        if (!item.isAlive()) return;\n        item.exert();\n    };\n};\n\n/**\r\n * itemを破棄する。\r\n * @param {Interaction_GameCommand.IBreakItem[]} concretes\r\n * @param {Element_Store.BallStore} store \r\n */\nInteraction_GameCommand.BreakItem = function (concretes, store) {\n    this.exec = function (item) {\n        if (!item.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(item);\n        });\n        store.remove(item);\n    };\n};\nInteraction_GameCommand.IBreakItem = function () {\n    this.exec = function (item) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * elementをtweenさせる。見た目上のみ。\r\n * @param {Interaction_GameCommand.ITweenElement[]} concretes\r\n * @param {Interaction.Updater} updater \r\n */\nInteraction_GameCommand.TweenElement = function (concretes, updater) {\n    var cancelIds = {};\n    /**\r\n     * @param {Element.AbstractElement} element\r\n     * @param {Element_Effect.TweenFactory} factory\r\n     * @return {Promise}\r\n     */\n    this.execAsync = function (element, factory) {\n        if (!element.isAlive()) return Promise.reject();\n        var ret = [];\n        if (cancelIds[element.id()] != null) {\n            updater.cancelListener(cancelIds[element.id()]);\n        }\n        concretes.forEach(function (c) {\n            var tween = c.exec(element, factory);\n            ret.push(tween.promise());\n            cancelIds[element.id()] = updater.addListener(tween);\n        });\n        //おそらく、先にcatchされるとエラー処理済みとみなし、次のthenが実行される。\n        //その為、あらかじめcatchを定義しておくと、その後のthenが意図せずにrejectでも実行されてしまう。\n        return Promise.all(ret);\n    };\n};\nInteraction_GameCommand.ITweenElement = function () {\n    /**\r\n     * @param {Element.AbstractElement} element\r\n     * @param {Element_Effect.TweenFactory} factory\r\n     * @return {Interaction.IUpdaterListener}\r\n     */\n    this.exec = function (element, factory) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * colorでfade in/outさせる。見た目上のみ。\r\n * @param {Interaction_GameCommand.IFadeScreen[]} concretes\r\n * @param {Interaction.Updater} updater \r\n */\nInteraction_GameCommand.FadeScreen = function (concretes, updater) {\n    var cancelId = null;\n    /**\r\n     * @param {Number} color 0x000000\r\n     * @param {Element_Effect.TweenFactory} factory\r\n     * @param {Boolean} isOut trueなら被せた色のscreenがそのまま残る。\r\n     * @return {Promise}\r\n     */\n    this.execAsync = function (color, factory, isOut) {\n        var ret = [];\n        if (cancelId != null) {\n            updater.cancelListener(cancelId);\n        }\n        concretes.forEach(function (c) {\n            var tween = c.exec(color, factory, isOut);\n            ret.push(tween.promise());\n            cancelId = updater.addListener(tween);\n        });\n        return Promise.all(ret);\n    };\n};\nInteraction_GameCommand.IFadeScreen = function () {\n    /**\r\n     * @param {Number} color 0x000000\r\n     * @param {Element_Effect.TweenFactory} factory\r\n     * @param {Boolean} isOut \r\n     * @return {Interaction.IUpdaterListener}\r\n     */\n    this.exec = function (color, factory, isOut) {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameCommand.IFadeScreenAlphaTweenFactory} concreteFactory\r\n */\nInteraction_GameCommand.FadeScreenAlphaTween = function (concreteFactory, imageContainerWrap, width, height) {\n    Interaction_GameCommand.IFadeScreen.call(this);\n    this.exec = function (color, factory, isOut) {\n        var concrete = concreteFactory.create(imageContainerWrap, color, width, height);\n        var tween = factory.createTween(function (x, y, a) {\n            return concrete.setAlpha(a);\n        });\n        tween.exec(0); //addChild時にちらつきそうだから、最初のalphaを適用しておく\n        concrete.on();\n        if (isOut) return tween;\n        var ret = new _Interaction_UpdaterListener2.default.ListenerWrapper(tween, function () {}, function () {}, function () {\n            concrete.off();\n        });\n        return ret;\n    };\n};\nInteraction_GameCommand.IFadeScreenAlphaTweenFactory = function () {\n    /**\r\n     * @returns {Interaction_GameCommand.IFadeScreenAlphaTween}\r\n     */\n    this.create = function (layer, color, width, height) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameCommand.IFadeScreenAlphaTween = function () {\n    this.setAlpha = function (alpha) {\n        throw new Error('未実装');\n    };\n    this.on = function () {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * @param {Interaction.Updater} updater \r\n * @param {Element_Particle.Pool} pool \r\n */\nInteraction_GameCommand.ParticlePoint = function (updater, pool) {\n    /**\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {Element_Particle.IParticleConcrete} concrete \r\n     */\n    this.exec = function (x, y, particleConcrete) {\n        particleConcrete.setup();\n        var particles = pool.pulls(particleConcrete.count());\n        var particleSet = new _Element_Particle2.default.ParticleSet(particles);\n        updater.addListener(particleSet);\n\n        particles.forEach(function (p) {\n            p.setParams(particleConcrete.life() * Math.random(), particleConcrete.createParams(), particleConcrete.createVariables());\n        });\n\n        particleConcrete.move(x, y);\n    };\n};\n\n/**\r\n * blockを中心にparticleを発生させる。\r\n * @param {Interaction_GameCommand.IParticleBlock} concrete\r\n * @param {Interaction_GameCommand.ParticlePoint} particlePoint\r\n */\nInteraction_GameCommand.ParticleBlock = function (concrete, particlePoint) {\n    /**\r\n     * @param {Element.Block} block\r\n     * @param {Element_Particle.IParticleConcrete} particle\r\n     */\n    this.exec = function (block, particle) {\n        if (!block.isAlive()) return;\n        if (concrete == null) return;\n        var x = concrete.x(block);\n        var y = concrete.y(block);\n        particlePoint.exec(x, y, particle);\n    };\n};\nInteraction_GameCommand.IParticleBlock = function () {\n    this.x = function (block) {\n        throw new Error('未実装');\n    };\n    this.y = function (block) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ballを中心にparticleを発生させる。\r\n * @param {Interaction_GameCommand.IParticleBall} concrete\r\n * @param {Interaction_GameCommand.ParticlePoint} particlePoint\r\n */\nInteraction_GameCommand.ParticleBall = function (concrete, particlePoint) {\n    /**\r\n     * @param {Element.Ball} ball\r\n     * @param {Element_Particle.IParticleConcrete} particle\r\n     */\n    this.exec = function (ball, particle) {\n        if (!ball.isAlive()) return;\n        if (concrete == null) return;\n        var x = concrete.x(ball);\n        var y = concrete.y(ball);\n        particlePoint.exec(x, y, particle);\n    };\n};\nInteraction_GameCommand.IParticleBall = function () {\n    this.x = function (ball) {\n        throw new Error('未実装');\n    };\n    this.y = function (ball) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * barを中心にparticleを発生させる。\r\n * @param {Interaction_GameCommand.IParticleBar} concrete\r\n * @param {Interaction_GameCommand.ParticlePoint} particlePoint\r\n */\nInteraction_GameCommand.ParticleBar = function (concrete, particlePoint) {\n    /**\r\n     * @param {Element.Bar} bar\r\n     * @param {Element_Particle.IParticleConcrete} particle\r\n     */\n    this.exec = function (bar, particle) {\n        if (!bar.isAlive()) return;\n        if (concrete == null) return;\n        var x = concrete.x(bar);\n        var y = concrete.y(bar);\n        particlePoint.exec(x, y, particle);\n    };\n};\nInteraction_GameCommand.IParticleBar = function () {\n    this.x = function (bar) {\n        throw new Error('未実装');\n    };\n    this.y = function (bar) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * blockからitemを落とす。\r\n * @param {Element.ItemFactory} itemFactory \r\n * @param {Interaction_GameCommand.MoveItemToBlock} moveItemToBlock\r\n * @param {Interaction_GameCommand.DromItem} dropItem\r\n */\nInteraction_GameCommand.DropItemFromBlock = function (itemFactory, moveItemToBlock, dropItem) {\n    /**\r\n     * @param {Element.Block} block \r\n     * @param {Element_Shape.ShapeApplier} shape\r\n     * @param {Number[]} velocity[x, y]\r\n     * @param {Function} exert \r\n     */\n    this.exec = function (block, shape, velocity, exert) {\n        if (!block.isAlive()) return;\n        var item = itemFactory.createItem(shape);\n        if (item == null) return;\n        shape.applyShape(item);\n        item.setExert(exert);\n        moveItemToBlock.exec(block, item);\n        dropItem.exec(item, velocity);\n    };\n};\n/**\r\n * itemをblockの所に移動させる。\r\n * @param {Interaction_GameCommand.IMoveItemToBlock[]} concretes\r\n */\nInteraction_GameCommand.MoveItemToBlock = function (concretes) {\n    this.exec = function (block, item) {\n        if (!block.isAlive()) return;\n        if (!item.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(block, item);\n        });\n    };\n};\nInteraction_GameCommand.IMoveItemToBlock = function () {\n    this.exec = function (block, item) {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * itemのdropを開始させる。\r\n * @param {Interaction_GameCommand.IDropItem[]} concretes\r\n */\nInteraction_GameCommand.DropItem = function (concretes) {\n    /**\r\n     * @param {Element.Item} item \r\n     * @param {Number[]} velocity [x, y]\r\n     */\n    this.exec = function (item, velocity) {\n        if (!item.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(item, velocity);\n        });\n    };\n};\nInteraction_GameCommand.IDropItem = function () {\n    this.exec = function (item, velocity) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * interval間隔で、limit秒間、barからbulletを発射させる。\r\n * @param {Interaction_GameCommand.ShootBulletFromBar} shootBulletFromBar \r\n * @param {Element.BulletFactory} bulletFactory \r\n * @param {Interaction.Updater} updater \r\n */\nInteraction_GameCommand.ShootBulletInterval = function (shootBulletFromBar, bulletFactory, updater) {\n    var cancelIds = {};\n    /**\r\n     * @param {Element.Bar} bar \r\n     * @param {Element_Shape.ShapeApplier} shape bulletのshape\r\n     * @param {Number[]} velocity\r\n     * @param {Number} interval\r\n     * @param {Number} limit \r\n     */\n    this.exec = function (bar, shape, velocity, interval, limit) {\n        if (!bar.isAlive()) return;\n        var listener = new _Interaction_UpdaterListener2.default.LimitedIntervalListener(function () {\n            if (!bar.isAlive()) return;\n            shootBulletFromBar.exec(bar, bulletFactory, shape, velocity);\n        }, interval, limit, true);\n        listener.promise().then(function () {\n            return delete cancelIds[bar.id()];\n        });\n        if (cancelIds[bar.id()] != null) updater.cancelListener(cancelIds[bar.id()]);\n        cancelIds[bar.id()] = updater.addListener(listener);\n    };\n};\n/**\r\n * barからbulletを発射する。\r\n * @param {Interaction_GameCommand.MoveBulletToBar} moveBulletToBar\r\n * @param {Interaction_GameCommand.ShootBullet} shootBullet\r\n */\nInteraction_GameCommand.ShootBulletFromBar = function (moveBulletToBar, shootBullet) {\n    /**\r\n     * @param {Element.Bar} bar \r\n     * @param {Element.BulletFactory} bulletFactory \r\n     * @param {Element_Shape.ShapeApplier} shape bulletのshape\r\n     */\n    this.exec = function (bar, bulletFactory, shape, velocity) {\n        if (!bar.isAlive()) return;\n        var bullet = bulletFactory.createBullet(shape);\n        shape.applyShape(bullet);\n        moveBulletToBar.exec(bar, bullet);\n        shootBullet.exec(bullet, velocity);\n    };\n};\n/**\r\n * bulletをbarの所に移動させる。\r\n * @param {Interaction_GameCommand.IMoveBulletToBar[]} concretes\r\n */\nInteraction_GameCommand.MoveBulletToBar = function (concretes) {\n    this.exec = function (bar, bullet) {\n        if (!bar.isAlive()) return;\n        if (!bullet.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(bar, bullet);\n        });\n    };\n};\nInteraction_GameCommand.IMoveBulletToBar = function () {\n    this.exec = function (bar, bullet) {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * bulletの発射を開始させる。\r\n * @param {Interaction_GameCommand.IShootBullet[]} concretes\r\n */\nInteraction_GameCommand.ShootBullet = function (concretes) {\n    this.exec = function (bullet, velocity) {\n        if (!bullet.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(bullet, velocity);\n        });\n    };\n};\nInteraction_GameCommand.IShootBullet = function () {\n    this.exec = function (bullet, velocity) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * bulletをballを中心とした半径radius内の所にランダムに移動させる。\r\n * @param {Interaction_GameCommand.IMoveBulletToBallRandomRaround[]} concretes\r\n */\nInteraction_GameCommand.MoveBulletToBallRandomRaround = function (concretes) {\n    this.exec = function (ball, bullet, radius) {\n        if (!ball.isAlive()) return;\n        if (!bullet.isAlive()) return;\n        var angle = Math.random() * 2 * Math.PI;\n        var r = Math.random() * radius;\n        var dx = Math.floor(r * Math.cos(angle));\n        var dy = Math.floor(r * Math.sin(angle));\n        concretes.forEach(function (c) {\n            return c.exec(ball, bullet, dx, dy);\n        });\n    };\n};\nInteraction_GameCommand.IMoveBulletToBallRandomRaround = function () {\n    this.exec = function (ball, bullet, dx, dy) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameCommand.BallExplosion = function (bulletFactory, lostBullet, moveRandom, tweenElement, timeout) {\n    function oneExplosion(ball, radius, bulletShape, effectTween) {\n        var bullet = bulletFactory.createBullet(bulletShape);\n        moveRandom.exec(ball, bullet, radius);\n        tweenElement.execAsync(bullet, effectTween).catch(function () {}).finally(function () {\n            lostBullet.fire(bullet);\n        });\n    }\n    this.exec = function (ball, count, radius, step, bulletShape, effectTween) {\n        if (!ball.isAlive()) return;\n        for (var i = 1; i <= count; i++) {\n            timeout.execAsync(null, step * i, true).then(function () {\n                if (!ball.isAlive()) return;\n                oneExplosion(ball, radius, bulletShape, effectTween);\n            });\n        }\n    };\n};\n\n/**\r\n * @param {Interaction_GameCommand.IDrawText} concretes \r\n */\nInteraction_GameCommand.DrawText = function (concretes) {\n    this.exec = function (label, text, x, y, halign, valign, sizedShape, textShape) {\n        if (!label.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(label, text, Math.floor(x), Math.floor(y), halign, valign, sizedShape, textShape);\n        });\n    };\n};\nInteraction_GameCommand.IDrawText = function () {\n    this.exec = function (label, text, x, y, halign, valign, sizedShape, textShape) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * @param {Interaction_GameCommand.IDrawTextFramed} concretes \r\n */\nInteraction_GameCommand.DrawTextFramed = function (concretes) {\n    this.exec = function (label, text, x, y, width, height, halign, valign, sizedShape, textShape) {\n        if (!label.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(label, text, Math.floor(x), Math.floor(y), Math.floor(width), Math.floor(height), halign, valign, sizedShape, textShape);\n        });\n    };\n};\nInteraction_GameCommand.IDrawTextFramed = function () {\n    this.exec = function (label, text, x, y, width, height, halign, valign, sizedShape, textShape) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * @param {Interaction_GameCommand.IReelBall[]} concretes \r\n */\nInteraction_GameCommand.ReelBall = function (concretes) {\n    this.exec = function (x, y, ticks, ball, pow) {\n        if (!ball.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(x, y, ticks, ball, pow);\n        });\n    };\n};\nInteraction_GameCommand.IReelBall = function () {\n    this.exec = function (x, y, ticks, ball, pow) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * @param {Interaction_GameCommand.IBlockPreview[]} concretes \r\n */\nInteraction_GameCommand.BlockPreview = function (concretes) {\n    this.exec = function (isShow) {\n        concretes.forEach(function (c) {\n            return c.exec(isShow);\n        });\n    };\n};\nInteraction_GameCommand.IBlockPreview = function () {\n    this.exec = function (isShow) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameCommand.BlockPreviewLayerVisible = function (layer) {\n    Interaction_GameCommand.IBlockPreview.call(this);\n    this.exec = function (isShow) {\n        layer.setVisible(isShow);\n    };\n};\n\n/**\r\n * タップに反応するようにする。\r\n * @param {Interaction_GameCommand.ITappable} concretes \r\n */\nInteraction_GameCommand.Tappable = function (concretes, eventBinder, allowance, labelTapEvent, store) {\n    this.exec = function (label) {\n        if (!label.isAlive()) return;\n        concretes.forEach(function (c) {\n            var binderConcrete = c.exec(label);\n            if (binderConcrete == null) return;\n            var binder = new _Interaction_GameEvent_Binder2.default.LabelTapEventBinder(allowance, labelTapEvent, store, binderConcrete);\n            eventBinder.add(binder);\n        });\n    };\n};\nInteraction_GameCommand.ITappable = function (concretes) {\n    /**\r\n     * @returns {Interaction_GameEvent_Binder.IPositionEventConcrete}\r\n     */\n    this.exec = function (label) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * 背景イメージを変更する。\r\n * @param {Interaction_GameCommand.IChangeImageFactory[]} concreteFactories\r\n */\nInteraction_GameCommand.ChangeImage = function (concreteFactories, layers) {\n    var concretes = layers.map(function (l) {\n        return concreteFactories.map(function (c) {\n            return c.create(l);\n        });\n    });\n\n    this.exec = function (position, image) {\n        concretes[position].forEach(function (c) {\n            return c.exec(image);\n        });\n    };\n};\nInteraction_GameCommand.IChangeImage = function () {\n    this.exec = function (image) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameCommand.IChangeImageFactory = function () {\n    this.create = function (layer) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * 背景イメージを消去する。\r\n * @param {Interaction_GameCommand.IRemoveImageFactory[]} concreteFactories\r\n */\nInteraction_GameCommand.RemoveImage = function (concreteFactories, layers) {\n    var concretes = layers.map(function (l) {\n        return concreteFactories.map(function (c) {\n            return c.create(l);\n        });\n    });\n\n    this.exec = function (position) {\n        concretes[position].forEach(function (c) {\n            return c.exec();\n        });\n    };\n};\nInteraction_GameCommand.IRemoveImage = function () {\n    this.exec = function () {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameCommand.IRemoveImageFactory = function () {\n    this.create = function (layer) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * バーを動かす。\r\n * @param {Interaction_GameCommand.IMoveBar[]} concretes\r\n * @param {Interaction_GameCommand.IMoveLimitter} limitter\r\n * @param {Interaction_GameEvent.MoveBarEvent} moveBarEvent\r\n */\nInteraction_GameCommand.MoveBar = function (concretes, moveLimitter, moveBarEvent) {\n    this.exec = function (bar, x, y) {\n        if (!bar.isAlive()) return;\n        var result = concretes.map(function (c) {\n            return c.exec(bar, x, y, moveLimitter);\n        }).reduce(function (acc, cur) {\n            //最後に返ってきた有効なMoveBarResultを使用する。\n            if (cur == null) return acc;\n            return cur;\n        }, new Interaction_GameCommand.MoveBarResult(x, y));\n        if (result.isEqual(x, y)) return;\n        moveBarEvent.fire(result.getX(), result.getY());\n    };\n};\nInteraction_GameCommand.MoveBarResult = function (_x, _y) {\n    this.getX = function () {\n        return _x;\n    };\n    this.getY = function () {\n        return _y;\n    };\n    this.isEqual = function (x, y) {\n        return x === _x && y === _y;\n    };\n};\nInteraction_GameCommand.IMoveLimitter = function () {\n    this.limitX = function (x) {\n        throw new Error('未実装');\n    };\n    this.limitY = function (y) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameCommand.IMoveBar = function () {\n    /**\r\n     * @returns {Interaction_GameCommand.MoveBarResult}\r\n     */\n    this.exec = function (bar, x, y, moveLimitter) {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * xを0-xMaxLimitの範囲に、yをyFixに固定。\r\n * @param {Number} xMaxLimit \r\n * @param {Number} yFix \r\n */\nInteraction_GameCommand.MoveLimitterXMaxLimitYFix = function (xMaxLimit, yFix) {\n    Interaction_GameCommand.IMoveLimitter.call(this);\n    this.limitX = function (x) {\n        return Math.max(0, Math.min(xMaxLimit, x));\n    };\n    this.limitY = function (y) {\n        return yFix;\n    };\n};\n\n/**\r\n * ボールとバーを特定位置に動かす。\r\n * @param {Interaction_GameCommand.IBallBarPosition[]} concretes\r\n * @param {Number[]} ballPos \r\n * @param {Number[]} barPos \r\n */\nInteraction_GameCommand.BallBarPosition = function (concretes, ballPos, barPos) {\n    this.exec = function (bar, ball) {\n        if (!bar.isAlive()) return;\n        if (!ball.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(bar, ball, ballPos, barPos);\n        });\n    };\n};\nInteraction_GameCommand.IBallBarPosition = function () {\n    this.exec = function (bar, ball, ballPos, barPos) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ボールをバーにくっつける。\r\n * @param {Interaction_GameCommand.IBallBindToBar[]} concretes\r\n */\nInteraction_GameCommand.BallBindToBar = function (concretes) {\n    this.exec = function (bar, ball) {\n        if (!bar.isAlive()) return;\n        if (!ball.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(bar, ball);\n        });\n        ball.bindTo = bar;\n    };\n};\nInteraction_GameCommand.IBallBindToBar = function () {\n    this.exec = function (bar, ball) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ballをリリースする。(動かし始める)\r\n * @param {Interaction_GameCommand.IReleaseBall[]} concretes\r\n * @param {Number[]} velocity[x, y] ボールの初速。\r\n */\nInteraction_GameCommand.ReleaseBall = function (concretes, velocity) {\n    this.exec = function (ball) {\n        if (!ball.isAlive()) return;\n        concretes.forEach(function (c) {\n            return c.exec(ball, velocity);\n        });\n        ball.bindTo = null;\n    };\n};\nInteraction_GameCommand.IReleaseBall = function () {\n    this.exec = function (ball, velocity) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * BallBindToBarのbind処理とReleaseBallのrelease処理をつなげる。\r\n * newしたものを使い回す事。個別にnewしては繋がらない。\r\n * @param {Interaction_GameCommand.IBallBindReleaseBridge[]} concretes\r\n * @param {Interaction_GameEvent.MoveBarEvent} moveBarEvent \r\n */\nInteraction_GameCommand.BallBindReleaseBridge = function (concretes, moveBarEvent) {\n    var bindingBalls = {};\n    var listener = new function () {\n        _Interaction_GameEvent2.default.IMoveBarEventListener.call(this);\n        this.fired = function (x, y) {\n            concretes.forEach(function (c) {\n                return c.exec(x, y, bindingBalls);\n            });\n        };\n    }();\n    moveBarEvent.addListener(listener);\n\n    this.on = function (ball, dx, dy, velocity) {\n        bindingBalls[ball.id()] = { ball: ball, dx: dx, dy: dy, velocity: velocity };\n    };\n    this.velocity = function (id) {\n        return bindingBalls[id].velocity;\n    };\n    this.off = function (id) {\n        delete bindingBalls[id];\n    };\n};\nInteraction_GameCommand.IBallBindReleaseBridge = function () {\n    this.exec = function (x, y, balls) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * Barに保持したタイミングのvelocityをbridgeに保持するためのラッパー。\r\n * @param {Interaction_GameCommand.BallBindReleaseBridge} bridge \r\n * @param {Interaction_GameCommand.IBallBindToBarVelocityStore[]} concretes\r\n */\nInteraction_GameCommand.BallBindToBarVelocityStore = function (bridge, concretes) {\n    Interaction_GameCommand.IBallBindToBar.call(this);\n    this.exec = function (bar, ball) {\n        var result = concretes.map(function (c) {\n            return c.exec(bar, ball);\n        }).reduce(function (acc, cur) {\n            //最後に返ってきた有効なMoveBarResultを使用する。\n            if (cur == null) return acc;\n            return cur;\n        }, null);\n        if (result == null) {\n            throw new Error('result null');\n        };\n        bridge.on(ball, result.getDx(), result.getDy(), result.getVelocity());\n    };\n};\nInteraction_GameCommand.IBallBindToBarVelocityStore = function () {\n    /**\r\n     * @returns {Interaction_GameCommand.BallBindToBarVelocityStoreResult}\r\n     */\n    this.exec = function (bar, ball) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameCommand.BallBindToBarVelocityStoreResult = function (dx, dy, velocity) {\n    this.getDx = function () {\n        return dx;\n    };\n    this.getDy = function () {\n        return dy;\n    };\n    this.getVelocity = function () {\n        return velocity;\n    };\n};\n\n/**\r\n * デフォルトで指定されるvelocityをbridgeに保存済みのvelocityで上書きするためのラッパー。\r\n * @param {Interaction_GameCommand.BallBindReleaseBridge} bridge\r\n * @param {Interaction_GameCommand.IReleaseBall} concretes\r\n */\nInteraction_GameCommand.ReleaseBallVelocityOverwrite = function (bridge, concretes) {\n    Interaction_GameCommand.IReleaseBall.call(this);\n    this.exec = function (ball, velocity) {\n        //endContactでイベントを拾わないと、velocityの向きが反射後になっていない。\n        var v = bridge.velocity(ball.id());\n        if (v[0] != 0 && v[1] != 0) {\n            //垂直水平はNG\n            concretes.forEach(function (c) {\n                return c.exec(ball, v);\n            });\n        } else {\n            concretes.forEach(function (c) {\n                return c.exec(ball, velocity);\n            });\n        }\n        bridge.off(ball.id());\n    };\n};\n\n/**\r\n * 範囲外のballをlost扱いにする。\r\n * @param {Interaction_GameCommand.IOutAreaBreakBall[]} concretes \r\n * @param {Element_Store.Ball} store \r\n * @param {Interaction_GameEvent.LostBallEvent} lostBallEvent \r\n */\nInteraction_GameCommand.OutAreaBreakBall = function (concretes, store, lostBallEvent) {\n    this.exec = function () {\n        store.forEach(function (ball) {\n            if (!ball.isAlive()) return;\n            if (concretes.every(function (c) {\n                return !c.isOutArea(ball);\n            })) return;\n            lostBallEvent.fire(ball);\n        });\n    };\n};\nInteraction_GameCommand.IOutAreaBreakBall = function () {\n    this.isOutArea = function (ball) {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameCommand.IOutAreaBreakBallRectangleArea} concrete \r\n */\nInteraction_GameCommand.OutAreaBreakBallRectangleArea = function (concrete, stageWidth, stageHeight) {\n    Interaction_GameCommand.IOutAreaBreakBall.call(this);\n    this.isOutArea = function (ball) {\n        var position = concrete.getPosition(ball);\n        var x = position[0];\n        var y = position[1];\n        if (x < 0 || stageWidth < x) return true;\n        if (y < 0 || stageHeight < y) return true;\n        return false;\n    };\n};\nInteraction_GameCommand.IOutAreaBreakBallRectangleArea = function () {\n    ///TODO ひとまずarrayにしているけど、typescriptで何かいい実装が出来れば対応する。\n    /**\r\n     * @returns {Array}\r\n     */\n    this.getPosition = function (ball) {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * プレイヤーを破壊する。\r\n * プレイヤー残機が減る。\r\n * Interaction_GameEvent.BreakPlayerEventが発生する。\r\n * @param {Interaction_GameCommand.IBreakPlayer[]} concretes\r\n * @param {Element_Store.BarStore} store\r\n * @param {Element_Store.Player} player\r\n * @param {Interaction_GameEvent.BreakPlayerEvent} breakPlayerEvent\r\n */\nInteraction_GameCommand.BreakPlayer = function (concretes, store, player, breakPlayerEvent) {\n    this.exec = function () {\n        concretes.forEach(function (c) {\n            return c.exec();\n        });\n        if (player.count > 0) player.count--;\n        store.forEach(function (b) {\n            return store.remove(b);\n        });\n        breakPlayerEvent.fire();\n    };\n};\nInteraction_GameCommand.IBreakPlayer = function () {\n    this.exec = function () {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameCommand.IBreakPlayerBarStoreProcess} concrete\r\n * @param {Element_Store.BarStore} store\r\n */\nInteraction_GameCommand.BreakPlayerBarStoreProcess = function (concrete, store) {\n    Interaction_GameCommand.IBreakPlayer.call(this);\n    this.exec = function () {\n        store.forEach(function (e) {\n            return concrete.procBar(e);\n        });\n    };\n};\nInteraction_GameCommand.IBreakPlayerBarStoreProcess = function () {\n    this.procBar = function (bar) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * プレイヤーを追加する。\r\n * @param {Interaction_GameCommand.ISupplyPlayer[]} concretes\r\n * @param {Element_Store.Player} player\r\n */\nInteraction_GameCommand.SupplyPlayer = function (concretes, player) {\n    this.exec = function () {\n        player.count++;\n        concretes.forEach(function (c) {\n            return c.exec();\n        });\n    };\n};\nInteraction_GameCommand.ISupplyPlayer = function () {\n    this.exec = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ゲームを開始させる。\r\n * Interaction_GameEvent.StartEventが発生する。\r\n * @param {Interaction_GameCommand.IGameStart[]} concretes\r\n * @param {Interaction_GameEvent.StartEvent} startEvent\r\n */\nInteraction_GameCommand.GameStart = function (concretes, startEvent) {\n    this.exec = function () {\n        concretes.forEach(function (c) {\n            return c.exec();\n        });\n        startEvent.fire();\n    };\n};\nInteraction_GameCommand.IGameStart = function () {\n    this.exec = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ゲームをクリアさせる。\r\n * 各処理の前にInteraction_GameEvent.ClearEventを発生させる。\r\n * @param {Interaction_GameCommand.IGameClear[]} concretes\r\n * @param {Interaction_GameCommand.ParticleBall} particleBall\r\n * @param {Element_Store.BallStore} ballStore\r\n * @param {Element_Store.ItemStore} itemStore\r\n * @param {Element_Store.BarStore} barStore\r\n * @param {Element_Store.BulletStore} bulletStore\r\n * @param {Interaction_GameEvent.ClearEvent} clearEvent\r\n */\nInteraction_GameCommand.GameClear = function (concretes, particleBall, ballStore, itemStore, barStore, bulletStore, clearEvent) {\n    /**\r\n     * @param {String} message ステージ分岐用などの為に、メッセージが送れる。\r\n     */\n    this.exec = function (message) {\n        clearEvent.fire(message);\n        concretes.forEach(function (c) {\n            return c.exec();\n        });\n        ballStore.removeAll();\n        itemStore.removeAll();\n        barStore.removeAll();\n        bulletStore.removeAll();\n    };\n};\nInteraction_GameCommand.IGameClear = function () {\n    this.exec = function () {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameCommand.IGameClearStoreProcess} concrete \r\n */\nInteraction_GameCommand.GameClearStoreProcess = function (concrete, ballStore, itemStore, barStore, bulletStore) {\n    Interaction_GameCommand.IGameClear.call(this);\n    this.exec = function () {\n        ballStore.forEach(function (e) {\n            return concrete.procBall(e);\n        });\n        itemStore.forEach(function (e) {\n            return concrete.procItem(e);\n        });\n        barStore.forEach(function (e) {\n            return concrete.procBar(e);\n        });\n        bulletStore.forEach(function (e) {\n            return concrete.procBullet(e);\n        });\n    };\n};\nInteraction_GameCommand.IGameClearStoreProcess = function () {\n    this.procBall = function (ball) {\n        throw new Error('未実装');\n    };\n    this.procItem = function (item) {\n        throw new Error('未実装');\n    };\n    this.procBar = function (bar) {\n        throw new Error('未実装');\n    };\n    this.procBullet = function (bullet) {\n        throw new Error('未実装');\n    };\n};\n\nInteraction_GameCommand.GameSuspend = function (updater, suspendEvent) {\n    this.exec = function () {\n        suspendEvent.fire();\n        updater.suspend();\n    };\n};\n\nInteraction_GameCommand.GameResume = function (updater, resumeEvent) {\n    this.exec = function () {\n        resumeEvent.fire();\n        updater.resume();\n    };\n};\n\n/**\r\n * ゲームを失敗にさせる。(残機無し等)\r\n * 各処理の前にInteraction_GameEvent.FailEventを発生させる。\r\n * @param {Interaction_GameCommand.IGameFail[]} concretes\r\n * @param {Interaction_GameEvent.FailEvent} failEvent\r\n */\nInteraction_GameCommand.GameFail = function (concretes, failEvent) {\n    this.exec = function () {\n        failEvent.fire();\n        concretes.forEach(function (c) {\n            return c.exec();\n        });\n    };\n};\nInteraction_GameCommand.IGameFail = function () {\n    this.exec = function () {\n        throw new Error('未実装');\n    };\n};\n\nexports.default = Interaction_GameCommand;\n\n//# sourceURL=webpack:///./src/Interaction_GameCommand.js?");

/***/ }),

/***/ "./src/Interaction_GameCommand_P2.js":
/*!*******************************************!*\
  !*** ./src/Interaction_GameCommand_P2.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Element_P = __webpack_require__(/*! ./Element_P2 */ \"./src/Element_P2.js\");\n\nvar _Element_P2 = _interopRequireDefault(_Element_P);\n\nvar _Interaction_GameCommand = __webpack_require__(/*! ./Interaction_GameCommand */ \"./src/Interaction_GameCommand.js\");\n\nvar _Interaction_GameCommand2 = _interopRequireDefault(_Interaction_GameCommand);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Interaction_GameCommand_P2 = {};\n\nInteraction_GameCommand_P2.PutBlock = function () {\n    _Interaction_GameCommand2.default.IPutBlock.call(this);\n    this.exec = function (block, x, y) {\n        var body = block.getElement(_Element_P2.default.KEY);\n        body.position = [x, y];\n        body.previousPosition = [x, y];\n    };\n};\n\n/**\r\n * xはaabbがlimitterの範囲に納まるように制限する。yはlimitterに従う。\r\n */\nInteraction_GameCommand_P2.XLimitedByAabbMoveBar = function () {\n    _Interaction_GameCommand2.default.IMoveBar.call(this);\n    /**\r\n     * @param {Element.Bar} bar \r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {Interaction_GameCommand.IMoveLimitter} moveLimitter \r\n     */\n    this.exec = function (bar, x, y, moveLimitter) {\n        var body = bar.getElement(_Element_P2.default.KEY);\n        if (body.position[0] === x && body.position[1] === y) return new _Interaction_GameCommand2.default.MoveBarResult(x, y);\n\n        var fixedY = moveLimitter.limitY(y);\n\n        body.position = [x, fixedY];\n        body.previousPosition = [x, fixedY];\n        body.aabbNeedsUpdate = true;\n        body.updateAABB();\n        var aabb = body.aabb;\n        var dx1 = moveLimitter.limitX(aabb.lowerBound[0]) - aabb.lowerBound[0];\n        if (dx1 > 0) {\n            var p = [x + dx1, fixedY];\n            body.position = p;\n            body.previousPosition = p;\n            return new _Interaction_GameCommand2.default.MoveBarResult(p[0], p[1]);\n        }\n        var dx2 = aabb.upperBound[0] - moveLimitter.limitX(aabb.upperBound[0]);\n        if (dx2 > 0) {\n            var _p = [x - dx2, fixedY];\n            body.position = _p;\n            body.previousPosition = _p;\n            return new _Interaction_GameCommand2.default.MoveBarResult(_p[0], _p[1]);\n        }\n        return new _Interaction_GameCommand2.default.MoveBarResult(x, fixedY);\n        //body.velocity = [(x - body.position[0])/100, 0];\n    };\n};\n\nInteraction_GameCommand_P2.ChangeBallAngle = function () {\n    _Interaction_GameCommand2.default.IChangeBallAngle.call(this);\n    this.exec = function (ball, degree) {\n        if (typeof degree == 'number') {\n            addDegree(ball, degree);\n        }\n        if (typeof degree == 'function') {\n            funcDegree(ball, degree);\n        }\n    };\n    function addDegree(ball, degree) {\n        var ballBody = ball.getElement(_Element_P2.default.KEY);\n        var rad = degree * Math.PI / 180;\n        var v = ballBody.velocity;\n        var v2 = [v[0] * Math.cos(rad) - v[1] * Math.sin(rad), v[0] * Math.sin(rad) + v[1] * Math.cos(rad)];\n        ballBody.velocity = v2;\n    }\n    function funcDegree(ball, degreeFn) {\n        var ballBody = ball.getElement(_Element_P2.default.KEY);\n        var v = ballBody.velocity;\n        var r = Math.sqrt(v[0] * v[0] + v[1] * v[1]);\n        var deg = Math.atan2(v[1], v[0]) * 180 / Math.PI;\n        var rad = degreeFn(deg) * Math.PI / 180;\n        var v2 = [r * Math.cos(rad), r * Math.sin(rad)];\n        ballBody.velocity = v2;\n    }\n};\n\nInteraction_GameCommand_P2.SyncBall = function () {\n    _Interaction_GameCommand2.default.ISyncBall.call(this);\n    this.exec = function (base, target) {\n        var baseBody = base.getElement(_Element_P2.default.KEY);\n        var targetBody = target.getElement(_Element_P2.default.KEY);\n\n        var pos = baseBody.position;\n        targetBody.position = pos.slice();\n        targetBody.previousPosition = pos.slice();\n\n        var vel = baseBody.velocity.slice();\n        targetBody.velocity = vel;\n\n        targetBody.angle = baseBody.angle;\n\n        var avel = baseBody.angularVelocity;\n        targetBody.angularVelocity = avel;\n    };\n};\n\nInteraction_GameCommand_P2.BallBindReleaseBridge = function () {\n    _Interaction_GameCommand2.default.IBallBindReleaseBridge.call(this);\n\n    this.exec = function (x, y, balls) {\n        Object.keys(balls).forEach(function (key) {\n            var params = balls[key];\n            var ballBody = params['ball'].getElement(_Element_P2.default.KEY);\n            var dx = params['dx'];\n            var dy = params['dy'];\n            ballBody.position = [x + dx, y + dy];\n            ballBody.previousPosition = [x + dx, y + dy];\n            ballBody.velocity = [0, 0];\n        });\n    };\n};\n\nInteraction_GameCommand_P2.BallBindToBarVelocityStore = function () {\n    _Interaction_GameCommand2.default.IBallBindToBarVelocityStore.call(this);\n    this.exec = function (bar, ball) {\n        var barBody = bar.getElement(_Element_P2.default.KEY);\n        var ballBody = ball.getElement(_Element_P2.default.KEY);\n        var velocity = ballBody.velocity.slice();\n        ballBody.velocity = [0, 0];\n        ballBody.force = [0, 0];\n        ballBody.mass = 0; //static化\n        var dx = ballBody.position[0] - barBody.position[0];\n        var dy = ballBody.position[1] - barBody.position[1];\n\n        return new _Interaction_GameCommand2.default.BallBindToBarVelocityStoreResult(dx, dy, velocity);\n    };\n};\n\nInteraction_GameCommand_P2.ReleaseBall = function () {\n    _Interaction_GameCommand2.default.IReleaseBall.call(this);\n    this.exec = function (ball, velocity) {\n        var ballBody = ball.getElement(_Element_P2.default.KEY);\n        ballBody.mass = 1; //dynamicに戻す。\n        ballBody.force = [0, 0];\n        ballBody.velocity = velocity.slice();\n    };\n};\n\nInteraction_GameCommand_P2.BallBarPosition = function () {\n    _Interaction_GameCommand2.default.IBallBarPosition.call(this);\n    this.exec = function (bar, ball, ballPos, barPos) {\n        var barBody = bar.getElement(_Element_P2.default.KEY);\n        barBody.position = barPos;\n        barBody.previousPosition = barPos;\n        var ballBody = ball.getElement(_Element_P2.default.KEY);\n        ballBody.position = ballPos;\n        ballBody.previousPosition = ballPos;\n    };\n};\n\nInteraction_GameCommand_P2.BallBarPositionBallY = function () {\n    _Interaction_GameCommand2.default.IBallBarPosition.call(this);\n    this.exec = function (bar, ball, ballPos, barPos) {\n        var ballBody = ball.getElement(_Element_P2.default.KEY);\n        ballBody.position = [ballBody.position[0], ballPos[1]];\n        ballBody.previousPosition = [ballBody.position[0], ballPos[1]];\n    };\n};\n\nInteraction_GameCommand_P2.BallSpeedUpAndLimit = function () {\n    _Interaction_GameCommand2.default.IBallSpeedUpAndLimit.call(this);\n    this.exec = function (ball, upRatio, limit) {\n        var body = ball.getElement(_Element_P2.default.KEY);\n        var v = body.velocity;\n        var now = Math.sqrt(v[0] * v[0] + v[1] * v[1]);\n        var ratio = Math.min(now * upRatio, limit) / now;\n        body.velocity = [body.velocity[0] * ratio, body.velocity[1] * ratio];\n    };\n};\n\nInteraction_GameCommand_P2.BallSpeedSet = function () {\n    _Interaction_GameCommand2.default.IBallSpeedSet.call(this);\n    this.exec = function (ball, velocity) {\n        var body = ball.getElement(_Element_P2.default.KEY);\n        var v = body.velocity;\n        var now = Math.sqrt(v[0] * v[0] + v[1] * v[1]);\n        var ratio = velocity / now;\n        body.velocity = [body.velocity[0] * ratio, body.velocity[1] * ratio];\n    };\n};\n\nInteraction_GameCommand_P2.BreakItem = function () {\n    _Interaction_GameCommand2.default.IBreakItem.call(this);\n    this.exec = function (item) {\n        var body = item.getElement(_Element_P2.default.KEY);\n        setTimeout(function () {\n            if (body.world == null) return;\n            body.world.removeBody(body);\n        }, 0);\n    };\n};\n\nInteraction_GameCommand_P2.BreakBlock = function () {\n    _Interaction_GameCommand2.default.IBreakBlock.call(this);\n    this.exec = function (block) {\n        var body = block.getElement(_Element_P2.default.KEY);\n        //worldからのremoveはbeginContactでは行わないこと\n        //https://github.com/schteppe/p2.js/wiki#events-fired-during-step\n        setTimeout(function () {\n            if (body.world == null) return;\n            body.world.removeBody(body);\n        }, 0);\n    };\n};\n\nInteraction_GameCommand_P2.BreakBall = function () {\n    _Interaction_GameCommand2.default.IBreakBall.call(this);\n    this.exec = function (ball) {\n        var body = ball.getElement(_Element_P2.default.KEY);\n        setTimeout(function () {\n            if (body.world == null) return;\n            body.world.removeBody(body);\n        }, 0);\n    };\n};\n\nInteraction_GameCommand_P2.OutAreaBreakBallRectangleArea = function () {\n    _Interaction_GameCommand2.default.IOutAreaBreakBallRectangleArea.call(this);\n    this.getPosition = function (ball) {\n        var body = ball.getElement(_Element_P2.default.KEY);\n        var x = body.position[0];\n        var y = body.position[1];\n        return [x, y];\n    };\n};\n\nInteraction_GameCommand_P2.BreakBullet = function () {\n    _Interaction_GameCommand2.default.IBreakBullet.call(this);\n    this.exec = function (bullet) {\n        var body = bullet.getElement(_Element_P2.default.KEY);\n        setTimeout(function () {\n            if (body.world == null) return;\n            body.world.removeBody(body);\n        }, 0);\n    };\n};\n\nInteraction_GameCommand_P2.BreakPlayer = function () {\n    _Interaction_GameCommand2.default.IBreakPlayerBarStoreProcess.call(this);\n    this.procBar = function (bar) {\n        var b = bar.getElement(_Element_P2.default.KEY);\n        setTimeout(function () {\n            if (b.world == null) return;\n            b.world.removeBody(b);\n        }, 0);\n    };\n};\n\n/**\r\n * worldごと破壊する。\r\n * @param {p2.World} world\r\n */\nInteraction_GameCommand_P2.GameClear = function (world) {\n    _Interaction_GameCommand2.default.IGameClear.call(this);\n    this.exec = function () {\n        world.clear();\n    };\n};\n\nInteraction_GameCommand_P2.DropItem = function () {\n    _Interaction_GameCommand2.default.IDropItem.call(this);\n    /**\r\n     * @param {Element.Item} item \r\n     * @param {Number[]} velocity \r\n     */\n    this.exec = function (item, velocity) {\n        var itemBody = item.getElement(_Element_P2.default.KEY);\n        itemBody.velocity = velocity.slice();\n    };\n};\n\nInteraction_GameCommand_P2.MoveItemToBlock = function () {\n    _Interaction_GameCommand2.default.IMoveItemToBlock.call(this);\n    this.exec = function (block, item) {\n        var blockBody = block.getElement(_Element_P2.default.KEY);\n        var itemBody = item.getElement(_Element_P2.default.KEY);\n        var aabb = blockBody.aabb;\n        var pos = [(aabb.upperBound[0] + aabb.lowerBound[0]) / 2, (aabb.upperBound[1] + aabb.lowerBound[1]) / 2];\n        itemBody.position = pos;\n        itemBody.previousPosition = pos;\n    };\n};\n\nInteraction_GameCommand_P2.ShootBullet = function () {\n    _Interaction_GameCommand2.default.IShootBullet.call(this);\n    this.exec = function (bullet, velocity) {\n        var body = bullet.getElement(_Element_P2.default.KEY);\n        body.velocity = velocity.slice();\n    };\n};\n\nInteraction_GameCommand_P2.MoveBulletToBar = function () {\n    _Interaction_GameCommand2.default.IMoveBulletToBar.call(this);\n    this.exec = function (bar, bullet) {\n        var barBody = bar.getElement(_Element_P2.default.KEY);\n        var bulletBody = bullet.getElement(_Element_P2.default.KEY);\n        var aabb = barBody.aabb;\n        //下に長いこともあるが、本体の中心だとよくない。上部の中心から出す。\n        var pos = [(aabb.upperBound[0] + aabb.lowerBound[0]) / 2, aabb.lowerBound[1]];\n        bulletBody.position = pos;\n        bulletBody.previousPosition = pos;\n    };\n};\n\nInteraction_GameCommand_P2.MoveBulletToBallRandomRaround = function () {\n    _Interaction_GameCommand2.default.IMoveBulletToBallRandomRaround.call(this);\n    this.exec = function (ball, bullet, dx, dy) {\n        var ballBody = ball.getElement(_Element_P2.default.KEY);\n        var bulletBody = bullet.getElement(_Element_P2.default.KEY);\n\n        var pos = ballBody.position;\n        var newPos = [pos[0] + dx, pos[1] + dy];\n        bulletBody.position = newPos;\n        bulletBody.previousPosition = newPos;\n    };\n};\n\nInteraction_GameCommand_P2.ReelBall = function () {\n    _Interaction_GameCommand2.default.IReelBall.call(this);\n    this.exec = function (x, y, ticks, ball, pow) {\n        var body = ball.getElement(_Element_P2.default.KEY);\n\n        //速度0は発射前とみなして対応しない。\n        var v = body.velocity;\n        if (v[0] === 0 && v[1] === 0) return;\n\n        var pos = body.position;\n        var vector = [(x - pos[0]) * pow, (y - pos[1]) * pow];\n        body.applyForce(vector);\n    };\n};\n\nexports.default = Interaction_GameCommand_P2;\n\n//# sourceURL=webpack:///./src/Interaction_GameCommand_P2.js?");

/***/ }),

/***/ "./src/Interaction_GameCommand_Pixi.js":
/*!*********************************************!*\
  !*** ./src/Interaction_GameCommand_Pixi.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Element_Pixi = __webpack_require__(/*! ./Element_Pixi */ \"./src/Element_Pixi.js\");\n\nvar _Element_Pixi2 = _interopRequireDefault(_Element_Pixi);\n\nvar _Element_Particle = __webpack_require__(/*! ./Element_Particle */ \"./src/Element_Particle.js\");\n\nvar _Element_Particle2 = _interopRequireDefault(_Element_Particle);\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nvar _Interaction_GameCommand = __webpack_require__(/*! ./Interaction_GameCommand */ \"./src/Interaction_GameCommand.js\");\n\nvar _Interaction_GameCommand2 = _interopRequireDefault(_Interaction_GameCommand);\n\nvar _Interaction_GameEvent_Pixi = __webpack_require__(/*! ./Interaction_GameEvent_Pixi */ \"./src/Interaction_GameEvent_Pixi.js\");\n\nvar _Interaction_GameEvent_Pixi2 = _interopRequireDefault(_Interaction_GameEvent_Pixi);\n\nvar _Interaction_GameEvent_Binder = __webpack_require__(/*! ./Interaction_GameEvent_Binder */ \"./src/Interaction_GameEvent_Binder.js\");\n\nvar _Interaction_GameEvent_Binder2 = _interopRequireDefault(_Interaction_GameEvent_Binder);\n\nvar _Interaction_UpdaterListener = __webpack_require__(/*! ./Interaction_UpdaterListener */ \"./src/Interaction_UpdaterListener.js\");\n\nvar _Interaction_UpdaterListener2 = _interopRequireDefault(_Interaction_UpdaterListener);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Interaction_GameCommand_Pixi = {};\n\n/**\r\n * @param {Object} textureArray { ファイルパス: Texture }\r\n */\nInteraction_GameCommand_Pixi.ImageLoadGameStartTextureArrayStore = function (textureArray) {\n    _Interaction_GameCommand2.default.IImageLoadGameStart.call(this);\n    this.execAsync = function (key, url) {\n        return new Promise(function (resolve, reject) {\n            var loader = new PIXI.loaders.Loader();\n            loader.add(key, url, { crossOrigin: true });\n            loader.onError.add(function (e, l, r) {\n                return reject('error:' + key + ':' + url);\n            });\n            loader.load(function (loader, resources) {\n                var texture = resources[key].texture;\n                textureArray[key] = texture;\n                resolve();\n            });\n        });\n    };\n};\n\n/**\r\n * @param {Object} textureArray { ファイルパス: Texture }\r\n */\nInteraction_GameCommand_Pixi.ImageLoadGameStartImgTag = function (textureArray) {\n    _Interaction_GameCommand2.default.IImageLoadGameStart.call(this);\n    this.execAsync = function (key, url) {\n        return new Promise(function (resolve, reject) {\n            var img = new Image();\n            img.crossOrigin = 'anonymous';\n            img.onload = function () {\n                var texture = PIXI.Texture.from(img);\n                textureArray[key] = texture;\n                resolve();\n            };\n            img.onerror = function (e) {\n                reject('error:' + e.target.currentSrc);\n            };\n            img.src = url;\n        });\n    };\n};\n\n/**\r\n * @param {Object} textureArray { ファイルパス: Texture }\r\n */\nInteraction_GameCommand_Pixi.ImageLoadGameStartJsonpImage = function (textureArray) {\n    _Interaction_GameCommand2.default.IImageLoadGameStart.call(this);\n\n    function randomString(len) {\n        var l = len;\n        var c = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n        var cl = c.length;\n        var r = \"\";\n        for (var i = 0; i < l; i++) {\n            r += c[Math.floor(Math.random() * cl)];\n        }\n        return r;\n    }\n\n    this.execAsync = function (key, url) {\n        return new Promise(function (resolve, reject) {\n            var id = 'callback' + randomString(40);\n            window[id] = function (base64) {\n                textureArray[key] = PIXI.Texture.fromImage('data:image/png;base64,' + base64);\n                delete window[id];\n                document.getElementById(id).remove();\n                resolve();\n            };\n            var sc = document.createElement(\"script\");\n            sc.type = 'text/javascript';\n            sc.src = url + '&callback=window.' + id;\n            sc.id = id;\n            var parent = document.getElementsByTagName(\"script\")[0];\n            parent.parentNode.insertBefore(sc, parent);\n        });\n    };\n};\n\nInteraction_GameCommand_Pixi.PutBlock = function () {\n    _Interaction_GameCommand2.default.IPutBlock.call(this);\n    function put(block, x, y, key) {\n        var graphics = block.getElement(key);\n        graphics.x = x;\n        graphics.y = y;\n    }\n    this.exec = function (block, x, y) {\n        put(block, x, y, _Element_Pixi2.default.KEY);\n        put(block, x, y, _Element_Pixi2.default.KEY_PREVIEW);\n    };\n};\n\nInteraction_GameCommand_Pixi.PutLabel = function () {\n    _Interaction_GameCommand2.default.IPutLabel.call(this);\n    this.exec = function (label, x, y) {\n        var graphics = label.getElement(_Element_Pixi2.default.KEY);\n        graphics.x = x;\n        graphics.y = y;\n    };\n};\n\n/**\r\n * 既存のgraphicsをマスクとし、そのマスクでtextureを切り抜き、差し替える。\r\n * blockのelementも差し替えている。\r\n * @param {Object} textureArray { ファイルパス: Texture }\r\n */\nInteraction_GameCommand_Pixi.ChangeBlockMaskImage = function (textureArray) {\n    _Interaction_GameCommand2.default.IChangeBlockMaskImage.call(this);\n    function limit(base, width, limit) {\n        if (base + width < limit) return width;\n        return limit - base;\n    }\n    this.exec = function (block, path) {\n        var texture = textureArray[path];\n        var graphics = block.getElement(_Element_Pixi2.default.KEY).children.filter(function (c) {\n            return c instanceof PIXI.Graphics;\n        })[0];\n        var x = graphics.parent.x;\n        var y = graphics.parent.y;\n        var bounds = graphics.getLocalBounds();\n        var crop = new PIXI.Texture(texture.baseTexture, new PIXI.Rectangle(bounds.x + x, bounds.y + y, limit(bounds.x + x, bounds.width, texture.baseTexture.width), limit(bounds.y + y, bounds.height, texture.baseTexture.height)), texture.orig, bounds);\n        var sprite = new PIXI.Sprite(crop);\n        var parent = graphics.parent.parent;\n        var container = new PIXI.Container();\n        graphics.parent.x = 0;\n        graphics.parent.y = 0;\n        container.addChild(graphics);\n        container.addChild(sprite);\n        sprite.mask = graphics;\n        container.x = x;\n        container.y = y;\n        parent.addChild(container);\n        block.setElement(_Element_Pixi2.default.KEY, container);\n        return;\n    };\n};\n\nInteraction_GameCommand_Pixi.BreakItem = function () {\n    _Interaction_GameCommand2.default.IBreakItem.call(this);\n    this.exec = function (item) {\n        var graphics = item.getElement(_Element_Pixi2.default.KEY);\n        graphics.parent.removeChild(graphics);\n    };\n};\n\nInteraction_GameCommand_Pixi.BreakBlock = function () {\n    _Interaction_GameCommand2.default.IBreakBlock.call(this);\n    function remove(block, key) {\n        var graphics = block.getElement(key);\n        graphics.parent.removeChild(graphics);\n    }\n    this.exec = function (block) {\n        remove(block, _Element_Pixi2.default.KEY);\n        remove(block, _Element_Pixi2.default.KEY_PREVIEW);\n    };\n};\n\nInteraction_GameCommand_Pixi.BreakBall = function () {\n    _Interaction_GameCommand2.default.IBreakBall.call(this);\n    this.exec = function (ball) {\n        var graphics = ball.getElement(_Element_Pixi2.default.KEY);\n        graphics.parent.removeChild(graphics);\n    };\n};\n\nInteraction_GameCommand_Pixi.BreakBullet = function () {\n    _Interaction_GameCommand2.default.IBreakBullet.call(this);\n    this.exec = function (bullet) {\n        var graphics = bullet.getElement(_Element_Pixi2.default.KEY);\n        graphics.parent.removeChild(graphics);\n    };\n};\n\nInteraction_GameCommand_Pixi.DrawText = function () {\n    _Interaction_GameCommand2.default.IDrawText.call(this);\n    this.exec = function (element, text, x, y, halign, valign, sizedShape, textShape) {\n        textShape.applyShape(text, function (w, h, textSprite) {\n            sizedShape.applyShape(element, w, h);\n\n            var graphics = element.getElement(_Element_Pixi2.default.KEY);\n            graphics.addChild(textSprite);\n            var bounds = graphics.getLocalBounds();\n\n            var dx = 0;\n            var dy = 0;\n            if (halign === '' || halign === 'left') dx = -bounds.x;\n            if (halign === 'center') dx = -bounds.x - bounds.width / 2;\n            if (halign === 'right') dx = -bounds.x - bounds.width;\n            if (valign === '' || valign === 'top') dy = -bounds.y;\n            if (valign === 'center') dy = -bounds.y - bounds.height / 2;\n            if (valign === 'bottom') dy = -bounds.y - bounds.height;\n            graphics.x = x + Math.floor(dx);\n            graphics.y = y + Math.floor(dy);\n        });\n    };\n};\n\nInteraction_GameCommand_Pixi.DrawTextFramed = function () {\n    _Interaction_GameCommand2.default.IDrawTextFramed.call(this);\n    this.exec = function (element, text, x, y, width, height, halign, valign, sizedShape, textShape) {\n        textShape.applyShape(text, function (metrixWidth, metrixHeight, textSprite) {\n            sizedShape.applyShape(element, width, height);\n\n            var graphics = element.getElement(_Element_Pixi2.default.KEY);\n            graphics.x = x;\n            graphics.y = y;\n\n            graphics.addChild(textSprite);\n            var dx = 0;\n            var dy = 0;\n            if (halign === '' || halign === 'left') dx = 0;\n            if (halign === 'center') dx = width / 2 - metrixWidth / 2;\n            if (halign === 'right') dx = width - metrixWidth;\n            if (valign === '' || valign === 'top') dy = 0;\n            if (valign === 'center') dy = height / 2 - metrixHeight / 2;\n            if (valign === 'bottom') dy = height - metrixHeight;\n            textSprite.x = Math.floor(dx);\n            textSprite.y = Math.floor(dy);\n        });\n    };\n};\n\nInteraction_GameCommand_Pixi.Tappable = function () {\n    _Interaction_GameCommand2.default.ITappable.call(this);\n    this.exec = function (element) {\n        var graphics = element.getElement(_Element_Pixi2.default.KEY);\n        graphics.buttonMode = true;\n        var ret = new _Interaction_GameEvent_Pixi2.default.LabelTapEventConcrete(graphics);\n        return ret;\n    };\n};\n\nInteraction_GameCommand_Pixi.BreakPlayer = function () {\n    _Interaction_GameCommand2.default.IBreakPlayerBarStoreProcess.call(this);\n    this.procBar = function (bar) {\n        var b = bar.getElement(_Element_Pixi2.default.KEY);\n        b.parent.removeChild(b);\n    };\n};\n\nInteraction_GameCommand_Pixi.GameClearStoreProcess = function () {\n    _Interaction_GameCommand2.default.IGameClearStoreProcess.call(this);\n    this.procBall = function (ball) {\n        var g = ball.getElement(_Element_Pixi2.default.KEY);\n        g.parent.removeChild(g);\n    };\n    this.procItem = function (item) {\n        var g = item.getElement(_Element_Pixi2.default.KEY);\n        g.parent.removeChild(g);\n    };\n    this.procBar = function (bar) {\n        var g = bar.getElement(_Element_Pixi2.default.KEY);\n        g.parent.removeChild(g);\n    };\n    this.procBullet = function (bullet) {\n        var g = bullet.getElement(_Element_Pixi2.default.KEY);\n        g.parent.removeChild(g);\n    };\n};\n\nInteraction_GameCommand_Pixi.ParticleBlock = function () {\n    _Interaction_GameCommand2.default.IParticleBlock.call(this);\n    this.x = function (block) {\n        var view = block.getElement(_Element_Pixi2.default.KEY);\n        var rect = view.getLocalBounds();\n        //blockは左上が0\n        return view.x + rect.width / 2;\n    };\n    this.y = function (block) {\n        var view = block.getElement(_Element_Pixi2.default.KEY);\n        var rect = view.getLocalBounds();\n        //blockは左上が0\n        return view.y + rect.height / 2;\n    };\n};\n\nInteraction_GameCommand_Pixi.ParticleBall = function () {\n    _Interaction_GameCommand2.default.IParticleBall.call(this);\n    this.x = function (block) {\n        var view = block.getElement(_Element_Pixi2.default.KEY);\n        return view.x;\n    };\n    this.y = function (block) {\n        var view = block.getElement(_Element_Pixi2.default.KEY);\n        return view.y;\n    };\n};\n\nInteraction_GameCommand_Pixi.ParticleBar = function () {\n    _Interaction_GameCommand2.default.IParticleBar.call(this);\n    this.x = function (bar) {\n        var view = bar.getElement(_Element_Pixi2.default.KEY);\n        return view.x;\n    };\n    this.y = function (bar) {\n        var view = bar.getElement(_Element_Pixi2.default.KEY);\n        return view.y;\n    };\n};\n\nInteraction_GameCommand_Pixi.TweenElement = function () {\n    _Interaction_GameCommand2.default.ITweenElement.call(this);\n    this.exec = function (element, factory) {\n        var view = element.getElement(_Element_Pixi2.default.KEY);\n        var tween = factory.createTween(function (x, y, a) {\n            view.children.forEach(function (c) {\n                c.alpha = a;\n                c.x = x;\n                c.y = y;\n            });\n        });\n        return tween;\n    };\n};\n\nInteraction_GameCommand_Pixi.FadeScreenAlphaTweenFactory = function () {\n    _Interaction_GameCommand2.default.IFadeScreenAlphaTweenFactory.call(this);\n    this.create = function (layer, color, width, height) {\n        var container = layer.getConcrete();\n        var graphics = new PIXI.Graphics().beginFill(color, 1.0).drawRect(0, 0, width, height).endFill();\n        var ret = new Interaction_GameCommand_Pixi.FadeScreenAlphaTween(container, graphics);\n        return ret;\n    };\n};\nInteraction_GameCommand_Pixi.FadeScreenAlphaTween = function (container, graphics) {\n    _Interaction_GameCommand2.default.IFadeScreenAlphaTween.call(this);\n    this.setAlpha = function (alpha) {\n        graphics.alpha = alpha;\n    };\n    this.on = function () {\n        container.addChild(graphics);\n    };\n    this.off = function () {\n        container.removeChild(graphics);\n    };\n};\n\nInteraction_GameCommand_Pixi.FlashLabel = function () {\n    _Interaction_GameCommand2.default.ITweenElement.call(this);\n    /**\r\n     * @param {Element.Label} label \r\n     * @param {Element_Effect.TweenFactory} factory \r\n     */\n    this.exec = function (label, factory) {\n        var view = label.getElement(_Element_Pixi2.default.KEY);\n        var base = view.children[0];\n        var bounds = base.getLocalBounds();\n        var wrap = new PIXI.Graphics().beginFill(0xFFFFFF, 1.0).drawRect(bounds.x, bounds.y, bounds.width, bounds.height).endFill();\n        //maskに使うと表示されないためcloneしてmask専用にする。\n        //baseがGraphicsなら動くが、Spriteだとたぶん動かない。cloneがないため。\n        if (base.clone != null) {\n            var mask = base.clone();\n            wrap.mask = mask;\n            view.addChild(mask);\n        }\n        view.addChild(wrap);\n        wrap.x = base.x;\n        wrap.y = base.y;\n\n        var tween = factory.createTween(function (x, y, a) {\n            wrap.alpha = a;\n        });\n        var ret = new _Interaction_UpdaterListener2.default.ListenerWrapper(tween, function () {}, function () {}, function () {\n            var mask = wrap.mask;\n            if (mask != null) {\n                wrap.mask = null;\n                view.removeChild(mask);\n            }\n            view.removeChild(wrap);\n        });\n        return ret;\n    };\n};\n\n/**\r\n * Arrayに保持済みの画像で切り替える。Arrayに保持されていない場合は、何もしない。\r\n * 切り替えは、containerの内容を全消去したうえで、0,0に追加する。\r\n * @param {PIXI.Container} container\r\n */\nInteraction_GameCommand_Pixi.ChangeImageArraySource = function (container) {\n    _Interaction_GameCommand2.default.IChangeImage.call(this);\n    this.exec = function (image) {\n        container.removeChildren();\n        var sprite = image.getElement(_Element_Pixi2.default.KEY);\n        container.addChild(sprite);\n    };\n};\nInteraction_GameCommand_Pixi.ChangeImageArraySourceFactory = function () {\n    _Interaction_GameCommand2.default.IChangeImageFactory.call(this);\n    this.create = function (layer) {\n        var container = layer.getConcrete();\n        var ret = new Interaction_GameCommand_Pixi.ChangeImageArraySource(container);\n        return ret;\n    };\n};\n\n/**\r\n * containerの内容を全消去する。\r\n * @param {PIXI.Container} container\r\n */\nInteraction_GameCommand_Pixi.RemoveContainerImage = function (container) {\n    _Interaction_GameCommand2.default.IRemoveImage.call(this);\n    this.exec = function () {\n        container.removeChildren();\n    };\n};\nInteraction_GameCommand_Pixi.RemoveContainerImageFactory = function () {\n    _Interaction_GameCommand2.default.IRemoveImageFactory.call(this);\n    this.create = function (layer) {\n        var container = layer.getConcrete();\n        var ret = new Interaction_GameCommand_Pixi.RemoveContainerImage(container);\n        return ret;\n    };\n};\n\nexports.default = Interaction_GameCommand_Pixi;\n\n//# sourceURL=webpack:///./src/Interaction_GameCommand_Pixi.js?");

/***/ }),

/***/ "./src/Interaction_GameEvent.js":
/*!**************************************!*\
  !*** ./src/Interaction_GameEvent.js ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar Interaction_GameEvent = {};\n//移行完了\n\n/**\r\n * AppStart\r\n * -> (StageStart) -> xxx -> GameStart\r\n *   -> GameFail -> xxx -> StageFail -> xxx\r\n *     -> AppFail -> xxx -> AppStart...\r\n *     -> StageStart...\r\n *   -> GameClear -> xxx -> StageClear\r\n *      -> (StageStart)...\r\n *      -> AppClear\r\n * \r\n * StageStartはStageBuilder.build()がその役割をする。\r\n */\n\n/**\r\n * 発火したらそのまま通知するだけの実装。\r\n */\nInteraction_GameEvent.PassThroughImplement = function (_fired) {\n    var fired = _fired == null ? 'fired' : _fired;\n    var listeners = [];\n    this.addListener = function (listener) {\n        if (listener[fired] == null) throw new Error('listener need [' + fired + ']');\n        listeners.push(listener[fired]);\n    };\n    this.fire = function () {\n        var args = arguments;\n        listeners.forEach(function (listener) {\n            listener.apply(this, args);\n        });\n    };\n};\n\n/**\r\n * ゲームが開始した。(ボールは発射されてない)\r\n * ＝ゲーム画面の準備が完了した。\r\n * 残機減後の復活もこれ。\r\n * Interaction_GameCommand.GameStartの後に起きる。\r\n */\nInteraction_GameEvent.StartEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IStartEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function () {\n        implement.fire();\n    };\n};\nInteraction_GameEvent.IStartEventListener = function () {\n    this.fired = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ゲームがクリアした。\r\n * Interaction_GameCommand.GameClearの後に起きる。\r\n */\nInteraction_GameEvent.ClearEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IStartEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (message) {\n        implement.fire(message);\n    };\n};\nInteraction_GameEvent.IClearEventListener = function () {\n    this.fired = function (message) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ゲームが失敗した。残機数が０。\r\n * Interaction_GameCommand.GameFailの後に起きる。\r\n */\nInteraction_GameEvent.FailEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IFailEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function () {\n        implement.fire();\n    };\n};\nInteraction_GameEvent.IFailEventListener = function () {\n    this.fired = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ブロックに何かが接触した。\r\n */\nInteraction_GameEvent.HitEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IHitEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (block) {\n        implement.fire(block);\n    };\n};\nInteraction_GameEvent.IHitEventListener = function () {\n    this.fired = function (block) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ブロックにボールが接触した。\r\n */\nInteraction_GameEvent.HitBallEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IHitBallEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (block, ball) {\n        implement.fire(block, ball);\n    };\n};\nInteraction_GameEvent.IHitBallEventListener = function () {\n    this.fired = function (block, ball) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ブロックに弾丸が接触した。\r\n */\nInteraction_GameEvent.HitBulletEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IHitBulletEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (block, bullet) {\n        implement.fire(block, bullet);\n    };\n};\nInteraction_GameEvent.IHitBulletEventListener = function () {\n    this.fired = function (block, bullet) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ballがbarに当たった。\r\n */\nInteraction_GameEvent.HitBallBarEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IHitBallBarEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (ball, bar) {\n        implement.fire(ball, bar);\n    };\n};\nInteraction_GameEvent.IHitBallBarEventListener = function () {\n    this.fired = function (ball, bar) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ブロックが破壊された。\r\n * Interaction_GameCommand.BreakBlockの後に起きる。\r\n */\nInteraction_GameEvent.BreakEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IBreakEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (block) {\n        implement.fire(block);\n    };\n};\nInteraction_GameEvent.IBreakEventListener = function () {\n    this.fired = function (block) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ボールが失われた。\r\n * 失われ判定でtrueになったら起きる。\r\n */\nInteraction_GameEvent.LostBallEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.ILostBallEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (ball) {\n        implement.fire(ball);\n    };\n};\nInteraction_GameEvent.ILostBallEventListener = function () {\n    this.fired = function (ball) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * bulletが失われた。\r\n * 失われ判定でtrueになったら起きる。\r\n */\nInteraction_GameEvent.LostBulletEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.ILostBulletEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (bullet) {\n        implement.fire(bullet);\n    };\n};\nInteraction_GameEvent.ILostBulletEventListener = function () {\n    this.fired = function (bullet) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * アイテムを取得した。\r\n */\nInteraction_GameEvent.GetItemEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IGetItemEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (item, bar) {\n        implement.fire(item, bar);\n    };\n};\nInteraction_GameEvent.IGetItemEventListener = function () {\n    this.fired = function (item, bar) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * itemが失われた。\r\n * 失われ判定でtrueになったら起きる。\r\n */\nInteraction_GameEvent.LostItemEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.ILostItemEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (item) {\n        implement.fire(item);\n    };\n};\nInteraction_GameEvent.ILostItemEventListener = function () {\n    this.fired = function (item) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * 画面がタップされた。\r\n */\nInteraction_GameEvent.TapEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.ITapEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function () {\n        implement.fire();\n    };\n};\nInteraction_GameEvent.ITapEventListener = function () {\n    this.fired = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ラベルがタップされた。\r\n */\nInteraction_GameEvent.LabelTapEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.ILabelTapEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (label) {\n        implement.fire(label);\n    };\n};\nInteraction_GameEvent.ILabelTapEventListener = function () {\n    this.fired = function (label) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * barエリア上でドラッグされた。\r\n */\nInteraction_GameEvent.BarDragEvent = function () {\n    var implementFired = new Interaction_GameEvent.PassThroughImplement('fired');\n    var implementStoped = new Interaction_GameEvent.PassThroughImplement('stoped');\n    /**\r\n     * @param {Interaction_GameEvent.IDragEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implementFired.addListener(listener);\n        implementStoped.addListener(listener);\n    };\n    this.fire = function (x, y) {\n        implementFired.fire(x, y);\n    };\n    this.stop = function (x, y) {\n        implementStoped.fire(x, y);\n    };\n};\n/**\r\n * imageエリア上でドラッグされた。\r\n */\nInteraction_GameEvent.ImageDragEvent = function () {\n    var implementFired = new Interaction_GameEvent.PassThroughImplement('fired');\n    var implementStoped = new Interaction_GameEvent.PassThroughImplement('stoped');\n    /**\r\n     * @param {Interaction_GameEvent.IDragEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implementFired.addListener(listener);\n        implementStoped.addListener(listener);\n    };\n    this.fire = function (x, y) {\n        implementFired.fire(x, y);\n    };\n    this.stop = function (x, y) {\n        implementStoped.fire(x, y);\n    };\n};\nInteraction_GameEvent.IDragEventListener = function () {\n    this.fired = function (x, y) {\n        throw new Error('未実装');\n    };\n    this.stoped = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * barが動いた。\r\n * Interaction_GameCommand_P2.XLimitedByAabbMoveBarの後に起きる。\r\n */\nInteraction_GameEvent.MoveBarEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IBreakEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function (x, y) {\n        implement.fire(x, y);\n    };\n};\nInteraction_GameEvent.IMoveBarEventListener = function () {\n    this.fired = function (x, y) {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * プレイヤーが破壊された。\r\n * Interaction_GameCommand.BreakPlayerの後に起きる。\r\n */\nInteraction_GameEvent.BreakPlayerEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IBreakPlayerEventListener} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function () {\n        implement.fire();\n    };\n};\nInteraction_GameEvent.IBreakPlayerEventListener = function () {\n    this.fired = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ゲームが一時中断された。\r\n * Interaction_GameCommand.GameSuspendの後に起きる。\r\n */\nInteraction_GameEvent.GameSuspendEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IGameSuspendEvent} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function () {\n        implement.fire();\n    };\n};\nInteraction_GameEvent.IGameSuspendEvent = function () {\n    this.fired = function () {\n        throw new Error('未実装');\n    };\n};\n\n/**\r\n * ゲームが再開された。\r\n * Interaction_GameCommand.GameResumeの後に起きる。\r\n */\nInteraction_GameEvent.GameResumeEvent = function () {\n    var implement = new Interaction_GameEvent.PassThroughImplement();\n    /**\r\n     * @param {Interaction_GameEvent.IGameResumeEvent} listener\r\n     */\n    this.addListener = function (listener) {\n        implement.addListener(listener);\n    };\n    this.fire = function () {\n        implement.fire();\n    };\n};\nInteraction_GameEvent.IGameResumeEvent = function () {\n    this.fired = function () {\n        throw new Error('未実装');\n    };\n};\n\nexports.default = Interaction_GameEvent;\n\n//# sourceURL=webpack:///./src/Interaction_GameEvent.js?");

/***/ }),

/***/ "./src/Interaction_GameEvent_Binder.js":
/*!*********************************************!*\
  !*** ./src/Interaction_GameEvent_Binder.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nvar _Interaction_GameEvent = __webpack_require__(/*! ./Interaction_GameEvent */ \"./src/Interaction_GameEvent.js\");\n\nvar _Interaction_GameEvent2 = _interopRequireDefault(_Interaction_GameEvent);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//移行完了\n\nvar Interaction_GameEvent_Binder = {};\n\n///TODO listener,concreteの型はジェネリックにする\nInteraction_GameEvent_Binder.OnOffCheckBinder = function (listener, concrete) {\n    var isOn = false;\n    this.on = function () {\n        if (isOn) {\n            throw new Error('already on');\n        };\n        concrete.on(listener);\n        isOn = true;\n    };\n    this.off = function () {\n        if (!isOn) return;\n        concrete.off();\n        isOn = false;\n    };\n};\n\nInteraction_GameEvent_Binder.IHitEventBinderListener = function () {\n    this.fire = function (idA, idB) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameEvent_Binder.IHitEventBinderConcrete = function () {\n    this.on = function (listener) {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.HitEvent} hitEvent \r\n * @param {Interaction_GameEvent.HitBallEvent} hitBallEvent \r\n * @param {Element_Store.BallStore} ballStore \r\n * @param {Element_Store.BlockStore} blockStore \r\n * @param {Interaction_GameEvent_Binder.IHitEventBinderConcrete} concrete\r\n */\nInteraction_GameEvent_Binder.HitEventBinder = function (hitEvent, hitBallEvent, ballStore, blockStore, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.IHitEventBinderListener.call(this);\n\n    var binder = new Interaction_GameEvent_Binder.OnOffCheckBinder(this, concrete);\n\n    this.fire = function (idA, idB) {\n        var ball = ballStore.get(idA) || ballStore.get(idB);\n        if (ball == null) return;\n        var block = blockStore.get(idA) || blockStore.get(idB);\n        if (block == null) return;\n        hitEvent.fire(block);\n        hitBallEvent.fire(block, ball);\n    };\n    this.on = function () {\n        binder.on();\n    };\n    this.off = function () {\n        binder.off();\n    };\n};\n\nInteraction_GameEvent_Binder.IHitBallBarEventBinderListener = function () {\n    this.fire = function (idA, idB) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameEvent_Binder.IHitBallBarEventBinderConcrete = function () {\n    this.on = function (listener) {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.HitBallBarEvent} hitBallBarEvent \r\n * @param {Element_Store.BallStore} ballStore \r\n * @param {Element_Store.BarStore} barStore \r\n * @param {Interaction_GameEvent_Binder.IHitBallBarEventBinderConcrete} concrete \r\n */\nInteraction_GameEvent_Binder.HitBallBarEventBinder = function (hitBallBarEvent, ballStore, barStore, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.IHitBallBarEventBinderListener.call(this);\n\n    var binder = new Interaction_GameEvent_Binder.OnOffCheckBinder(this, concrete);\n\n    this.fire = function (idA, idB) {\n        var ball = ballStore.get(idA) || ballStore.get(idB);\n        if (ball == null) return;\n        var bar = barStore.get(idA) || barStore.get(idB);\n        if (bar == null) return;\n        hitBallBarEvent.fire(ball, bar);\n    };\n    this.on = function () {\n        binder.on();\n    };\n    this.off = function () {\n        binder.off();\n    };\n};\n\nInteraction_GameEvent_Binder.IHitBulletEventBinderListener = function () {\n    this.fire = function (idA, idB) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameEvent_Binder.IHitBulletEventBinderConcrete = function () {\n    this.on = function (listener) {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.HitBulletEvent} hitBulletEvent \r\n * @param {Element_Store.BulletStore} bulletStore \r\n * @param {Element_Store.BlockStore} blockStore \r\n * @param {Interaction_GameEvent_Binder.IHitBulletEventBinderConcrete} concrete\r\n */\nInteraction_GameEvent_Binder.HitBulletEventBinder = function (hitBulletEvent, bulletStore, blockStore, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.IHitBulletEventBinderListener.call(this);\n\n    var binder = new Interaction_GameEvent_Binder.OnOffCheckBinder(this, concrete);\n\n    this.fire = function (idA, idB) {\n        var bullet = bulletStore.get(idA) || bulletStore.get(idB);\n        if (bullet == null) return;\n        var block = blockStore.get(idA) || blockStore.get(idB);\n        if (block == null) return;\n        hitBulletEvent.fire(block, bullet);\n    };\n    this.on = function () {\n        binder.on();\n    };\n    this.off = function () {\n        binder.off();\n    };\n};\n\nInteraction_GameEvent_Binder.ILostBallEventBinderListener = function () {\n    this.fire = function (idA, idB) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameEvent_Binder.ILostBallEventBinderConcrete = function () {\n    this.on = function (listener) {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.LostBallEvent} lostBallEvent \r\n * @param {Element_Store.BallStore} ballStore \r\n * @param {Element_Store.LostAreaStore} lostAreaStore \r\n * @param {Interaction_GameEvent_Binder.ILostBallEventBinderConcrete} concrete\r\n */\nInteraction_GameEvent_Binder.LostBallEventBinder = function (lostBallEvent, ballStore, lostAreaStore, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.ILostBallEventBinderListener.call(this);\n\n    var binder = new Interaction_GameEvent_Binder.OnOffCheckBinder(this, concrete);\n\n    this.fire = function (idA, idB) {\n        var ball = ballStore.get(idA) || ballStore.get(idB);\n        if (ball == null) return;\n        var lostArea = lostAreaStore.get(idA) || lostAreaStore.get(idB);\n        if (lostArea == null) return;\n        lostBallEvent.fire(ball);\n    };\n    this.on = function () {\n        binder.on();\n    };\n    this.off = function () {\n        binder.off();\n    };\n};\n\nInteraction_GameEvent_Binder.ILostBulletEventBinderListener = function () {\n    this.fire = function (idA, idB) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameEvent_Binder.ILostBulletEventBinderConcrete = function () {\n    this.on = function (listener) {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.LostBallEvent} lostBulletEvent \r\n * @param {Element_Store.BulletStore} bulletStore \r\n * @param {Element_Store.PlayAreaStore} playAreaStore \r\n * @param {Interaction_GameEvent_Binder.ILostBulletEventBinderConcrete} concrete\r\n */\nInteraction_GameEvent_Binder.LostBulletEventBinder = function (lostBulletEvent, bulletStore, playAreaStore, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.ILostBulletEventBinderListener.call(this);\n\n    var binder = new Interaction_GameEvent_Binder.OnOffCheckBinder(this, concrete);\n\n    this.fire = function (idA, idB) {\n        var bullet = bulletStore.get(idA) || bulletStore.get(idB);\n        if (bullet == null) return;\n        var playArea = playAreaStore.get(idA) || playAreaStore.get(idB);\n        if (playArea == null) return;\n        lostBulletEvent.fire(bullet);\n    };\n    this.on = function () {\n        binder.on();\n    };\n    this.off = function () {\n        binder.off();\n    };\n};\n\nInteraction_GameEvent_Binder.IGetItemEventBinderListener = function () {\n    this.fire = function (idA, idB) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameEvent_Binder.IGetItemEventBinderConcrete = function () {\n    this.on = function (listener) {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.GetItemEvent} getItemEvent \r\n * @param {Element_Store.BarStore} barStore \r\n * @param {Element_Store.ItemStore} itemStore \r\n * @param {Interaction_GameEvent_Binder.IGetItemEventBinderConcrete} concrete\r\n */\nInteraction_GameEvent_Binder.GetItemEventBinder = function (getItemEvent, barStore, itemStore, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.IGetItemEventBinderListener.call(this);\n\n    var binder = new Interaction_GameEvent_Binder.OnOffCheckBinder(this, concrete);\n\n    this.fire = function (idA, idB) {\n        var bar = barStore.get(idA) || barStore.get(idB);\n        if (bar == null) return;\n        var item = itemStore.get(idA) || itemStore.get(idB);\n        if (item == null) return;\n        getItemEvent.fire(item, bar);\n    };\n    this.on = function () {\n        binder.on();\n    };\n    this.off = function () {\n        binder.off();\n    };\n};\n\nInteraction_GameEvent_Binder.ILostItemEventBinderListener = function () {\n    this.fire = function (idA, idB) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameEvent_Binder.ILostItemEventBinderConcrete = function () {\n    this.on = function (listener) {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.LostItemEvent} lostItemEvent \r\n * @param {Element_Store.ItemStore} itemStore \r\n * @param {Element_Store.LostAreaStore} lostAreaStore \r\n * @param {Interaction_GameEvent_Binder.ILostItemEventBinderConcrete} concrete\r\n */\nInteraction_GameEvent_Binder.LostItemEventBinder = function (lostItemEvent, itemStore, lostAreaStore, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.ILostItemEventBinderListener.call(this);\n\n    var binder = new Interaction_GameEvent_Binder.OnOffCheckBinder(this, concrete);\n\n    this.fire = function (idA, idB) {\n        var item = itemStore.get(idA) || itemStore.get(idB);\n        if (item == null) return;\n        var lostArea = lostAreaStore.get(idA) || lostAreaStore.get(idB);\n        if (lostArea == null) return;\n        lostItemEvent.fire(item);\n    };\n    this.on = function () {\n        binder.on();\n    };\n    this.off = function () {\n        binder.off();\n    };\n};\n\n///TODO eはジェネリック\nInteraction_GameEvent_Binder.IPositionEventListener = function () {\n    this.onDown = function (x, y) {\n        throw new Error('未実装');\n    };\n    this.onMove = function (x, y) {\n        throw new Error('未実装');\n    };\n    this.onOut = function () {\n        throw new Error('未実装');\n    };\n    this.onUp = function (e) {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameEvent_Binder.IPositionEventConcrete = function () {\n    this.on = function (listener) {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n///TODO fireFn(e)とlistener<e>はジェネリックで同じ型\n/**\r\n * @param {Number} allowance\r\n * @param {Function} fireFn\r\n * @param {Interaction_GameEvent_Binder.IPositionEventConcrete} concrete\r\n */\nInteraction_GameEvent_Binder.AllowancedTap = function (allowance, fireFn, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.IPositionEventListener.call(this);\n\n    var down = false;\n    var _x = 0;\n    var _y = 0;\n\n    this.onDown = function (x, y) {\n        down = true;\n        _x = x;\n        _y = y;\n    };\n    this.onMove = function (x, y) {\n        if (!down) return;\n        var dx = Math.abs(_x - x);\n        if (dx > allowance) {\n            down = false;\n            return;\n        }\n        var dy = Math.abs(_y - y);\n        if (dy > allowance) {\n            down = false;\n            return;\n        }\n    };\n    this.onOut = function () {\n        if (!down) return;\n        down = false;\n    };\n    this.onUp = function (event) {\n        if (!down) return;\n        down = false;\n        fireFn(event);\n    };\n\n    this.on = function () {\n        concrete.on(this);\n    };\n    this.off = function () {\n        concrete.off();\n    };\n};\n\n/**\r\n * @param {Number} allowance\r\n * @param {Interaction_GameEvent.TapEvent} tapEvent \r\n * @param {Interaction_GameEvent_Binder.IPositionEventConcrete} concrete\r\n */\nInteraction_GameEvent_Binder.TapEventBinder = function (allowance, tapEvent, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.AllowancedTap.call(this, allowance, function (_) {\n        tapEvent.fire();\n    }, concrete);\n};\n\n/**\r\n * @param {Number} allowance\r\n * @param {Interaction_GameEvent.LabelTapEvent} tapEvent \r\n * @param {Element_Store.LabelStore} store\r\n * @param {Interaction_GameEvent_Binder.IPositionEventConcrete} concrete\r\n */\nInteraction_GameEvent_Binder.LabelTapEventBinder = function (allowance, tapEvent, store, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.AllowancedTap.call(this, allowance, function (name) {\n        var target = store.get(name);\n        tapEvent.fire(target);\n    }, concrete);\n};\n\nInteraction_GameEvent_Binder.IDragEventListener = function () {\n    this.onDown = function (x, y) {\n        throw new Error('未実装');\n    };\n    this.onMove = function (x, y) {\n        throw new Error('未実装');\n    };\n    this.onUp = function () {\n        throw new Error('未実装');\n    };\n};\nInteraction_GameEvent_Binder.IDragEventConcrete = function () {\n    this.on = function (listener) {\n        throw new Error('未実装');\n    };\n    this.off = function () {\n        throw new Error('未実装');\n    };\n};\n/**\r\n * @param {Interaction_GameEvent.BarDragEvent} dragEvent \r\n * @param {Interaction_GameEvent_Binder.IDragEventConcrete} concrete\r\n */\nInteraction_GameEvent_Binder.DragEventBinder = function (dragEvent, concrete) {\n    _Interaction2.default.IEventBinder.call(this);\n    Interaction_GameEvent_Binder.IDragEventListener.call(this);\n\n    var down = false;\n\n    this.onDown = function (x, y) {\n        down = true;\n        dragEvent.fire(x, y);\n    };\n    this.onMove = function (x, y) {\n        if (!down) return;\n        dragEvent.fire(x, y);\n    };\n    this.onUp = function () {\n        if (!down) return;\n        down = false;\n        dragEvent.stop();\n    };\n    this.on = function () {\n        concrete.on(this);\n    };\n    this.off = function () {\n        concrete.off();\n    };\n};\n\nexports.default = Interaction_GameEvent_Binder;\n\n//# sourceURL=webpack:///./src/Interaction_GameEvent_Binder.js?");

/***/ }),

/***/ "./src/Interaction_GameEvent_P2.js":
/*!*****************************************!*\
  !*** ./src/Interaction_GameEvent_P2.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nvar _Interaction_GameEvent = __webpack_require__(/*! ./Interaction_GameEvent */ \"./src/Interaction_GameEvent.js\");\n\nvar _Interaction_GameEvent2 = _interopRequireDefault(_Interaction_GameEvent);\n\nvar _Interaction_GameEvent_Binder = __webpack_require__(/*! ./Interaction_GameEvent_Binder */ \"./src/Interaction_GameEvent_Binder.js\");\n\nvar _Interaction_GameEvent_Binder2 = _interopRequireDefault(_Interaction_GameEvent_Binder);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Interaction_GameEvent_P2 = {};\n\n///listenerの型はジェネリックにする\nInteraction_GameEvent_P2.ListenerHoldContactEvent = function (world, contactEventName) {\n\n    var _listener = null;\n\n    function fire(event) {\n        _listener.fire(event.bodyA.id, event.bodyB.id);\n    }\n    this.on = function (listener) {\n        _listener = listener;\n        world.on(contactEventName, fire);\n    };\n    this.off = function () {\n        _listener = null;\n        world.off(contactEventName, fire);\n    };\n};\n\n/**\r\n * @param {p2.World} world \r\n */\nInteraction_GameEvent_P2.HitEventBinderConcrete = function (world) {\n    _Interaction_GameEvent_Binder2.default.IHitEventBinderConcrete.call(this);\n\n    var concrete = new Interaction_GameEvent_P2.ListenerHoldContactEvent(world, 'endContact');\n\n    this.on = function (listener) {\n        concrete.on(listener);\n    };\n    this.off = function () {\n        concrete.off();\n    };\n};\n\n/**\r\n * @param {p2.World} world \r\n */\nInteraction_GameEvent_P2.HitBallBarEventBinderConcrete = function (world) {\n    _Interaction_GameEvent_Binder2.default.IHitBallBarEventBinderConcrete.call(this);\n\n    var concrete = new Interaction_GameEvent_P2.ListenerHoldContactEvent(world, 'endContact');\n\n    this.on = function (listener) {\n        concrete.on(listener);\n    };\n    this.off = function () {\n        concrete.off();\n    };\n};\n\n/**\r\n * @param {p2.World} world \r\n */\nInteraction_GameEvent_P2.HitBulletEventBinderConcrete = function (world) {\n    _Interaction_GameEvent_Binder2.default.IHitBulletEventBinderConcrete.call(this);\n\n    var concrete = new Interaction_GameEvent_P2.ListenerHoldContactEvent(world, 'beginContact');\n\n    this.on = function (listener) {\n        concrete.on(listener);\n    };\n    this.off = function () {\n        concrete.off();\n    };\n};\n\n/**\r\n * @param {p2.World} world \r\n */\nInteraction_GameEvent_P2.LostBallEventBinderConcrete = function (world) {\n    _Interaction_GameEvent_Binder2.default.ILostBallEventBinderConcrete.call(this);\n\n    var concrete = new Interaction_GameEvent_P2.ListenerHoldContactEvent(world, 'beginContact');\n\n    this.on = function (listener) {\n        concrete.on(listener);\n    };\n    this.off = function () {\n        concrete.off();\n    };\n};\n\n/**\r\n * @param {p2.World} world \r\n */\nInteraction_GameEvent_P2.LostBulletEventBinderConcrete = function (world) {\n    _Interaction_GameEvent_Binder2.default.ILostBulletEventBinderConcrete.call(this);\n\n    var concrete = new Interaction_GameEvent_P2.ListenerHoldContactEvent(world, 'beginContact');\n\n    this.on = function (listener) {\n        concrete.on(listener);\n    };\n    this.off = function () {\n        concrete.off();\n    };\n};\n\n/**\r\n * @param {p2.World} world \r\n */\nInteraction_GameEvent_P2.GetItemEventBinderConcrete = function (world) {\n    _Interaction_GameEvent_Binder2.default.IGetItemEventBinderConcrete.call(this);\n\n    var concrete = new Interaction_GameEvent_P2.ListenerHoldContactEvent(world, 'beginContact');\n\n    this.on = function (listener) {\n        concrete.on(listener);\n    };\n    this.off = function () {\n        concrete.off();\n    };\n};\n\n/**\r\n * @param {p2.World} world \r\n */\nInteraction_GameEvent_P2.LostItemEventBinderConcrete = function (world) {\n    _Interaction_GameEvent_Binder2.default.ILostItemEventBinderConcrete.call(this);\n\n    var concrete = new Interaction_GameEvent_P2.ListenerHoldContactEvent(world, 'beginContact');\n\n    this.on = function (listener) {\n        concrete.on(listener);\n    };\n    this.off = function () {\n        concrete.off();\n    };\n};\n\nexports.default = Interaction_GameEvent_P2;\n\n//# sourceURL=webpack:///./src/Interaction_GameEvent_P2.js?");

/***/ }),

/***/ "./src/Interaction_GameEvent_Pixi.js":
/*!*******************************************!*\
  !*** ./src/Interaction_GameEvent_Pixi.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nvar _Interaction_GameEvent_Binder = __webpack_require__(/*! ./Interaction_GameEvent_Binder */ \"./src/Interaction_GameEvent_Binder.js\");\n\nvar _Interaction_GameEvent_Binder2 = _interopRequireDefault(_Interaction_GameEvent_Binder);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Interaction_GameEvent_Pixi = {};\n\n/**\r\n * @param {PIXI.DisplayObject} displayObject \r\n */\n///TODO IPositionEventListenerはジェネリックなのでonUpFnもジェネリック\nInteraction_GameEvent_Pixi.PositionTapEventConcrete = function (displayObject, onUpFn) {\n    _Interaction_GameEvent_Binder2.default.IPositionEventConcrete.call(this);\n\n    /**\r\n     * @var {Interaction_GameEvent_Binder.IPositionEventListener}\r\n     */\n    var _listener = null;\n\n    function onDown(event) {\n        var x = event.data.global.x;\n        var y = event.data.global.y;\n        _listener.onDown(x, y);\n    }\n    function onMove(event) {\n        var x = event.data.global.x;\n        var y = event.data.global.y;\n        _listener.onMove(x, y);\n    }\n    function onOut(event) {\n        _listener.onOut();\n    }\n    function onUp(event) {\n        onUpFn(_listener, event);\n    }\n\n    /**\r\n     * @param {Interaction_GameEvent_Binder.IPositionEventListener} listener \r\n     */\n    this.on = function (listener) {\n        _listener = listener;\n        displayObject.interactive = true;\n        displayObject.on('pointerdown', onDown);\n        displayObject.on('pointermove', onMove);\n        displayObject.on('pointerout', onOut);\n        displayObject.on('pointerup', onUp);\n    };\n    this.off = function () {\n        displayObject.off('pointerdown', onDown);\n        displayObject.off('pointermove', onMove);\n        displayObject.off('pointerout', onOut);\n        displayObject.off('pointerup', onUp);\n        displayObject.interactive = false;\n        _listener = null;\n    };\n};\n\n/**\r\n * @param {PIXI.DisplayObject} displayObject \r\n */\nInteraction_GameEvent_Pixi.TapEventConcrete = function (displayObject) {\n    _Interaction_GameEvent_Binder2.default.IPositionEventConcrete.call(this);\n    Interaction_GameEvent_Pixi.PositionTapEventConcrete.call(this, displayObject, function (listener, event) {\n        listener.onUp();\n    });\n};\n\n/**\r\n * @param {PIXI.DisplayObject} displayObject \r\n */\nInteraction_GameEvent_Pixi.LabelTapEventConcrete = function (displayObject) {\n    _Interaction_GameEvent_Binder2.default.IPositionEventConcrete.call(this);\n    Interaction_GameEvent_Pixi.PositionTapEventConcrete.call(this, displayObject, function (listener, event) {\n        listener.onUp(event.target.name);\n    });\n};\n\nInteraction_GameEvent_Pixi.LocalDragEventConcrete = function (displayObject) {\n    _Interaction_GameEvent_Binder2.default.IDragEventConcrete.call(this);\n\n    /**\r\n     * @var {Interaction_GameEvent_Binder.IPositionEventListener}\r\n     */\n    var _listener = null;\n\n    function onDown(event) {\n        var p = event.data.getLocalPosition(displayObject);\n        _listener.onDown(p.x, p.y);\n    }\n    function onMove(event) {\n        var p = event.data.getLocalPosition(displayObject);\n        _listener.onMove(p.x, p.y);\n    }\n    function onUp(event) {\n        _listener.onUp();\n    }\n\n    this.on = function (listener) {\n        _listener = listener;\n        displayObject.interactive = true;\n        displayObject.on('pointerdown', onDown);\n        displayObject.on('pointermove', onMove);\n        displayObject.on('pointerup', onUp);\n        displayObject.on('pointerupoutside', onUp);\n    };\n    this.off = function () {\n        displayObject.off('pointerdown', onDown);\n        displayObject.off('pointermove', onMove);\n        displayObject.off('pointerup', onUp);\n        displayObject.off('pointerupoutside', onUp);\n        _listener = null;\n    };\n};\n\nexports.default = Interaction_GameEvent_Pixi;\n\n//# sourceURL=webpack:///./src/Interaction_GameEvent_Pixi.js?");

/***/ }),

/***/ "./src/Interaction_P2.js":
/*!*******************************!*\
  !*** ./src/Interaction_P2.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nvar _Element_P = __webpack_require__(/*! ./Element_P2 */ \"./src/Element_P2.js\");\n\nvar _Element_P2 = _interopRequireDefault(_Element_P);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Interaction_P2 = {};\n\nInteraction_P2.P2StepCalculator = function (world) {\n    _Interaction2.default.IStepCalculator.call(this);\n    this.calc = function (stepSec) {\n        world.step(stepSec);\n    };\n};\nInteraction_P2.StepCalculatorFactory = function (world) {\n    _Interaction2.default.IStepCalculatorFactory.call(this);\n    this.create = function () {\n        var ret = new Interaction_P2.P2StepCalculator(world);\n        return ret;\n    };\n};\n\nInteraction_P2.P2BodyProperty = function () {\n    _Interaction2.default.IBodyProperty.call(this);\n    var element = null;\n    this.setElement = function (e) {\n        element = e.getElement(_Element_P2.default.KEY);\n    };\n    this.getX = function () {\n        return element.position[0];\n    };\n    this.getY = function () {\n        return element.position[1];\n    };\n};\nInteraction_P2.BodyPropertyFactory = function () {\n    _Interaction2.default.IBodyPropertyFactory.call(this);\n    this.create = function () {\n        var ret = new Interaction_P2.P2BodyProperty();\n        return ret;\n    };\n};\n\nexports.default = Interaction_P2;\n\n//# sourceURL=webpack:///./src/Interaction_P2.js?");

/***/ }),

/***/ "./src/Interaction_Pixi.js":
/*!*********************************!*\
  !*** ./src/Interaction_Pixi.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nvar _Element_Pixi = __webpack_require__(/*! ./Element_Pixi */ \"./src/Element_Pixi.js\");\n\nvar _Element_Pixi2 = _interopRequireDefault(_Element_Pixi);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Interaction_Pixi = {};\n\nInteraction_Pixi.PixiViewProperty = function () {\n    _Interaction2.default.IViewProperty.call(this);\n    var element = null;\n    this.setElement = function (e) {\n        element = e.getElement(_Element_Pixi2.default.KEY);\n    };\n    this.setX = function (x) {\n        element.position.x = x;\n    };\n    this.setY = function (y) {\n        element.position.y = y;\n    };\n};\nInteraction_Pixi.ViewPropertyFactory = function () {\n    _Interaction2.default.IViewPropertyFactory.call(this);\n    this.create = function () {\n        var ret = new Interaction_Pixi.PixiViewProperty();\n        return ret;\n    };\n};\n\nexports.default = Interaction_Pixi;\n\n//# sourceURL=webpack:///./src/Interaction_Pixi.js?");

/***/ }),

/***/ "./src/Interaction_StageEvent.js":
/*!***************************************!*\
  !*** ./src/Interaction_StageEvent.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _Interaction_GameEvent = __webpack_require__(/*! ./Interaction_GameEvent */ \"./src/Interaction_GameEvent.js\");\n\nvar _Interaction_GameEvent2 = _interopRequireDefault(_Interaction_GameEvent);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//移行完了\n\nvar Interaction_StageEvent = {};\n\n/**\r\n * 発火したらそのまま通知するだけの実装。\r\n */\nInteraction_StageEvent.PassThroughImplement = function () {\n  _Interaction_GameEvent2.default.PassThroughImplement.call(this);\n};\n\n/**\r\n * ステージをクリアした。\r\n * 発火時にメッセージを渡せる。\r\n * Interaction_StageCommand.StageClearの後に起きる。\r\n */\nInteraction_StageEvent.ClearEvent = function () {\n  var implement = new Interaction_StageEvent.PassThroughImplement();\n  /**\r\n   * @param {Interaction_StageEvent.IClearEventListener} listener\r\n   */\n  this.addListener = function (listener) {\n    implement.addListener(listener);\n  };\n  this.fire = function (message) {\n    implement.fire(message);\n  };\n};\nInteraction_StageEvent.IClearEventListener = function () {\n  this.fired = function (message) {\n    throw new Error('未実装');\n  };\n};\n\n/**\r\n * ステージが失敗した。\r\n * Interaction_StageCommand.StageFailの後に起きる。\r\n */\nInteraction_StageEvent.FailEvent = function () {\n  var implement = new Interaction_StageEvent.PassThroughImplement();\n  /**\r\n   * @param {Interaction_StageEvent.IFailEventListener} listener\r\n   */\n  this.addListener = function (listener) {\n    implement.addListener(listener);\n  };\n  this.fire = function () {\n    implement.fire();\n  };\n};\nInteraction_StageEvent.IFailEventListener = function () {\n  this.fired = function () {\n    throw new Error('未実装');\n  };\n};\n\nexports.default = Interaction_StageEvent;\n\n//# sourceURL=webpack:///./src/Interaction_StageEvent.js?");

/***/ }),

/***/ "./src/Interaction_UpdaterListener.js":
/*!********************************************!*\
  !*** ./src/Interaction_UpdaterListener.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction = __webpack_require__(/*! ./Interaction */ \"./src/Interaction.js\");\n\nvar _Interaction2 = _interopRequireDefault(_Interaction);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//移行完了\n\nvar Interaction_UpdaterListener = {};\n\n/**\r\n * @param {Interaction.IUpdaterListener} listener \r\n * @param {Function} resolveFn \r\n * @param {Function} rejectFn \r\n * @param {Function} finallyFn \r\n */\nInteraction_UpdaterListener.ListenerWrapper = function (listener, resolveFn, rejectFn, finallyFn) {\n    _Interaction2.default.IUpdaterListener.call(this);\n    var promise = new Promise(function (resolve, reject) {\n        listener.promise().then(function (data) {\n            resolveFn(data);\n            resolve();\n        }).catch(function (data) {\n            rejectFn(data);\n            reject();\n        }).finally(function (data) {\n            finallyFn(data);\n        });\n    });\n    this.exec = function (ticks) {\n        listener.exec(ticks);\n    };\n    this.suspend = function () {\n        listener.suspend();\n    };\n    this.resume = function () {\n        listener.resume();\n    };\n    this.isSuspend = function () {\n        listener.isSuspend();\n    };\n    this.isEnd = function () {\n        return listener.isEnd();\n    };\n    this.cancel = function () {\n        listener.cancel();\n    };\n    this.promise = function () {\n        return promise;\n    };\n};\n\n/**\r\n * stop系処理に関する標準実装。\r\n * @param {boolean} stoppable \r\n */\nInteraction_UpdaterListener.StandardStop = function (stoppable) {\n    var isSuspend = false;\n    this.suspend = function () {\n        isSuspend = true;\n    };\n    this.resume = function () {\n        isSuspend = false;\n    };\n    this.isSuspend = function () {\n        return stoppable && isSuspend;\n    };\n};\n\n/**\r\n * sec秒後にpromiseがresolveされる。\r\n * cancelされるとpromiseはrejectされる。\r\n * @param {Number} sec \r\n */\nInteraction_UpdaterListener.TimeoutListener = function (sec, stoppable) {\n    _Interaction2.default.IUpdaterListener.call(this);\n    Interaction_UpdaterListener.StandardStop.call(this, stoppable);\n    var resolve = null;\n    var reject = null;\n    var promise = new Promise(function (_resolve, _reject) {\n        resolve = _resolve;reject = _reject;\n    });\n    this.exec = function (ticks) {\n        if (sec < 0) return;\n        sec -= ticks;\n        if (sec < 0) {\n            resolve();\n        }\n    };\n    this.isEnd = function () {\n        return sec < 0;\n    };\n    this.cancel = function () {\n        sec = -1;reject();\n    };\n    this.promise = function () {\n        return promise;\n    };\n};\n\n/**\r\n * sec間隔でfnを実行する。end秒後に終了し、promiseがresolveする。\r\n * @param {Function} fn \r\n * @param {Number} interval \r\n * @param {Number} end\r\n */\nInteraction_UpdaterListener.LimitedIntervalListener = function (fn, interval, end, stoppable) {\n    _Interaction2.default.IUpdaterListener.call(this);\n    Interaction_UpdaterListener.StandardStop.call(this, stoppable);\n    var intervalInitial = interval;\n    var resolve = null;\n    var reject = null;\n    var promise = new Promise(function (_resolve, _reject) {\n        resolve = _resolve;reject = _reject;\n    });\n    this.exec = function (ticks) {\n        if (end < 0) return;\n        end -= ticks;\n        interval -= ticks;\n        if (end < 0) {\n            resolve();\n        }\n\n        if (interval < 0) {\n            interval = intervalInitial;\n            fn();\n        }\n    };\n    this.isEnd = function () {\n        return end < 0;\n    };\n    this.cancel = function () {\n        end = -1;reject();\n    };\n    this.promise = function () {\n        return promise;\n    };\n};\n\n/**\r\n * sec間隔でfnを実行する。resolveは発生しない。\r\n * キャンセルされるとrejectされる。\r\n * @param {Function} fn\r\n * @param {Number} interval \r\n */\nInteraction_UpdaterListener.IntervalListener = function (fn, interval, stoppable) {\n    _Interaction2.default.IUpdaterListener.call(this);\n    Interaction_UpdaterListener.StandardStop.call(this, stoppable);\n    var intervalInitial = interval;\n    var canceled = false;\n    var resolve = null;\n    var reject = null;\n    var promise = new Promise(function (_resolve, _reject) {\n        resolve = _resolve;reject = _reject;\n    });\n    this.exec = function (ticks) {\n        if (canceled) return;\n        interval -= ticks;\n        if (interval < 0) {\n            interval = intervalInitial;\n            fn();\n        }\n    };\n    this.isEnd = function () {\n        return canceled;\n    };\n    this.cancel = function () {\n        canceled = true;reject();\n    };\n    this.promise = function () {\n        return promise;\n    };\n};\n\n/**\r\n * 毎exec毎にfnが実行される。resolveされない。\r\n * キャンセルされるとrejectされる。\r\n * @param {Function} fn(ticks)\r\n */\nInteraction_UpdaterListener.EveryExecListener = function (fn, stoppable) {\n    _Interaction2.default.IUpdaterListener.call(this);\n    Interaction_UpdaterListener.StandardStop.call(this, stoppable);\n    var canceled = false;\n    var resolve = null;\n    var reject = null;\n    var promise = new Promise(function (_resolve, _reject) {\n        resolve = _resolve;reject = _reject;\n    });\n    this.exec = function (ticks) {\n        if (canceled) return;\n        fn(ticks);\n    };\n    this.isEnd = function () {\n        return canceled;\n    };\n    this.cancel = function () {\n        canceled = true;reject();\n    };\n    this.promise = function () {\n        return promise;\n    };\n};\n\n/**\r\n * 次回exec時にresolveされる。resolve({data, ticks})\r\n * @param {*} data\r\n */\nInteraction_UpdaterListener.NextListener = function (data, stoppable) {\n    _Interaction2.default.IUpdaterListener.call(this);\n    Interaction_UpdaterListener.StandardStop.call(this, stoppable);\n    var isEnd = false;\n    var resolve = null;\n    var reject = null;\n    var promise = new Promise(function (_resolve, _reject) {\n        resolve = _resolve;reject = _reject;\n    });\n    this.exec = function (ticks) {\n        isEnd = true;\n        resolve({ data: data, ticks: ticks });\n    };\n    this.isEnd = function () {\n        return isEnd;\n    };\n    this.cancel = function () {\n        isEnd = true;reject(data);\n    };\n    this.promise = function () {\n        return promise;\n    };\n};\n\nexports.default = Interaction_UpdaterListener;\n\n//# sourceURL=webpack:///./src/Interaction_UpdaterListener.js?");

/***/ }),

/***/ "./src/Stage.js":
/*!**********************!*\
  !*** ./src/Stage.js ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Interaction_StageEvent = __webpack_require__(/*! ./Interaction_StageEvent */ \"./src/Interaction_StageEvent.js\");\n\nvar _Interaction_StageEvent2 = _interopRequireDefault(_Interaction_StageEvent);\n\nvar _Element_Store = __webpack_require__(/*! ./Element_Store */ \"./src/Element_Store.js\");\n\nvar _Element_Store2 = _interopRequireDefault(_Element_Store);\n\nvar _Concrete = __webpack_require__(/*! ./Concrete */ \"./src/Concrete.js\");\n\nvar _Concrete2 = _interopRequireDefault(_Concrete);\n\nvar _Stage_Template = __webpack_require__(/*! ./Stage_Template */ \"./src/Stage_Template.js\");\n\nvar _Stage_Template2 = _interopRequireDefault(_Stage_Template);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Stage = {};\n\nStage.UpdaterManager = function () {\n    var updater = null;\n    this.on = function (_updater) {\n        updater = _updater;\n        requestAnimationFrame(update);\n    };\n    this.off = function () {\n        updater.off();\n        updater = null;\n    };\n    function update(ticks) {\n        if (updater == null) return;\n        requestAnimationFrame(update);\n        updater.update(ticks);\n    };\n};\nStage.EventBinderManager = function () {\n    var eventBinder = null;\n    this.on = function (_eventBinder) {\n        eventBinder = _eventBinder;\n        eventBinder.on();\n    };\n    this.off = function () {\n        eventBinder.off();\n        eventBinder = null;\n    };\n};\n\nStage.IStage = function () {\n    /**\r\n     * @param {Stage.IStageConcreteFactory} concreteFactory\r\n     */\n    this.createStageSet = function (player, stageClearEvent, stageFailEvent, concreteFactory) {\n        throw new Error('未実装');\n    };\n    this.buildStage = function (shape, store, factory, event, command, behavior, helper) {\n        throw new Error('未実装');\n    };\n};\n\nStage.ConfigSinger = function (config) {\n    /**\r\n     * @param {string} stageName \r\n     * @returns {Stage.IStage}\r\n     */\n    this.createStage = function (stageName) {\n        if (config[stageName] == null) throw new Error('[' + stageName + ']というステージは定義されていません。');\n        var stageConfig = new config[stageName]();\n\n        if (_Stage_Template2.default[stageConfig.template + '_Config'] == null) throw new Error('[' + stageConfig.template + ']というステージテンプレートはありません。');\n        var stage = new _Stage_Template2.default[stageConfig.template + '_Config'](stageConfig);\n\n        console.log('load stage ' + stageName);\n        return stage;\n    };\n};\n\nStage.IStageConcrete = function () {\n    /**\r\n     * @returns {Element.IRendererFactory}\r\n     */\n    this.getRendererFactory = function () {\n        throw new Error('未実装');\n    };\n    /**\r\n     * @returns {Interaction.IStepCalculatorFactory}\r\n     */\n    this.getStepCalculatorFactory = function () {\n        throw new Error('未実装');\n    };\n    /**\r\n     * @returns {Interaction.IBodyPropertyFactory}\r\n     */\n    this.getBodyPropertyFactory = function () {\n        throw new Error('未実装');\n    };\n    /**\r\n     * @returns {Interaction.IViewPropertyFactory}\r\n     */\n    this.getViewPropertyFactory = function () {\n        throw new Error('未実装');\n    };\n    /**\r\n     * @returns {Element_Layer.ILayerFactory}\r\n     */\n    this.getLayerFactory = function () {\n        throw new Error('未実装');\n    };\n    /**\r\n     * @returns {Concrete.IConcreteShapeStoreImplementFactory}\r\n     */\n    this.getConcreteShapeStoreImplementFactory = function () {\n        throw new Error('未実装');\n    };\n    /**\r\n     * @returns {Concrete.IFactoryConcreteFactory}\r\n     */\n    this.getFactoryConcreteFactory = function () {\n        throw new Error('未実装');\n    };\n    /**\r\n     * @returns {Concrete.IPreBindBindersConcreteFactory}\r\n     */\n    this.getPreBindBindersConcreteFactory = function () {\n        throw new Error('未実装');\n    };\n    /**\r\n     * @returns {Concrete.ICommandConcreteFactory}\r\n     */\n    this.getCommandConcreteFactory = function () {\n        throw new Error('未実装');\n    };\n    /**\r\n     * @returns {Concrete.IHelperConcreteFactory}\r\n     */\n    this.getHelperConcreteFactory = function () {\n        throw new Error('未実装');\n    };\n};\nStage.IStageConcreteFactory = function () {\n    /**\r\n     * @returns {Stage.IStageConcrete}\r\n     */\n    this.create = function () {};\n};\n\n/**\r\n * start:開始ステージ\r\n * clear:クリア\r\n */\nStage.StageManager = function (updaterManager, eventBinderManager) {\n    var START_STAGE_NAME = 'start';\n    var CLEAR_STAGE_NAME = 'clear';\n\n    /**\r\n     * @param {Stage.ConfigSinger} configSinger \r\n     * @param {Stage.IStageConcreteFactory} concreteFactory\r\n     */\n    this.exec = function (configSinger, playerCount, appClearEvent, appFailEvent, concreteFactory) {\n\n        var stageClearEvent = new _Interaction_StageEvent2.default.ClearEvent();\n        var stageFailEvent = new _Interaction_StageEvent2.default.FailEvent();\n\n        var player = new _Element_Store2.default.Player();\n        player.count = playerCount;\n\n        function startStage(stageName) {\n            var stage = configSinger.createStage(stageName);\n\n            var stageSet = stage.createStageSet(player, stageClearEvent, stageFailEvent, concreteFactory);\n\n            var updater = stageSet.getUpdater();\n            var shape = stageSet.getShape();\n            var store = stageSet.getStore();\n            var factory = stageSet.getFactory();\n            var event = stageSet.getEvent();\n            var eventBinder = stageSet.getEventBinder();\n            var command = stageSet.getCommand();\n            var behavior = stageSet.getBehavior();\n            var helper = stageSet.getHelper();\n\n            stage.buildStage(shape, store, factory, event, command, behavior, helper);\n            eventBinderManager.on(eventBinder);\n            updaterManager.on(updater);\n        }\n\n        var clearListener = new function () {\n            _Interaction_StageEvent2.default.IClearEventListener.call(this);\n            this.fired = function (message) {\n                eventBinderManager.off();\n                updaterManager.off();\n                if (message === CLEAR_STAGE_NAME) {\n                    if (appClearEvent !== null) appClearEvent.fire();\n                    return;\n                }\n                startStage(message);\n            };\n        }();\n        stageClearEvent.addListener(clearListener);\n\n        var failListener = new function () {\n            _Interaction_StageEvent2.default.IFailEventListener.call(this);\n            this.fired = function () {\n                eventBinderManager.off();\n                updaterManager.off();\n                if (appFailEvent !== null) appFailEvent.fire();\n            };\n        }();\n        stageFailEvent.addListener(failListener);\n\n        startStage(START_STAGE_NAME);\n    };\n};\n\nexports.default = Stage;\n\n//# sourceURL=webpack:///./src/Stage.js?");

/***/ }),

/***/ "./src/Stage_Template.js":
/*!*******************************!*\
  !*** ./src/Stage_Template.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Stage = __webpack_require__(/*! ./Stage */ \"./src/Stage.js\");\n\nvar _Stage2 = _interopRequireDefault(_Stage);\n\nvar _Stage_Template_Asset = __webpack_require__(/*! ./Stage_Template_Asset */ \"./src/Stage_Template_Asset.js\");\n\nvar _Stage_Template_Asset2 = _interopRequireDefault(_Stage_Template_Asset);\n\nvar _Concrete = __webpack_require__(/*! ./Concrete */ \"./src/Concrete.js\");\n\nvar _Concrete2 = _interopRequireDefault(_Concrete);\n\nvar _Concrete_PixiP = __webpack_require__(/*! ./Concrete_PixiP2 */ \"./src/Concrete_PixiP2.js\");\n\nvar _Concrete_PixiP2 = _interopRequireDefault(_Concrete_PixiP);\n\nvar _Element_Effect_Tween = __webpack_require__(/*! ./Element_Effect_Tween */ \"./src/Element_Effect_Tween.js\");\n\nvar _Element_Effect_Tween2 = _interopRequireDefault(_Element_Effect_Tween);\n\nvar _Element_Shape_Pixi = __webpack_require__(/*! ./Element_Shape_Pixi */ \"./src/Element_Shape_Pixi.js\");\n\nvar _Element_Shape_Pixi2 = _interopRequireDefault(_Element_Shape_Pixi);\n\nvar _Element_Shape_P = __webpack_require__(/*! ./Element_Shape_P2 */ \"./src/Element_Shape_P2.js\");\n\nvar _Element_Shape_P2 = _interopRequireDefault(_Element_Shape_P);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Stage_Template = {};\n\nStage_Template.FullCustomizeStandardAreaPixiP2_Config = function (config) {\n    function check(key) {\n        if (config.data[key] == null) throw new Error('[' + key + ']が設定されていません。');\n        return config.data[key];\n    }\n    Stage_Template.FullCustomizeStandardAreaPixiP2.call(this, check('backgroundColor'), check('stageWidth'), check('stageHeight'), check('barAreaHeight'), check('barPositionY'), check('ballRadius'), check('barHeight'), check('tapAllowance'), check('ballReleaseVelocity'), check('directLoad'), check('jsonpLoad'), function (register) {\n        return check('shapeRegisterFunction')(register, new _Element_Shape_Pixi2.default.Shapes(), new _Element_Shape_P2.default.Shapes(), _Element_Effect_Tween2.default);\n    }, check('preLoadFunction'), check('stageBuilderFunction'));\n};\nStage_Template.FullCustomizeStandardAreaPixiP2 = function (backgroundColor, stageWidth, stageHeight, barAreaHeight, barInitPosY, ballRadius, barHeight, tapAllowance, ballReleaseVelocity, directLoadPathSet, jsonpLoadPathSet, shapeRegisterFn, preLoadImageFn, buildStageFn) {\n    _Stage2.default.IStage.call(this);\n\n    /**\r\n     * @param {Stage.IStageConcreteFactory} concreteFactory\r\n     */\n    this.createStageSet = function (player, stageClearEvent, stageFailEvent, concreteFactory) {\n\n        var concrete = concreteFactory.create();\n\n        var stageSet = new _Concrete2.default.StageSet(player, stageClearEvent, stageFailEvent, backgroundColor, stageWidth, stageHeight, barAreaHeight, tapAllowance, stageWidth / 2, barInitPosY - ballRadius - barHeight / 2 - 1, stageWidth / 2, barInitPosY, ballReleaseVelocity, ballRadius * 1.5, ballRadius * 1.5, shapeRegisterFn, concrete.getRendererFactory(), concrete.getStepCalculatorFactory(), concrete.getBodyPropertyFactory(), concrete.getViewPropertyFactory(), concrete.getLayerFactory(), concrete.getConcreteShapeStoreImplementFactory(), concrete.getFactoryConcreteFactory(), concrete.getPreBindBindersConcreteFactory(), concrete.getCommandConcreteFactory(), concrete.getHelperConcreteFactory());\n\n        return stageSet;\n    };\n    this.buildStage = function (shape, store, factory, event, command, behavior, helper) {\n        var asset = new _Stage_Template_Asset2.default.AssetSet(shape, store, factory, event, command, behavior, helper);\n        preLoadImageFn(shape, store, factory, event, command, behavior, helper, asset);\n        var promises = [command.ImageLoad.execAsync('direct', directLoadPathSet), command.ImageLoad.execAsync('jsonp', jsonpLoadPathSet)];\n        Promise.all(promises).then(function () {\n            buildStageFn(shape, store, factory, event, command, behavior, helper, asset);\n        }).catch(function (e) {\n            throw e;\n        });\n    };\n};\n\nStage_Template.TappableOpeningPixiP2_Config = function (config) {\n    function check(key) {\n        if (config.data[key] == null) throw new Error('[' + key + ']が設定されていません。');\n        return config.data[key];\n    }\n    Stage_Template.TappableOpeningPixiP2.call(this, check('width'), check('height'), check('buttonString'), check('backgroundImageUrl'), check('fadeoutColor'), check('nextStage'));\n};\nStage_Template.TappableOpeningPixiP2 = function (width, height, buttonString, backgroundImageUrl, fadeoutColor, nextStage) {\n    /**\r\n     * @param {Stage.IStageConcreteFactory} concreteFactory\r\n     */\n    this.createStageSet = function (player, stageClearEvent, stageFailEvent, concreteFactory) {\n\n        var concrete = concreteFactory.create();\n        var stageSet = new _Concrete2.default.StageSet(player, stageClearEvent, stageFailEvent, fadeoutColor, width, height, 0, 0, 0, 0, 0, 0, [], 0, 0, function (register) {\n            return shapeRegister(register, new _Element_Shape_Pixi2.default.Shapes(), _Element_Effect_Tween2.default);\n        }, concrete.getRendererFactory(), concrete.getStepCalculatorFactory(), concrete.getBodyPropertyFactory(), concrete.getViewPropertyFactory(), concrete.getLayerFactory(), concrete.getConcreteShapeStoreImplementFactory(), concrete.getFactoryConcreteFactory(), concrete.getPreBindBindersConcreteFactory(), concrete.getCommandConcreteFactory(), concrete.getHelperConcreteFactory());\n\n        return stageSet;\n    };\n    function shapeRegister(register, pixiShape, tween) {\n        register.registBall('', pixiShape.Empty(), null);\n        register.registBar('', pixiShape.Empty(), null);\n        register.registPlayerCount('', pixiShape.Empty(), null);\n        register.registPlayArea(\n        //eventに反応させるため、透明で全面を覆っている。\n        '', pixiShape.Rect(0, 0, width, height, 0x00000, 0.0), null);\n\n        register.registLabel('', function (g, w, h) {\n            return g;\n        });\n        register.registLabel('button', function (g, w, h) {\n            var marginH = 20;\n            var marginW = 60;\n            return g.beginFill(0x000000, 0.8).drawRoundedRect(-marginW, -marginH, w + marginW * 2, h + marginH * 2, marginH).endFill();\n        });\n\n        register.registStyle('button', {\n            fontSize: '3em',\n            fill: '#FFFFFF',\n            fontWeight: 'bolder',\n            align: 'center'\n        });\n\n        register.registTween('flash', 0.5, tween.Nop, 0.0, tween.Nop, 0.0, tween.Nop, 0.0, 0.0, tween.CosPositive, 0.5, 3.5);\n        register.registTween('alphaOn', 1.0, tween.Nop, 0.0, tween.Nop, 0.0, tween.Nop, 0.0, 0.0, tween.CubicOut, 0.0, 1.0);\n        register.registTween('alphaOff', 1.0, tween.Nop, 0.0, tween.Nop, 0.0, tween.Nop, 0.0, 0.0, tween.CubicOut, 1.0, 0.0);\n    }\n\n    this.buildStage = function (shape, store, factory, event, command, behavior, helper) {\n        command.ImageLoad.execAsync('direct', { back: backgroundImageUrl }).then(function () {\n            buildStage(shape, store, factory, event, command, behavior, helper);\n        }).catch(function (e) {\n            throw e;\n        });\n    };\n\n    /**\r\n     * @param {Concrete.ShapeFactory} shape \r\n     * @param {Concrete.Store} store \r\n     * @param {Concrete.Factory} factory \r\n     * @param {Concrete.Event} event \r\n     * @param {Concrete.Command} command \r\n     * @param {Concrete.Behavior} behavior \r\n     * @param {Concrete.Helper} helper\r\n     */\n    function buildStage(shape, store, factory, event, command, behavior, helper) {\n        var button = factory.Label.createLabel();\n\n        command.FadeScreen.execAsync(fadeoutColor, shape.Tween('alphaOff'), false).then(function () {\n            command.DrawText.exec(button, buttonString, width / 2, height / 3 * 2, 'center', 'center', shape.Label('button'), shape.Style('button'));\n            command.Tappable.exec(button);\n        });\n\n        factory.PlayArea.createPlayArea(shape.PlayArea());\n        var backImage = factory.Image.createImage('back');\n        command.ChangeImage.exec(0, backImage);\n\n        behavior.ImmediateStageClear.exec();\n        behavior.LabelTapEventCallback.exec(button, function () {\n            command.FlashLabel.execAsync(button, shape.Tween('flash')).then(function () {\n                return command.FadeScreen.execAsync(fadeoutColor, shape.Tween('alphaOn'), false);\n            }).then(function () {\n                command.GameClear.exec(nextStage);\n            }).catch(function () {});\n        });\n    }\n};\n\nexports.default = Stage_Template;\n\n//# sourceURL=webpack:///./src/Stage_Template.js?");

/***/ }),

/***/ "./src/Stage_Template_Asset.js":
/*!*************************************!*\
  !*** ./src/Stage_Template_Asset.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar Stage_Template_Asset = {};\n\nStage_Template_Asset.AssetSet = function (shape, store, factory, event, command, behavior, helper) {\n    this.PutMenu = new Stage_Template_Asset.PutMenu(shape, store, factory, event, command, behavior, helper);\n    this.BarLabel = new Stage_Template_Asset.BarLabel(shape, store, factory, event, command, behavior, helper);\n};\n\nStage_Template_Asset.BarLabel = function (shape, store, factory, event, command, behavior, helper) {\n    var label = void 0;\n    var stageWidth = void 0;\n    var stageHeight = void 0;\n    var barAreaHeight = void 0;\n    this.setSize = function (_stageWidth, _stageHeight, _barAreaHeight) {\n        label = factory.Label.createLabel();\n        stageWidth = _stageWidth;\n        stageHeight = _stageHeight;\n        barAreaHeight = _barAreaHeight;\n    };\n    this.draw = function (text, frameShape, textStyle) {\n        command.DrawTextFramed.exec(label, \"\" + text, 0, stageHeight - barAreaHeight, stageWidth, barAreaHeight, 'center', 'center', shape.Label(frameShape), shape.Style(textStyle));\n    };\n    this.clear = function (emptyFrameShape) {\n        command.ChangeLabel.exec(label, shape.Label(emptyFrameShape), 0, 0);\n    };\n};\n\nStage_Template_Asset.PutMenu = function (shape, store, factory, event, command, behavior, helper) {\n    this.exec = function (x, y, w, h, slowRatio, fastRatio, speedLimit, directionRange, emptyShape, menuOpenShape, menuCloseShape, blockPreviewShape, slowBallShape, fastBallShape, changeDirectionShape, flashTween, countDownFn) {\n        var menuOpened = false;\n        var blockPreviewed = false;\n        var labelMenu = factory.Label.createLabel();\n        var labelPreview = factory.Label.createLabel();\n        var labelSlowBall = factory.Label.createLabel();\n        var labelFastBall = factory.Label.createLabel();\n        var labelChangeDirection = factory.Label.createLabel();\n        command.PutLabel.exec(labelMenu, shape.Label(menuOpenShape), x, y, w, h);\n        command.PutLabel.exec(labelPreview, shape.Label(emptyShape), x + w * 1, y, w, h);\n        command.PutLabel.exec(labelSlowBall, shape.Label(emptyShape), x + w * 2, y, w, h);\n        command.PutLabel.exec(labelFastBall, shape.Label(emptyShape), x + w * 3, y, w, h);\n        command.PutLabel.exec(labelChangeDirection, shape.Label(emptyShape), x + w * 4, y, w, h);\n        command.Tappable.exec(labelMenu);\n        command.Tappable.exec(labelPreview);\n        command.Tappable.exec(labelSlowBall);\n        command.Tappable.exec(labelFastBall);\n        command.Tappable.exec(labelChangeDirection);\n        behavior.LabelTapEventCallback.exec(labelMenu, function () {\n            if (menuOpened) {\n                command.CountDown.execAsync([3, 2, 1, 0], 1.0, function (n) {\n                    countDownFn(n);\n                }, false).then(function () {\n                    command.GameResume.exec();\n                    menuOpened = false;\n                }).catch(function (e) {\n                    throw e;\n                });\n                command.ChangeLabel.exec(labelMenu, shape.Label(menuOpenShape), w, h);\n                command.ChangeLabel.exec(labelPreview, shape.Label(emptyShape), w, h);\n                command.ChangeLabel.exec(labelSlowBall, shape.Label(emptyShape), w, h);\n                command.ChangeLabel.exec(labelFastBall, shape.Label(emptyShape), w, h);\n                command.ChangeLabel.exec(labelChangeDirection, shape.Label(emptyShape), w, h);\n            } else {\n                command.GameSuspend.exec();\n                command.ChangeLabel.exec(labelMenu, shape.Label(menuCloseShape), w, h);\n                command.ChangeLabel.exec(labelPreview, shape.Label(blockPreviewShape), w, h);\n                command.ChangeLabel.exec(labelSlowBall, shape.Label(slowBallShape), w, h);\n                command.ChangeLabel.exec(labelFastBall, shape.Label(fastBallShape), w, h);\n                command.ChangeLabel.exec(labelChangeDirection, shape.Label(changeDirectionShape), w, h);\n                menuOpened = true;\n            }\n        });\n        behavior.LabelTapEventCallback.exec(labelPreview, function () {\n            command.FlashLabel.execAsync(labelPreview, shape.Tween(flashTween));\n            if (blockPreviewed) {\n                command.BlockPreview.exec(false);\n                blockPreviewed = false;\n            } else {\n                command.BlockPreview.exec(true);\n                blockPreviewed = true;\n            }\n        });\n        behavior.LabelTapEventCallback.exec(labelSlowBall, function () {\n            command.FlashLabel.execAsync(labelSlowBall, shape.Tween(flashTween));\n            store.Ball.forEach(function (b) {\n                return command.BallSpeedUpAndLimit.exec(b, slowRatio, speedLimit);\n            });\n        });\n        behavior.LabelTapEventCallback.exec(labelFastBall, function () {\n            command.FlashLabel.execAsync(labelFastBall, shape.Tween(flashTween));\n            store.Ball.forEach(function (b) {\n                return command.BallSpeedUpAndLimit.exec(b, fastRatio, speedLimit);\n            });\n        });\n        behavior.LabelTapEventCallback.exec(labelChangeDirection, function () {\n            command.FlashLabel.execAsync(labelChangeDirection, shape.Tween(flashTween));\n            var ball = store.Ball.getRandomOne();\n            if (ball == null) return;\n            var angle = directionRange * 2 * Math.random() - directionRange;\n            command.ChangeBallAngle.exec(ball, angle);\n        });\n        behavior.ClearEventCallback.exec(function () {\n            command.ChangeLabel.exec(labelMenu, shape.Label(emptyShape), 0, 0);\n            command.ChangeLabel.exec(labelPreview, shape.Label(emptyShape), 0, 0);\n            command.ChangeLabel.exec(labelSlowBall, shape.Label(emptyShape), 0, 0);\n            command.ChangeLabel.exec(labelChangeDirection, shape.Label(emptyShape), 0, 0);\n        });\n    };\n};\n\nexports.default = Stage_Template_Asset;\n\n//# sourceURL=webpack:///./src/Stage_Template_Asset.js?");

/***/ }),

/***/ "./src/test001.js":
/*!************************!*\
  !*** ./src/test001.js ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _Stage = __webpack_require__(/*! ./Stage */ \"./src/Stage.js\");\n\nvar _Stage2 = _interopRequireDefault(_Stage);\n\nvar _Concrete_PixiP = __webpack_require__(/*! ./Concrete_PixiP2 */ \"./src/Concrete_PixiP2.js\");\n\nvar _Concrete_PixiP2 = _interopRequireDefault(_Concrete_PixiP);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//重くなるのでwebpack-babelしない\n//import * as PIXI from 'pixi.js';\n//import p2 from 'p2';\n\nvar updaterManager = new _Stage2.default.UpdaterManager();\nvar eventBinderManager = new _Stage2.default.EventBinderManager();\nvar stageManager = new _Stage2.default.StageManager(updaterManager, eventBinderManager);\nvar configSinger = new _Stage2.default.ConfigSinger(config);\nstageManager.exec(configSinger, 3, null, null, new _Concrete_PixiP2.default.StageConcreteFactory());\n\n//# sourceURL=webpack:///./src/test001.js?");

/***/ })

/******/ });